{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA,IAAI,UAAU,QAAQ,SAAR,CAAd;;AAEA,IAAI,cAAc,UAAU,GAAV,EAAe;AAC7B,QAAI,OAAO,IAAX,EAAiB,OAAO,OAAO,IAAP,CAAY,GAAZ,CAAP,CAAjB,KACK;AACD,YAAI,MAAM,EAAV;AACA,aAAK,IAAI,GAAT,IAAgB,GAAhB,EAAqB,IAAI,IAAJ,CAAS,GAAT;AACrB,eAAO,GAAP;AACH;AACJ,CAPD;;AASA,IAAI,UAAU,UAAU,EAAV,EAAc,EAAd,EAAkB;AAC5B,QAAI,GAAG,OAAP,EAAgB,OAAO,GAAG,OAAH,CAAW,EAAX,CAAP,CAAhB,KACK,KAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,GAAG,MAAvB,EAA+B,GAA/B,EAAoC;AACrC,WAAG,GAAG,CAAH,CAAH,EAAU,CAAV,EAAa,EAAb;AACH;AACJ,CALD;;AAOA,IAAI,aAAc,YAAW;AACzB,QAAI;AACA,eAAO,cAAP,CAAsB,EAAtB,EAA0B,GAA1B,EAA+B,EAA/B;AACA,eAAO,UAAS,GAAT,EAAc,IAAd,EAAoB,KAApB,EAA2B;AAC9B,mBAAO,cAAP,CAAsB,GAAtB,EAA2B,IAA3B,EAAiC;AAC7B,0BAAU,IADmB;AAE7B,4BAAY,KAFiB;AAG7B,8BAAc,IAHe;AAI7B,uBAAO;AAJsB,aAAjC;AAMH,SAPD;AAQH,KAVD,CAUE,OAAM,CAAN,EAAS;AACP,eAAO,UAAS,GAAT,EAAc,IAAd,EAAoB,KAApB,EAA2B;AAC9B,gBAAI,IAAJ,IAAY,KAAZ;AACH,SAFD;AAGH;AACJ,CAhBiB,EAAlB;;AAkBA,IAAI,UAAU,CAAC,OAAD,EAAU,SAAV,EAAqB,MAArB,EAA6B,OAA7B,EAAsC,WAAtC,EAAmD,UAAnD,EACd,UADc,EACF,MADE,EACM,MADN,EACc,KADd,EACqB,QADrB,EAC+B,QAD/B,EACyC,YADzC,EAEd,gBAFc,EAEI,QAFJ,EAEc,QAFd,EAEwB,aAFxB,EAEuC,WAFvC,EAEoD,UAFpD,EAGd,WAHc,EAGD,oBAHC,EAGqB,WAHrB,EAGkC,oBAHlC,EAGwD,QAHxD,EAId,MAJc,EAIN,UAJM,EAIM,OAJN,EAIe,YAJf,EAI6B,UAJ7B,EAIyC,WAJzC,EAIsD,UAJtD,CAAd;;AAMA,SAAS,OAAT,GAAmB,CAAE;AACrB,QAAQ,SAAR,GAAoB,EAApB;;AAEA,IAAI,SAAS,QAAQ,MAAR,GAAiB,SAAS,UAAT,CAAqB,IAArB,EAA2B;AACrD,QAAI,EAAE,gBAAgB,MAAlB,CAAJ,EAA+B,OAAO,IAAI,MAAJ,CAAW,IAAX,CAAP;AAC/B,SAAK,IAAL,GAAY,IAAZ;AACH,CAHD;;AAKA,OAAO,SAAP,CAAiB,YAAjB,GAAgC,UAAU,OAAV,EAAmB;AAC/C,QAAI,EAAE,mBAAmB,OAArB,CAAJ,EAAmC;AAC/B,cAAM,IAAI,SAAJ,CAAc,6BAAd,CAAN;AACH;;AAED,QAAI,SAAS,SAAS,aAAT,CAAuB,QAAvB,CAAb;AACA,QAAI,CAAC,OAAO,KAAZ,EAAmB,OAAO,KAAP,GAAe,EAAf;AACnB,WAAO,KAAP,CAAa,OAAb,GAAuB,MAAvB;;AAEA,aAAS,IAAT,CAAc,WAAd,CAA0B,MAA1B;;AAEA,QAAI,MAAM,OAAO,aAAjB;AACA,QAAI,QAAQ,IAAI,IAAhB;AAAA,QAAsB,cAAc,IAAI,UAAxC;;AAEA,QAAI,CAAC,KAAD,IAAU,WAAd,EAA2B;AACvB;AACA,oBAAY,IAAZ,CAAiB,GAAjB,EAAsB,MAAtB;AACA,gBAAQ,IAAI,IAAZ;AACH;;AAED,YAAQ,YAAY,OAAZ,CAAR,EAA8B,UAAU,GAAV,EAAe;AACzC,YAAI,GAAJ,IAAW,QAAQ,GAAR,CAAX;AACH,KAFD;AAGA,YAAQ,OAAR,EAAiB,UAAU,GAAV,EAAe;AAC5B,YAAI,QAAQ,GAAR,CAAJ,EAAkB;AACd,gBAAI,GAAJ,IAAW,QAAQ,GAAR,CAAX;AACH;AACJ,KAJD;;AAMA,QAAI,UAAU,YAAY,GAAZ,CAAd;;AAEA,QAAI,MAAM,MAAM,IAAN,CAAW,GAAX,EAAgB,KAAK,IAArB,CAAV;;AAEA,YAAQ,YAAY,GAAZ,CAAR,EAA0B,UAAU,GAAV,EAAe;AACrC;AACA;AACA;AACA,YAAI,OAAO,OAAP,IAAkB,QAAQ,OAAR,EAAiB,GAAjB,MAA0B,CAAC,CAAjD,EAAoD;AAChD,oBAAQ,GAAR,IAAe,IAAI,GAAJ,CAAf;AACH;AACJ,KAPD;;AASA,YAAQ,OAAR,EAAiB,UAAU,GAAV,EAAe;AAC5B,YAAI,EAAE,OAAO,OAAT,CAAJ,EAAuB;AACnB,uBAAW,OAAX,EAAoB,GAApB,EAAyB,IAAI,GAAJ,CAAzB;AACH;AACJ,KAJD;;AAMA,aAAS,IAAT,CAAc,WAAd,CAA0B,MAA1B;;AAEA,WAAO,GAAP;AACH,CAnDD;;AAqDA,OAAO,SAAP,CAAiB,gBAAjB,GAAoC,YAAY;AAC5C,WAAO,KAAK,KAAK,IAAV,CAAP,CAD4C,CACpB;AAC3B,CAFD;;AAIA,OAAO,SAAP,CAAiB,eAAjB,GAAmC,UAAU,OAAV,EAAmB;AAClD,QAAI,MAAM,OAAO,aAAP,CAAqB,OAArB,CAAV;AACA,QAAI,MAAM,KAAK,YAAL,CAAkB,GAAlB,CAAV;;AAEA,YAAQ,YAAY,GAAZ,CAAR,EAA0B,UAAU,GAAV,EAAe;AACrC,gBAAQ,GAAR,IAAe,IAAI,GAAJ,CAAf;AACH,KAFD;;AAIA,WAAO,GAAP;AACH,CATD;;AAWA,QAAQ,YAAY,OAAO,SAAnB,CAAR,EAAuC,UAAU,IAAV,EAAgB;AACnD,YAAQ,IAAR,IAAgB,OAAO,IAAP,IAAe,UAAU,IAAV,EAAgB;AAC3C,YAAI,IAAI,OAAO,IAAP,CAAR;AACA,eAAO,EAAE,IAAF,EAAQ,KAAR,CAAc,CAAd,EAAiB,GAAG,KAAH,CAAS,IAAT,CAAc,SAAd,EAAyB,CAAzB,CAAjB,CAAP;AACH,KAHD;AAIH,CALD;;AAOA,QAAQ,YAAR,GAAuB,UAAU,IAAV,EAAgB;AACnC,WAAO,QAAQ,MAAR,CAAe,IAAf,CAAP;AACH,CAFD;;AAIA,QAAQ,aAAR,GAAwB,OAAO,aAAP,GAAuB,UAAU,OAAV,EAAmB;AAC9D,QAAI,OAAO,IAAI,OAAJ,EAAX;AACA,QAAG,OAAO,OAAP,KAAmB,QAAtB,EAAgC;AAC5B,gBAAQ,YAAY,OAAZ,CAAR,EAA8B,UAAU,GAAV,EAAe;AACzC,iBAAK,GAAL,IAAY,QAAQ,GAAR,CAAZ;AACH,SAFD;AAGH;AACD,WAAO,IAAP;AACH,CARD","file":"index-compiled.js","sourcesContent":["var indexOf = require('indexof');\n\nvar Object_keys = function (obj) {\n    if (Object.keys) return Object.keys(obj)\n    else {\n        var res = [];\n        for (var key in obj) res.push(key)\n        return res;\n    }\n};\n\nvar forEach = function (xs, fn) {\n    if (xs.forEach) return xs.forEach(fn)\n    else for (var i = 0; i < xs.length; i++) {\n        fn(xs[i], i, xs);\n    }\n};\n\nvar defineProp = (function() {\n    try {\n        Object.defineProperty({}, '_', {});\n        return function(obj, name, value) {\n            Object.defineProperty(obj, name, {\n                writable: true,\n                enumerable: false,\n                configurable: true,\n                value: value\n            })\n        };\n    } catch(e) {\n        return function(obj, name, value) {\n            obj[name] = value;\n        };\n    }\n}());\n\nvar globals = ['Array', 'Boolean', 'Date', 'Error', 'EvalError', 'Function',\n'Infinity', 'JSON', 'Math', 'NaN', 'Number', 'Object', 'RangeError',\n'ReferenceError', 'RegExp', 'String', 'SyntaxError', 'TypeError', 'URIError',\n'decodeURI', 'decodeURIComponent', 'encodeURI', 'encodeURIComponent', 'escape',\n'eval', 'isFinite', 'isNaN', 'parseFloat', 'parseInt', 'undefined', 'unescape'];\n\nfunction Context() {}\nContext.prototype = {};\n\nvar Script = exports.Script = function NodeScript (code) {\n    if (!(this instanceof Script)) return new Script(code);\n    this.code = code;\n};\n\nScript.prototype.runInContext = function (context) {\n    if (!(context instanceof Context)) {\n        throw new TypeError(\"needs a 'context' argument.\");\n    }\n    \n    var iframe = document.createElement('iframe');\n    if (!iframe.style) iframe.style = {};\n    iframe.style.display = 'none';\n    \n    document.body.appendChild(iframe);\n    \n    var win = iframe.contentWindow;\n    var wEval = win.eval, wExecScript = win.execScript;\n\n    if (!wEval && wExecScript) {\n        // win.eval() magically appears when this is called in IE:\n        wExecScript.call(win, 'null');\n        wEval = win.eval;\n    }\n    \n    forEach(Object_keys(context), function (key) {\n        win[key] = context[key];\n    });\n    forEach(globals, function (key) {\n        if (context[key]) {\n            win[key] = context[key];\n        }\n    });\n    \n    var winKeys = Object_keys(win);\n\n    var res = wEval.call(win, this.code);\n    \n    forEach(Object_keys(win), function (key) {\n        // Avoid copying circular objects like `top` and `window` by only\n        // updating existing context properties or new properties in the `win`\n        // that was only introduced after the eval.\n        if (key in context || indexOf(winKeys, key) === -1) {\n            context[key] = win[key];\n        }\n    });\n\n    forEach(globals, function (key) {\n        if (!(key in context)) {\n            defineProp(context, key, win[key]);\n        }\n    });\n    \n    document.body.removeChild(iframe);\n    \n    return res;\n};\n\nScript.prototype.runInThisContext = function () {\n    return eval(this.code); // maybe...\n};\n\nScript.prototype.runInNewContext = function (context) {\n    var ctx = Script.createContext(context);\n    var res = this.runInContext(ctx);\n\n    forEach(Object_keys(ctx), function (key) {\n        context[key] = ctx[key];\n    });\n\n    return res;\n};\n\nforEach(Object_keys(Script.prototype), function (name) {\n    exports[name] = Script[name] = function (code) {\n        var s = Script(code);\n        return s[name].apply(s, [].slice.call(arguments, 1));\n    };\n});\n\nexports.createScript = function (code) {\n    return exports.Script(code);\n};\n\nexports.createContext = Script.createContext = function (context) {\n    var copy = new Context();\n    if(typeof context === 'object') {\n        forEach(Object_keys(context), function (key) {\n            copy[key] = context[key];\n        });\n    }\n    return copy;\n};\n"]}