{"version":3,"sources":["TestHelper.js"],"names":[],"mappings":"AAAA,IAAI,KAAK,QAAQ,IAAR,CAAT;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,SAAS,QAAQ,QAAR,CAAb;;AAEA,IAAI,iBAAiB,QAAQ,0BAAR,CAArB;;AAEA,SAAS,UAAT,CAAoB,OAApB,EAA6B;AAC5B,MAAK,OAAL,GAAe,OAAf;AACA,KAAI,OAAO,IAAX;AACA,MAAK,MAAL,GAAc,UAAS,IAAT,EAAe;AAC5B,OAAK,OAAL,CAAa,IAAb;AACA,EAFD;AAGA,MAAK,KAAL,GAAa,UAAS,IAAT,EAAe;AAC3B,OAAK,MAAL,CAAY,IAAZ;AACA,EAFD;AAGA;AACD,OAAO,OAAP,GAAiB,UAAjB;;AAEA,WAAW,SAAX,CAAqB,OAArB,GAA+B,SAAS,MAAT,CAAgB,IAAhB,EAAsB;AACpD,QAAO,IAAP,CAAY,eAAe,iBAA3B,EAA8C,MAA9C,CAAqD,EAArD,CAAwD,GAAxD,CAA4D,EAA5D;AACA,MAAK,IAAL,CAAU,YAAW;AACpB,SAAO,IAAP,CAAY,KAAK,OAAjB;AACA,KAAG,SAAH,CAAa,KAAK,OAAlB;AACA;AACA,EAJS,CAIR,IAJQ,CAIH,IAJG,CAAV;AAKA,CAPD;;AASA,WAAW,SAAX,CAAqB,MAArB,GAA8B,SAAS,KAAT,CAAe,IAAf,EAAqB;AAClD,MAAK,IAAL,CAAU,GAAV,EAAe,YAAW;AACzB,SAAO,IAAP,CAAY,KAAK,OAAjB;AACA,SAAO,IAAP,CAAY,eAAe,iBAA3B,EAA8C,MAA9C,CAAqD,EAArD,CAAwD,GAAxD,CAA4D,EAA5D;AACA,OAAK,IAAL,CAAU,GAAV,EAAe,IAAf;AACA,EAJc,CAIb,IAJa,CAIR,IAJQ,CAAf;AAKA,CAND;;AAQA,WAAW,SAAX,CAAqB,GAArB,GAA2B,SAAS,GAAT,CAAa,IAAb,EAAmB;AAC7C,IAAG,SAAH,CAAa,KAAK,IAAL,CAAU,KAAK,OAAf,EAAwB,IAAxB,CAAb;AACA,CAFD;;AAIA,WAAW,SAAX,CAAqB,IAArB,GAA4B,SAAS,IAAT,CAAc,IAAd,EAAoB;AAC/C,IAAG,aAAH,CAAiB,KAAK,IAAL,CAAU,KAAK,OAAf,EAAwB,IAAxB,CAAjB,EAAgD,KAAK,MAAL,KAAgB,EAAhE,EAAoE,OAApE;AACA,CAFD;;AAIA,WAAW,SAAX,CAAqB,KAArB,GAA6B,SAAS,KAAT,CAAe,IAAf,EAAqB,KAArB,EAA4B;AACxD,KAAI,QAAQ,GAAG,QAAH,CAAY,KAAK,IAAL,CAAU,KAAK,OAAf,EAAwB,IAAxB,CAAZ,CAAZ;AACA,IAAG,UAAH,CAAc,KAAK,IAAL,CAAU,KAAK,OAAf,EAAwB,IAAxB,CAAd,EAA6C,MAAM,KAAnD,EAA0D,IAAI,IAAJ,CAAS,KAAT,CAA1D;AACA,CAHD;;AAKA,WAAW,SAAX,CAAqB,MAArB,GAA8B,SAAS,MAAT,CAAgB,IAAhB,EAAsB;AACnD,QAAO,IAAP,CAAY,KAAK,IAAL,CAAU,KAAK,OAAf,EAAwB,IAAxB,CAAZ;AACA,CAFD;;AAIA,WAAW,SAAX,CAAqB,IAArB,GAA4B,SAAS,IAAT,CAAc,GAAd,EAAmB,EAAnB,EAAuB;AAClD,KAAG,OAAO,GAAP,KAAe,UAAlB,EAA8B;AAC7B,OAAK,GAAL;AACA,QAAM,GAAN;AACA;AACD,YAAW,YAAW;AACrB;AACA,EAFD,EAEG,GAFH;AAGA,CARD","file":"TestHelper-compiled.js","sourcesContent":["var fs = require(\"fs\");\r\nvar path = require(\"path\");\r\nvar rimraf = require(\"rimraf\");\r\n\r\nvar watcherManager = require(\"../../lib/watcherManager\");\r\n\r\nfunction TestHelper(testdir) {\r\n\tthis.testdir = testdir;\r\n\tvar self = this;\r\n\tthis.before = function(done) {\r\n\t\tself._before(done);\r\n\t};\r\n\tthis.after = function(done) {\r\n\t\tself._after(done);\r\n\t};\r\n}\r\nmodule.exports = TestHelper;\r\n\r\nTestHelper.prototype._before = function before(done) {\r\n\tObject.keys(watcherManager.directoryWatchers).should.be.eql([]);\r\n\tthis.tick(function() {\r\n\t\trimraf.sync(this.testdir);\r\n\t\tfs.mkdirSync(this.testdir);\r\n\t\tdone();\r\n\t}.bind(this));\r\n};\r\n\r\nTestHelper.prototype._after = function after(done) {\r\n\tthis.tick(300, function() {\r\n\t\trimraf.sync(this.testdir);\r\n\t\tObject.keys(watcherManager.directoryWatchers).should.be.eql([]);\r\n\t\tthis.tick(300, done);\r\n\t}.bind(this));\r\n};\r\n\r\nTestHelper.prototype.dir = function dir(name) {\r\n\tfs.mkdirSync(path.join(this.testdir, name));\r\n};\r\n\r\nTestHelper.prototype.file = function file(name) {\r\n\tfs.writeFileSync(path.join(this.testdir, name), Math.random() + \"\", \"utf-8\");\r\n};\r\n\r\nTestHelper.prototype.mtime = function mtime(name, mtime) {\r\n\tvar stats = fs.statSync(path.join(this.testdir, name));\r\n\tfs.utimesSync(path.join(this.testdir, name), stats.atime, new Date(mtime));\r\n};\r\n\r\nTestHelper.prototype.remove = function remove(name) {\r\n\trimraf.sync(path.join(this.testdir, name));\r\n};\r\n\r\nTestHelper.prototype.tick = function tick(arg, fn) {\r\n\tif(typeof arg === \"function\") {\r\n\t\tfn = arg;\r\n\t\targ = 100;\r\n\t}\r\n\tsetTimeout(function() {\r\n\t\tfn();\r\n\t}, arg);\r\n};\r\n"]}