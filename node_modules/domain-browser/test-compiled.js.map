{"version":3,"sources":["test.js"],"names":[],"mappings":"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","file":"test-compiled.js","sourcesContent":["/* eslint handle-callback-err:0, no-magic-numbers:0, no-unused-vars:0 */\n'use strict'\n\n// Import\nconst events = require('events')\nconst equal = require('assert-helpers').equal\nconst joe = require('joe')\nconst domain = require('./')\n\n// =====================================\n// Tests\n\njoe.describe('domain-browser', function (describe, it) {\n\tit('should work on throws', function (done) {\n\t\tconst d = domain.create()\n\t\td.on('error', function (err) {\n\t\t\tequal(err && err.message, 'a thrown error', 'error message')\n\t\t\tdone()\n\t\t})\n\t\td.run(function () {\n\t\t\tthrow new Error('a thrown error')\n\t\t})\n\t})\n\n\tit('should be able to add emitters', function (done) {\n\t\tconst d = domain.create()\n\t\tconst emitter = new events.EventEmitter()\n\n\t\td.add(emitter)\n\t\td.on('error', function (err) {\n\t\t\tequal(err && err.message, 'an emitted error', 'error message')\n\t\t\tdone()\n\t\t})\n\n\t\temitter.emit('error', new Error('an emitted error'))\n\t})\n\n\tit('should be able to remove emitters', function (done) {\n\t\tconst emitter = new events.EventEmitter()\n\t\tconst d = domain.create()\n\t\tlet domainGotError = false\n\n\t\td.add(emitter)\n\t\td.on('error', function (err) {\n\t\t\tdomainGotError = true\n\t\t})\n\n\t\temitter.on('error', function (err) {\n\t\t\tequal(err && err.message, 'This error should not go to the domain', 'error message')\n\n\t\t\t// Make sure nothing race condition-y is happening\n\t\t\tsetTimeout(function () {\n\t\t\t\tequal(domainGotError, false, 'no domain error')\n\t\t\t\tdone()\n\t\t\t}, 0)\n\t\t})\n\n\t\td.remove(emitter)\n\t\temitter.emit('error', new Error('This error should not go to the domain'))\n\t})\n\n\tit('bind should work', function (done) {\n\t\tconst d = domain.create()\n\t\td.on('error', function (err) {\n\t\t\tequal(err && err.message, 'a thrown error', 'error message')\n\t\t\tdone()\n\t\t})\n\t\td.bind(function (err, a, b) {\n\t\t\tequal(err && err.message, 'a passed error', 'error message')\n\t\t\tequal(a, 2, 'value of a')\n\t\t\tequal(b, 3, 'value of b')\n\t\t\tthrow new Error('a thrown error')\n\t\t})(new Error('a passed error'), 2, 3)\n\t})\n\n\tit('intercept should work', function (done) {\n\t\tconst d = domain.create()\n\t\tlet count = 0\n\t\td.on('error', function (err) {\n\t\t\tif ( count === 0 ) {\n\t\t\t\tequal(err && err.message, 'a thrown error', 'error message')\n\t\t\t}\n\t\t\telse if ( count === 1 ) {\n\t\t\t\tequal(err && err.message, 'a passed error', 'error message')\n\t\t\t\tdone()\n\t\t\t}\n\t\t\tcount++\n\t\t})\n\n\t\td.intercept(function (a, b) {\n\t\t\tequal(a, 2, 'value of a')\n\t\t\tequal(b, 3, 'value of b')\n\t\t\tthrow new Error('a thrown error')\n\t\t})(null, 2, 3)\n\n\t\td.intercept(function (a, b) {\n\t\t\tthrow new Error('should never reach here')\n\t\t})(new Error('a passed error'), 2, 3)\n\t})\n})\n"]}