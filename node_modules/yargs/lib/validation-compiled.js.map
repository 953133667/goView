{"version":3,"sources":["validation.js"],"names":[],"mappings":"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","file":"validation-compiled.js","sourcesContent":["// validation-type-stuff, missing params,\n// bad implications, custom checks.\nmodule.exports = function (yargs, usage) {\n  var self = {}\n\n  // validate appropriate # of non-option\n  // arguments were provided, i.e., '_'.\n  self.nonOptionCount = function (argv) {\n    var demanded = yargs.getDemanded()\n\n    if (demanded._ && argv._.length < demanded._.count) {\n      if (demanded._.msg !== undefined) {\n        usage.fail(demanded._.msg)\n      } else {\n        usage.fail('Not enough non-option arguments: got '\n          + argv._.length + ', need at least ' + demanded._.count\n        )\n      }\n    }\n  }\n\n  // make sure that any args that require an\n  // value (--foo=bar), have a value.\n  self.missingArgumentValue = function (argv) {\n    var options = yargs.getOptions(),\n      defaultValues = [true, false, '']\n\n    if (options.requiresArg.length > 0) {\n      var missingRequiredArgs = []\n\n      options.requiresArg.forEach(function (key) {\n        var value = argv[key]\n\n        // if a value is explicitly requested,\n        // flag argument as missing if it does not\n        // look like foo=bar was entered.\n        if (~defaultValues.indexOf(value)\n        || (Array.isArray(value) && !value.length)) {\n          missingRequiredArgs.push(key)\n        }\n      })\n\n      if (missingRequiredArgs.length === 1) {\n        usage.fail('Missing argument value: ' + missingRequiredArgs[0])\n      } else if (missingRequiredArgs.length > 1) {\n        var message = 'Missing argument values: ' + missingRequiredArgs.join(', ')\n        usage.fail(message)\n      }\n    }\n  }\n\n  // make sure all the required arguments are present.\n  self.requiredArguments = function (argv) {\n    var demanded = yargs.getDemanded(),\n      missing = null\n\n    Object.keys(demanded).forEach(function (key) {\n      if (!argv.hasOwnProperty(key)) {\n        missing = missing || {}\n        missing[key] = demanded[key]\n      }\n    })\n\n    if (missing) {\n      var customMsgs = []\n      Object.keys(missing).forEach(function (key) {\n        var msg = missing[key].msg\n        if (msg && customMsgs.indexOf(msg) < 0) {\n          customMsgs.push(msg)\n        }\n      })\n\n      var customMsg = customMsgs.length ? '\\n' + customMsgs.join('\\n') : ''\n      usage.fail('Missing required arguments: ' + Object.keys(missing).join(', ') + customMsg)\n    }\n  }\n\n  // check for unknown arguments (strict-mode).\n  self.unknownArguments = function (argv, aliases) {\n    var descriptions = usage.getDescriptions(),\n      demanded = yargs.getDemanded(),\n      unknown = [],\n      aliasLookup = {}\n\n    Object.keys(aliases).forEach(function (key) {\n      aliases[key].forEach(function (alias) {\n        aliasLookup[alias] = key\n      })\n    })\n\n    Object.keys(argv).forEach(function (key) {\n      if (key !== '$0' && key !== '_' &&\n        !descriptions.hasOwnProperty(key) &&\n        !demanded.hasOwnProperty(key) &&\n        !aliasLookup.hasOwnProperty(key)) {\n        unknown.push(key)\n      }\n    })\n\n    if (unknown.length === 1) {\n      usage.fail('Unknown argument: ' + unknown[0])\n    } else if (unknown.length > 1) {\n      usage.fail('Unknown arguments: ' + unknown.join(', '))\n    }\n  }\n\n  // custom checks, added using the `check` option on yargs.\n  var checks = []\n  self.check = function (f) {\n    checks.push(f)\n  }\n\n  self.customChecks = function (argv, aliases) {\n    checks.forEach(function (f) {\n      try {\n        var result = f(argv, aliases)\n        if (!result) {\n          usage.fail('Argument check failed: ' + f.toString())\n        } else if (typeof result === 'string') {\n          usage.fail(result)\n        }\n      } catch (err) {\n        usage.fail(err.message ? err.message : err)\n      }\n    })\n  }\n\n  // check implications, argument foo implies => argument bar.\n  var implied = {}\n  self.implies = function (key, value) {\n    if (typeof key === 'object') {\n      Object.keys(key).forEach(function (k) {\n        self.implies(k, key[k])\n      })\n    } else {\n      implied[key] = value\n    }\n  }\n  self.getImplied = function () {\n    return implied\n  }\n\n  self.implications = function (argv) {\n    var implyFail = []\n\n    Object.keys(implied).forEach(function (key) {\n      var num,\n        origKey = key,\n        value = implied[key]\n\n      // convert string '1' to number 1\n      num = Number(key)\n      key = isNaN(num) ? key : num\n\n      if (typeof key === 'number') {\n        // check length of argv._\n        key = argv._.length >= key\n      } else if (key.match(/^--no-.+/)) {\n        // check if key doesn't exist\n        key = key.match(/^--no-(.+)/)[1]\n        key = !argv[key]\n      } else {\n        // check if key exists\n        key = argv[key]\n      }\n\n      num = Number(value)\n      value = isNaN(num) ? value : num\n\n      if (typeof value === 'number') {\n        value = argv._.length >= value\n      } else if (value.match(/^--no-.+/)) {\n        value = value.match(/^--no-(.+)/)[1]\n        value = !argv[value]\n      } else {\n        value = argv[value]\n      }\n\n      if (key && !value) {\n        implyFail.push(origKey)\n      }\n    })\n\n    if (implyFail.length) {\n      var msg = 'Implications failed:\\n'\n\n      implyFail.forEach(function (key) {\n        msg += ('  ' + key + ' -> ' + implied[key])\n      })\n\n      usage.fail(msg)\n    }\n  }\n\n  return self\n}\n"]}