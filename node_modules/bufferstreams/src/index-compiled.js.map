{"version":3,"sources":["index.js"],"names":[],"mappings":"AAAA,IAAI,cAAc,QAAQ,iBAAR,EAA2B,WAA7C;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;;AAEA;AACA,KAAK,QAAL,CAAc,YAAd,EAA4B,WAA5B;;AAEA;AACA,SAAS,YAAT,CAAsB,OAAtB,EAA+B,EAA/B,EAAmC;AACjC;AACA,MAAI,EAAE,gBAAgB,YAAlB,CAAJ,EAAqC;AACnC,WAAO,IAAI,YAAJ,CAAiB,OAAjB,EAA0B,EAA1B,CAAP;AACD;;AAED;AACA,MAAG,mBAAmB,QAAtB,EAAgC;AAC9B,SAAK,OAAL;AACA,cAAU,EAAV;AACD;AACD,YAAU,WAAW,EAArB;AACA,MAAG,EAAE,cAAc,QAAhB,CAAH,EAA8B;AAC5B,UAAM,IAAI,KAAJ,CAAU,wCAAV,CAAN;AACD;AACD,OAAK,YAAL,GAAoB,QAAQ,UAA5B;;AAEA;AACA,cAAY,IAAZ,CAAiB,IAAjB,EAAuB,OAAvB;;AAEA;AACA,OAAK,GAAL,GAAW,EAAX;;AAEA;AACA,OAAK,IAAL,GAAY,QAAQ,UAAR,GAAqB,EAArB,GAA0B,OAAO,EAAP,CAAtC;AACD;;AAED,aAAa,SAAb,CAAuB,UAAvB,GAAoC,UAAS,KAAT,EAAgB,QAAhB,EAA0B,IAA1B,EAAgC;;AAElE,MAAG,KAAK,YAAR,EAAsB;AACpB,SAAK,IAAL,CAAU,IAAV,CAAe,KAAf;AACD,GAFD,MAEO;AACL,SAAK,IAAL,GAAY,OAAO,MAAP,CAAc,CAAC,KAAK,IAAN,EAAY,KAAZ,CAAd,EAAkC,KAAK,IAAL,CAAU,MAAV,GAAmB,MAAM,MAA3D,CAAZ;AACD;;AAED;AAED,CAVD;;AAYA,aAAa,SAAb,CAAuB,MAAvB,GAAgC,UAAS,IAAT,EAAe;AAC7C,MAAI,QAAQ,IAAZ;;AAEA,OAAK,GAAL,CAAS,IAAT,EAAe,KAAK,IAApB,EAA0B,UAAS,GAAT,EAAc,GAAd,EAAmB;AAC3C,QAAG,OAAO,IAAI,MAAd,EAAsB;AACpB,UAAG,MAAM,YAAT,EAAuB;AACrB,YAAI,OAAJ,CAAY,UAAS,KAAT,EAAgB;AAC1B,gBAAM,IAAN,CAAW,KAAX;AACD,SAFD;AAGD,OAJD,MAIO;AACL,cAAM,IAAN,CAAW,GAAX;AACD;AACF;AACD;AACD,GAXD;AAaD,CAhBD;;AAkBA,OAAO,OAAP,GAAiB,YAAjB","file":"index-compiled.js","sourcesContent":["var PassThrough = require('readable-stream').PassThrough;\nvar util = require('util');\n\n// Inherit of PassThrough stream\nutil.inherits(BufferStream, PassThrough);\n\n// Constructor\nfunction BufferStream(options, cb) {\n  // Ensure new were used\n  if (!(this instanceof BufferStream)) {\n    return new BufferStream(options, cb);\n  }\n\n  // Cast args\n  if(options instanceof Function) {\n    cb = options;\n    options = {};\n  }\n  options = options || {};\n  if(!(cb instanceof Function)) {\n    throw new Error('The given callback must be a function.');\n  }\n  this.__objectMode = options.objectMode;\n\n  // Parent constructor\n  PassThrough.call(this, options);\n\n  // Keep a reference to the callback\n  this._cb = cb;\n\n  // Internal buffer\n  this._buf = options.objectMode ? [] : Buffer('');\n}\n\nBufferStream.prototype._transform = function(chunk, encoding, done) {\n\n  if(this.__objectMode) {\n    this._buf.push(chunk);\n  } else {\n    this._buf = Buffer.concat([this._buf, chunk], this._buf.length + chunk.length);\n  }\n\n  done();\n\n};\n\nBufferStream.prototype._flush = function(done) {\n  var _this = this;\n\n  this._cb(null, this._buf, function(err, buf) {\n    if(buf && buf.length) {\n      if(_this.__objectMode) {\n        buf.forEach(function(chunk) {\n          _this.push(chunk);\n        });\n      } else {\n        _this.push(buf);\n      }\n    }\n    done();\n  });\n\n};\n\nmodule.exports = BufferStream;\n"]}