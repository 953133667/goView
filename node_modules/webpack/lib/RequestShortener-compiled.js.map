{"version":3,"sources":["RequestShortener.js"],"names":[],"mappings":"AAAA;;;;AAIA,IAAI,OAAO,QAAQ,MAAR,CAAX;;AAEA,SAAS,gBAAT,CAA0B,SAA1B,EAAqC;AACpC,aAAY,UAAU,OAAV,CAAkB,KAAlB,EAAyB,GAAzB,CAAZ;AACA,KAAI,kBAAkB,KAAK,OAAL,CAAa,SAAb,CAAtB;AACA,KAAG,UAAU,IAAV,CAAe,SAAf,CAAH,EAA8B,YAAY,UAAU,MAAV,CAAiB,CAAjB,EAAoB,UAAU,MAAV,GAAmB,CAAvC,CAAZ;AAC9B,KAAG,SAAH,EAAc;AACb,MAAI,yBAAyB,UAAU,OAAV,CAAkB,0BAAlB,EAA8C,MAA9C,CAA7B;AACA,2BAAyB,IAAI,MAAJ,CAAW,MAAM,sBAAN,GAA+B,MAA/B,GAAwC,sBAAnD,EAA2E,GAA3E,CAAzB;;AAEA,OAAK,sBAAL,GAA8B,sBAA9B;AACA;;AAED,KAAG,UAAU,IAAV,CAAe,eAAf,CAAH,EAAoC,kBAAkB,gBAAgB,MAAhB,CAAuB,CAAvB,EAA0B,gBAAgB,MAAhB,GAAyB,CAAnD,CAAlB;AACpC,KAAG,mBAAmB,oBAAoB,SAA1C,EAAqD;AACpD,MAAI,wBAAwB,gBAAgB,OAAhB,CAAwB,0BAAxB,EAAoD,MAApD,CAA5B;AACA,0BAAwB,IAAI,MAAJ,CAAW,MAAM,qBAAN,GAA8B,MAA9B,GAAuC,qBAAlD,EAAyE,GAAzE,CAAxB;;AAEA,OAAK,qBAAL,GAA6B,qBAA7B;AACA;;AAED,KAAG,UAAU,MAAV,IAAoB,CAAvB,EAA0B;AACzB,MAAI,WAAW,KAAK,IAAL,CAAU,SAAV,EAAqB,IAArB,EAA2B,OAA3B,CAAmC,KAAnC,EAA0C,GAA1C,CAAf;AACA,MAAI,mBAAmB,0BAA0B,uBAAuB,IAAvB,CAA4B,QAA5B,CAAjD;AACA,MAAI,iBAAiB,SAAS,OAAT,CAAiB,0BAAjB,EAA6C,MAA7C,CAArB;AACA,mBAAiB,IAAI,MAAJ,CAAW,MAAM,cAAN,GAAuB,MAAvB,GAAgC,cAA3C,EAA2D,GAA3D,CAAjB;;AAEA,OAAK,gBAAL,GAAwB,gBAAxB;AACA,OAAK,cAAL,GAAsB,cAAtB;AACA;;AAED,MAAK,iBAAL,GAAyB,mBAAzB;AACA,MAAK,aAAL,GAAqB,6BAArB;AACA;AACD,OAAO,OAAP,GAAiB,gBAAjB;;AAEA,iBAAiB,SAAjB,CAA2B,OAA3B,GAAqC,UAAS,OAAT,EAAkB;AACtD,KAAG,CAAC,OAAJ,EACC,OAAO,OAAP;AACD,WAAU,QAAQ,OAAR,CAAgB,KAAhB,EAAuB,GAAvB,CAAV;AACA,KAAG,KAAK,gBAAL,IAAyB,KAAK,cAAjC,EACC,UAAU,QAAQ,OAAR,CAAgB,KAAK,cAArB,EAAqC,YAArC,CAAV;AACD,KAAG,KAAK,sBAAR,EACC,UAAU,QAAQ,OAAR,CAAgB,KAAK,sBAArB,EAA6C,IAA7C,CAAV;AACD,KAAG,KAAK,qBAAR,EACC,UAAU,QAAQ,OAAR,CAAgB,KAAK,qBAArB,EAA4C,KAA5C,CAAV;AACD,KAAG,CAAC,KAAK,gBAAN,IAA0B,KAAK,cAAlC,EACC,UAAU,QAAQ,OAAR,CAAgB,KAAK,cAArB,EAAqC,YAArC,CAAV;AACD,WAAU,QAAQ,OAAR,CAAgB,KAAK,iBAArB,EAAwC,KAAxC,CAAV;AACA,WAAU,QAAQ,OAAR,CAAgB,KAAK,aAArB,EAAoC,IAApC,CAAV;AACA,QAAO,QAAQ,OAAR,CAAgB,OAAhB,EAAyB,EAAzB,CAAP;AACA,CAfD","file":"RequestShortener-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar path = require(\"path\");\r\n\r\nfunction RequestShortener(directory) {\r\n\tdirectory = directory.replace(/\\\\/g, \"/\");\r\n\tvar parentDirectory = path.dirname(directory);\r\n\tif(/[\\/\\\\]$/.test(directory)) directory = directory.substr(0, directory.length - 1);\r\n\tif(directory) {\r\n\t\tvar currentDirectoryRegExp = directory.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n\t\tcurrentDirectoryRegExp = new RegExp(\"^\" + currentDirectoryRegExp + \"|(!)\" + currentDirectoryRegExp, \"g\");\r\n\r\n\t\tthis.currentDirectoryRegExp = currentDirectoryRegExp;\r\n\t}\r\n\r\n\tif(/[\\/\\\\]$/.test(parentDirectory)) parentDirectory = parentDirectory.substr(0, parentDirectory.length - 1);\r\n\tif(parentDirectory && parentDirectory !== directory) {\r\n\t\tvar parentDirectoryRegExp = parentDirectory.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n\t\tparentDirectoryRegExp = new RegExp(\"^\" + parentDirectoryRegExp + \"|(!)\" + parentDirectoryRegExp, \"g\");\r\n\r\n\t\tthis.parentDirectoryRegExp = parentDirectoryRegExp;\r\n\t}\r\n\r\n\tif(__dirname.length >= 2) {\r\n\t\tvar buildins = path.join(__dirname, \"..\").replace(/\\\\/g, \"/\");\r\n\t\tvar buildinsAsModule = currentDirectoryRegExp && currentDirectoryRegExp.test(buildins);\r\n\t\tvar buildinsRegExp = buildins.replace(/[-[\\]{}()*+?.,\\\\^$|#\\s]/g, \"\\\\$&\");\r\n\t\tbuildinsRegExp = new RegExp(\"^\" + buildinsRegExp + \"|(!)\" + buildinsRegExp, \"g\");\r\n\r\n\t\tthis.buildinsAsModule = buildinsAsModule;\r\n\t\tthis.buildinsRegExp = buildinsRegExp;\r\n\t}\r\n\r\n\tthis.nodeModulesRegExp = /\\/node_modules\\//g;\r\n\tthis.indexJsRegExp = /\\/index.js(!|\\?|\\(query\\))/g;\r\n}\r\nmodule.exports = RequestShortener;\r\n\r\nRequestShortener.prototype.shorten = function(request) {\r\n\tif(!request)\r\n\t\treturn request;\r\n\trequest = request.replace(/\\\\/g, \"/\");\r\n\tif(this.buildinsAsModule && this.buildinsRegExp)\r\n\t\trequest = request.replace(this.buildinsRegExp, \"!(webpack)\");\r\n\tif(this.currentDirectoryRegExp)\r\n\t\trequest = request.replace(this.currentDirectoryRegExp, \"!.\");\r\n\tif(this.parentDirectoryRegExp)\r\n\t\trequest = request.replace(this.parentDirectoryRegExp, \"!..\");\r\n\tif(!this.buildinsAsModule && this.buildinsRegExp)\r\n\t\trequest = request.replace(this.buildinsRegExp, \"!(webpack)\");\r\n\trequest = request.replace(this.nodeModulesRegExp, \"/~/\");\r\n\trequest = request.replace(this.indexJsRegExp, \"$1\");\r\n\treturn request.replace(/^!|!$/, \"\");\r\n};\r\n"]}