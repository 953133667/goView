{"version":3,"sources":["DedupePlugin.js"],"names":[],"mappings":"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","file":"DedupePlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar ConcatSource = require(\"webpack-core/lib/ConcatSource\");\r\nvar TemplateArgumentDependency = require(\"../dependencies/TemplateArgumentDependency\");\r\n\r\nfunction DedupePlugin() {}\r\nmodule.exports = DedupePlugin;\r\n\r\nDedupePlugin.prototype.apply = function(compiler) {\r\n\tcompiler.plugin(\"compilation\", function(compilation) {\r\n\r\n\t\tcompilation.dependencyTemplates.set(TemplateArgumentDependency, new TemplateArgumentDependency.Template());\r\n\r\n\t\tcompilation.plugin(\"after-optimize-tree\", function(chunks, modules) {\r\n\t\t\tvar modulesByHash = {};\r\n\t\t\tvar allDups = [];\r\n\t\t\tmodules.forEach(function(module) {\r\n\t\t\t\tif(!module.getSourceHash || !module.getAllModuleDependencies || !module.createTemplate || !module.getTemplateArguments || module.blocks.length > 0) return;\r\n\t\t\t\tvar hash = module.getSourceHash();\r\n\t\t\t\tvar dupModule = modulesByHash[hash];\r\n\t\t\t\tif(dupModule) {\r\n\t\t\t\t\tif(dupModule.duplicates) {\r\n\t\t\t\t\t\tdupModule.duplicates.push(module);\r\n\t\t\t\t\t\tmodule.duplicates = dupModule.duplicates;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tallDups.push(module.duplicates = dupModule.duplicates = [dupModule, module]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmodulesByHash[hash] = module;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tvar entryChunks = chunks.filter(function(c) {\r\n\t\t\t\treturn c.entry;\r\n\t\t\t});\r\n\t\t\tentryChunks.forEach(function(chunk) { // for each entry chunk\r\n\t\t\t\tvar hasDeduplicatedModules = false;\r\n\t\t\t\t(function x(dups, roots, visited, chunk) {\r\n\t\t\t\t\tvar currentDups = [];\r\n\t\t\t\t\tvar currentRoots = [];\r\n\t\t\t\t\tchunk.modules.forEach(function(module) {\r\n\t\t\t\t\t\tif(module.duplicates) {\r\n\t\t\t\t\t\t\tif(!module.rootDuplicatesChunks)\r\n\t\t\t\t\t\t\t\tmodule.rootDuplicatesChunks = module.chunks.slice();\r\n\t\t\t\t\t\t\tvar chunkIndex = module.rootDuplicatesChunks.indexOf(chunk);\r\n\t\t\t\t\t\t\tif(!module.rootDuplicates) module.rootDuplicates = [];\r\n\t\t\t\t\t\t\tvar idx = currentDups.indexOf(module.duplicates);\r\n\t\t\t\t\t\t\tif(idx >= 0) {\r\n\t\t\t\t\t\t\t\tmodule.rootDuplicates[chunkIndex] = currentRoots[idx];\r\n\t\t\t\t\t\t\t\tmodule.rootDuplicates[chunkIndex].push(module);\r\n\t\t\t\t\t\t\t\tmodule.rootDuplicates[chunkIndex].commonModules =\r\n\t\t\t\t\t\t\t\t\tmergeCommonModules(module.rootDuplicates[chunkIndex].commonModules, module.getAllModuleDependencies());\r\n\t\t\t\t\t\t\t\thasDeduplicatedModules = true;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tidx = dups.indexOf(module.duplicates);\r\n\t\t\t\t\t\t\t\tif(idx < 0) {\r\n\t\t\t\t\t\t\t\t\tmodule.rootDuplicates[chunkIndex] = [module];\r\n\t\t\t\t\t\t\t\t\tmodule.rootDuplicates[chunkIndex].commonModules = module.getAllModuleDependencies();\r\n\t\t\t\t\t\t\t\t\tmodule.rootDuplicates[chunkIndex].initialCommonModulesLength = module.rootDuplicates[chunkIndex].commonModules.length;\r\n\t\t\t\t\t\t\t\t\tdups = dups.concat([module.duplicates]);\r\n\t\t\t\t\t\t\t\t\troots = roots.concat([module.rootDuplicates[chunkIndex]]);\r\n\t\t\t\t\t\t\t\t\tcurrentDups = currentDups.concat([module.duplicates]);\r\n\t\t\t\t\t\t\t\t\tcurrentRoots = currentRoots.concat([module.rootDuplicates[chunkIndex]]);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tmodule.rootDuplicates[chunkIndex] = roots[idx];\r\n\t\t\t\t\t\t\t\t\tmodule.rootDuplicates[chunkIndex].commonModules =\r\n\t\t\t\t\t\t\t\t\t\tmergeCommonModules(module.rootDuplicates[chunkIndex].commonModules, module.getAllModuleDependencies());\r\n\t\t\t\t\t\t\t\t\thasDeduplicatedModules = true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tchunk.chunks.forEach(function(chunk) {\r\n\t\t\t\t\t\tif(visited.indexOf(chunk) < 0)\r\n\t\t\t\t\t\t\tx(dups, roots, visited.concat(chunk), chunk);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tcurrentRoots.forEach(function(roots) {\r\n\t\t\t\t\t\tvar commonModules = roots.commonModules;\r\n\t\t\t\t\t\tvar initialLength = roots.initialCommonModulesLength;\r\n\t\t\t\t\t\tif(initialLength !== commonModules.length) {\r\n\t\t\t\t\t\t\tvar template = roots[0].createTemplate(commonModules, roots.slice());\r\n\t\t\t\t\t\t\troots.template = template;\r\n\t\t\t\t\t\t\tchunk.addModule(template);\r\n\t\t\t\t\t\t\ttemplate.addChunk(chunk);\r\n\t\t\t\t\t\t\tcompilation.modules.push(template);\r\n\t\t\t\t\t\t\thasDeduplicatedModules = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}([], [], [], chunk));\r\n\t\t\t\tif(hasDeduplicatedModules)\r\n\t\t\t\t\tchunk.__DedupePluginHasDeduplicatedModules = true;\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tfunction mergeCommonModules(commonModules, newModules) {\r\n\t\t\treturn commonModules.filter(function(module) {\r\n\t\t\t\treturn newModules.indexOf(module) >= 0;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tcompilation.moduleTemplate.plugin(\"package\", function(moduleSource, module, chunk) {\r\n\t\t\tif(!module.rootDuplicatesChunks || !chunk) return moduleSource;\r\n\t\t\tvar chunkIndex = module.rootDuplicatesChunks.indexOf(chunk);\r\n\t\t\tif(!module.rootDuplicates || !module.rootDuplicates[chunkIndex]) return moduleSource;\r\n\t\t\tvar rootDuplicates = module.rootDuplicates[chunkIndex];\r\n\t\t\tif(rootDuplicates.template) {\r\n\t\t\t\trootDuplicates.template.addReason(module, {\r\n\t\t\t\t\ttype: \"template\",\r\n\t\t\t\t\trequest: module.request,\r\n\t\t\t\t\ttemplateModules: rootDuplicates.template.templateModules\r\n\t\t\t\t});\r\n\t\t\t\trootDuplicates.template.reasons.sort(function(a, b) {\r\n\t\t\t\t\tif(a.request === b.request) return 0;\r\n\t\t\t\t\treturn a.request < b.request ? -1 : 1;\r\n\t\t\t\t});\r\n\t\t\t\tvar array = [JSON.stringify(rootDuplicates.template.id)].concat(module.getTemplateArguments(rootDuplicates.template.templateModules).map(function(module) {\r\n\t\t\t\t\tif(module.id === null || module.id === undefined)\r\n\t\t\t\t\t\treturn \"(function webpackMissingModule() { throw new Error(\" + JSON.stringify(\"Cannot find module\") + \"); }())\";\r\n\t\t\t\t\treturn JSON.stringify(module.id);\r\n\t\t\t\t}));\r\n\t\t\t\tvar source = new ConcatSource(\"[\" + array.join(\", \") + \"]\");\r\n\t\t\t\treturn source;\r\n\t\t\t} else {\r\n\t\t\t\trootDuplicates.sort(function(a, b) {\r\n\t\t\t\t\treturn a.id - b.id;\r\n\t\t\t\t});\r\n\t\t\t\tif(module === rootDuplicates[0]) return moduleSource;\r\n\t\t\t\tvar source = new ConcatSource(\"\" + JSON.stringify(rootDuplicates[0].id));\r\n\t\t\t\treturn source;\r\n\t\t\t}\r\n\t\t});\r\n\t\tcompilation.plugin(\"chunk-hash\", function(chunk, hash) {\r\n\t\t\tif(chunk.__DedupePluginHasDeduplicatedModules)\r\n\t\t\t\thash.update(\"DedupePlugin (deduplication code)\");\r\n\t\t});\r\n\t\tcompilation.mainTemplate.plugin(\"add-module\", function(source, chunk, hash, varModuleId, varModule) {\r\n\t\t\t// we don't need to test all nested chunks, because `__DedupePluginHasDeduplicatedModules`\r\n\t\t\t// is not set on entry chunks\r\n\t\t\tif(!chunk.__DedupePluginHasDeduplicatedModules) {\r\n\t\t\t\treturn source;\r\n\t\t\t}\r\n\t\t\treturn this.asString([\r\n\t\t\t\t\"var _m = \" + varModule + \";\",\r\n\t\t\t\t\"\",\r\n\t\t\t\t\"// Check if module is deduplicated\",\r\n\t\t\t\t\"switch(typeof _m) {\",\r\n\t\t\t\t\"case \\\"object\\\":\",\r\n\t\t\t\tthis.indent([\r\n\t\t\t\t\t\"// Module can be created from a template\",\r\n\t\t\t\t\t\"modules[\" + varModuleId + \"] = (function(_m) {\",\r\n\t\t\t\t\tthis.indent([\r\n\t\t\t\t\t\t\"var args = _m.slice(1), templateId = _m[0];\",\r\n\t\t\t\t\t\t\"return function (a,b,c) {\",\r\n\t\t\t\t\t\tthis.indent([\r\n\t\t\t\t\t\t\t\"modules[templateId].apply(this, [a,b,c].concat(args));\"\r\n\t\t\t\t\t\t]),\r\n\t\t\t\t\t\t\"};\"\r\n\t\t\t\t\t]),\r\n\t\t\t\t\t\"}(_m));\",\r\n\t\t\t\t\t\"break;\"\r\n\t\t\t\t]),\r\n\t\t\t\t\"case \\\"function\\\":\",\r\n\t\t\t\tthis.indent([\r\n\t\t\t\t\t\"// Normal module\",\r\n\t\t\t\t\t\"modules[\" + varModuleId + \"] = _m;\",\r\n\t\t\t\t\t\"break;\"\r\n\t\t\t\t]),\r\n\t\t\t\t\"default:\",\r\n\t\t\t\tthis.indent([\r\n\t\t\t\t\t\"// Module is a copy of another module\",\r\n\t\t\t\t\t\"modules[\" + varModuleId + \"] = modules[_m];\",\r\n\t\t\t\t\t\"break;\"\r\n\t\t\t\t]),\r\n\t\t\t\t\"}\"\r\n\t\t\t]);\r\n\t\t});\r\n\t\tcompilation.mainTemplate.plugin(\"modules\", function(orginalSource, chunk) {\r\n\t\t\tif(!chunk.__DedupePluginHasDeduplicatedModules) {\r\n\t\t\t\treturn orginalSource;\r\n\t\t\t}\r\n\t\t\tvar source = new ConcatSource();\r\n\t\t\tsource.add(\"(function(modules) {\\n\");\r\n\t\t\tsource.add(this.indent([\r\n\t\t\t\t\"// Check all modules for deduplicated modules\",\r\n\t\t\t\t\"for(var i in modules) {\",\r\n\t\t\t\tthis.indent([\r\n\t\t\t\t\t\"if(Object.prototype.hasOwnProperty.call(modules, i)) {\",\r\n\t\t\t\t\tthis.indent([\r\n\t\t\t\t\t\t\"switch(typeof modules[i]) {\",\r\n\t\t\t\t\t\t\"case \\\"function\\\": break;\",\r\n\t\t\t\t\t\t\"case \\\"object\\\":\",\r\n\t\t\t\t\t\tthis.indent([\r\n\t\t\t\t\t\t\t\"// Module can be created from a template\",\r\n\t\t\t\t\t\t\t\"modules[i] = (function(_m) {\",\r\n\t\t\t\t\t\t\tthis.indent([\r\n\t\t\t\t\t\t\t\t\"var args = _m.slice(1), fn = modules[_m[0]];\",\r\n\t\t\t\t\t\t\t\t\"return function (a,b,c) {\",\r\n\t\t\t\t\t\t\t\tthis.indent([\r\n\t\t\t\t\t\t\t\t\t\"fn.apply(this, [a,b,c].concat(args));\"\r\n\t\t\t\t\t\t\t\t]),\r\n\t\t\t\t\t\t\t\t\"};\"\r\n\t\t\t\t\t\t\t]),\r\n\t\t\t\t\t\t\t\"}(modules[i]));\",\r\n\t\t\t\t\t\t\t\"break;\"\r\n\t\t\t\t\t\t]),\r\n\t\t\t\t\t\t\"default:\",\r\n\t\t\t\t\t\tthis.indent([\r\n\t\t\t\t\t\t\t\"// Module is a copy of another module\",\r\n\t\t\t\t\t\t\t\"modules[i] = modules[modules[i]];\",\r\n\t\t\t\t\t\t\t\"break;\"\r\n\t\t\t\t\t\t]),\r\n\t\t\t\t\t\t\"}\"\r\n\t\t\t\t\t]),\r\n\t\t\t\t\t\"}\"\r\n\t\t\t\t]),\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"return modules;\"\r\n\t\t\t]));\r\n\t\t\tsource.add(\"\\n}(\");\r\n\t\t\tsource.add(orginalSource);\r\n\t\t\tsource.add(\"))\");\r\n\t\t\treturn source;\r\n\t\t});\r\n\t});\r\n};\r\n"]}