{"version":3,"sources":["AggressiveMergingPlugin.js"],"names":[],"mappings":"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","file":"AggressiveMergingPlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nfunction AggressiveMergingPlugin(options) {\r\n\tif(options !== undefined && typeof options !== \"object\" || Array.isArray(options)) {\r\n\t\tthrow new Error(\"Argument should be an options object. To use defaults, pass in nothing.\\nFor more info on options, see https://webpack.github.io/docs/list-of-plugins.html\");\r\n\t}\r\n\tthis.options = options || {};\r\n}\r\nmodule.exports = AggressiveMergingPlugin;\r\n\r\nAggressiveMergingPlugin.prototype.apply = function(compiler) {\r\n\tvar options = this.options;\r\n\tvar minSizeReduce = options.minSizeReduce || 1.5;\r\n\r\n\tfunction getParentsWeight(chunk) {\r\n\t\treturn chunk.parents.map(function(p) {\r\n\t\t\treturn p.initial ? options.entryChunkMultiplicator || 10 : 1;\r\n\t\t}).reduce(function(a, b) {\r\n\t\t\treturn a + b;\r\n\t\t}, 0);\r\n\t}\r\n\tcompiler.plugin(\"compilation\", function(compilation) {\r\n\t\tcompilation.plugin(\"optimize-chunks\", function(chunks) {\r\n\t\t\tvar combinations = [];\r\n\t\t\tchunks.forEach(function(a, idx) {\r\n\t\t\t\tif(a.initial) return;\r\n\t\t\t\tfor(var i = 0; i < idx; i++) {\r\n\t\t\t\t\tvar b = chunks[i];\r\n\t\t\t\t\tif(b.initial) continue;\r\n\t\t\t\t\tcombinations.push([b, a]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tcombinations.forEach(function(pair) {\r\n\t\t\t\tvar a = pair[0].size({\r\n\t\t\t\t\tchunkOverhead: 0\r\n\t\t\t\t});\r\n\t\t\t\tvar b = pair[1].size({\r\n\t\t\t\t\tchunkOverhead: 0\r\n\t\t\t\t});\r\n\t\t\t\tvar ab = pair[0].integratedSize(pair[1], {\r\n\t\t\t\t\tchunkOverhead: 0\r\n\t\t\t\t});\r\n\t\t\t\tpair.push({\r\n\t\t\t\t\ta: a,\r\n\t\t\t\t\tb: b,\r\n\t\t\t\t\tab: ab\r\n\t\t\t\t});\r\n\t\t\t\tif(ab === false) {\r\n\t\t\t\t\tpair.unshift(false);\r\n\t\t\t\t} else if(options.moveToParents) {\r\n\t\t\t\t\tvar aOnly = ab - b;\r\n\t\t\t\t\tvar bOnly = ab - a;\r\n\t\t\t\t\tvar common = a + b - ab;\r\n\t\t\t\t\tvar newSize = common + getParentsWeight(pair[0]) * aOnly + getParentsWeight(pair[1]) * bOnly;\r\n\t\t\t\t\tpair.push({\r\n\t\t\t\t\t\taOnly: aOnly,\r\n\t\t\t\t\t\tbOnly: bOnly,\r\n\t\t\t\t\t\tcommon: common,\r\n\t\t\t\t\t\tnewSize: newSize\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvar newSize = ab;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpair.unshift((a + b) / newSize);\r\n\t\t\t});\r\n\t\t\tcombinations = combinations.filter(function(pair) {\r\n\t\t\t\treturn pair[0] !== false;\r\n\t\t\t});\r\n\t\t\tcombinations.sort(function(a, b) {\r\n\t\t\t\treturn b[0] - a[0];\r\n\t\t\t});\r\n\r\n\t\t\tvar pair = combinations[0];\r\n\r\n\t\t\tif(!pair) return;\r\n\t\t\tif(pair[0] < minSizeReduce) return;\r\n\r\n\t\t\tif(options.moveToParents) {\r\n\t\t\t\tvar commonModules = pair[1].modules.filter(function(m) {\r\n\t\t\t\t\treturn pair[2].modules.indexOf(m) >= 0;\r\n\t\t\t\t});\r\n\t\t\t\tvar aOnlyModules = pair[1].modules.filter(function(m) {\r\n\t\t\t\t\treturn commonModules.indexOf(m) < 0;\r\n\t\t\t\t});\r\n\t\t\t\tvar bOnlyModules = pair[2].modules.filter(function(m) {\r\n\t\t\t\t\treturn commonModules.indexOf(m) < 0;\r\n\t\t\t\t});\r\n\t\t\t\taOnlyModules.forEach(function(m) {\r\n\t\t\t\t\tpair[1].removeModule(m);\r\n\t\t\t\t\tm.removeChunk(pair[1]);\r\n\t\t\t\t\tpair[1].parents.forEach(function(c) {\r\n\t\t\t\t\t\tc.addModule(m);\r\n\t\t\t\t\t\tm.addChunk(c);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tbOnlyModules.forEach(function(m) {\r\n\t\t\t\t\tpair[2].removeModule(m);\r\n\t\t\t\t\tm.removeChunk(pair[2]);\r\n\t\t\t\t\tpair[2].parents.forEach(function(c) {\r\n\t\t\t\t\t\tc.addModule(m);\r\n\t\t\t\t\t\tm.addChunk(c);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tif(pair[1].integrate(pair[2], \"aggressive-merge\")) {\r\n\t\t\t\tchunks.splice(chunks.indexOf(pair[2]), 1);\r\n\t\t\t\tthis.restartApplyPlugins();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n};\r\n"]}