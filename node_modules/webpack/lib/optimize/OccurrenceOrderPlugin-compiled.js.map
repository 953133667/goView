{"version":3,"sources":["OccurrenceOrderPlugin.js"],"names":[],"mappings":"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","file":"OccurrenceOrderPlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nfunction OccurrenceOrderPlugin(preferEntry) {\r\n\tif(preferEntry !== undefined && typeof preferEntry !== \"boolean\") {\r\n\t\tthrow new Error(\"Argument should be a boolean.\\nFor more info on this plugin, see https://webpack.github.io/docs/list-of-plugins.html\");\r\n\t}\r\n\tthis.preferEntry = preferEntry;\r\n}\r\nmodule.exports = OccurrenceOrderPlugin;\r\nOccurrenceOrderPlugin.prototype.apply = function(compiler) {\r\n\tvar preferEntry = this.preferEntry;\r\n\tcompiler.plugin(\"compilation\", function(compilation) {\r\n\t\tcompilation.plugin(\"optimize-module-order\", function(modules) {\r\n\t\t\tfunction entryChunks(m) {\r\n\t\t\t\treturn m.chunks.filter(function(c) {\r\n\t\t\t\t\treturn c.initial;\r\n\t\t\t\t}).length;\r\n\t\t\t}\r\n\r\n\t\t\tfunction occursInEntry(m) {\r\n\t\t\t\treturn m.reasons.map(function(r) {\r\n\t\t\t\t\tif(!r.module) return 0;\r\n\t\t\t\t\treturn entryChunks(r.module);\r\n\t\t\t\t}).reduce(function(a, b) {\r\n\t\t\t\t\treturn a + b;\r\n\t\t\t\t}, 0) + entryChunks(m);\r\n\t\t\t}\r\n\r\n\t\t\tfunction occurs(m) {\r\n\t\t\t\treturn m.reasons.map(function(r) {\r\n\t\t\t\t\tif(!r.module) return 0;\r\n\t\t\t\t\treturn r.module.chunks.length;\r\n\t\t\t\t}).reduce(function(a, b) {\r\n\t\t\t\t\treturn a + b;\r\n\t\t\t\t}, 0) + m.chunks.length;\r\n\t\t\t}\r\n\t\t\tmodules.sort(function(a, b) {\r\n\t\t\t\tif(preferEntry) {\r\n\t\t\t\t\tvar aEntryOccurs = occursInEntry(a);\r\n\t\t\t\t\tvar bEntryOccurs = occursInEntry(b);\r\n\t\t\t\t\tif(aEntryOccurs > bEntryOccurs) return -1;\r\n\t\t\t\t\tif(aEntryOccurs < bEntryOccurs) return 1;\r\n\t\t\t\t}\r\n\t\t\t\tvar aOccurs = occurs(a);\r\n\t\t\t\tvar bOccurs = occurs(b);\r\n\t\t\t\tif(aOccurs > bOccurs) return -1;\r\n\t\t\t\tif(aOccurs < bOccurs) return 1;\r\n\t\t\t\tif(a.identifier() > b.identifier()) return 1;\r\n\t\t\t\tif(a.identifier() < b.identifier()) return -1;\r\n\t\t\t\treturn 0;\r\n\t\t\t});\r\n\t\t});\r\n\t\tcompilation.plugin(\"optimize-chunk-order\", function(chunks) {\r\n\t\t\tfunction occursInEntry(c) {\r\n\t\t\t\treturn c.parents.filter(function(p) {\r\n\t\t\t\t\treturn p.initial;\r\n\t\t\t\t}).length + (c.entry ? 1 : 0);\r\n\t\t\t}\r\n\r\n\t\t\tfunction occurs(c) {\r\n\t\t\t\treturn c.blocks.length + (c.entry ? 1 : 0);\r\n\t\t\t}\r\n\t\t\tchunks.forEach(function(c) {\r\n\t\t\t\tc.modules.sort(function(a, b) {\r\n\t\t\t\t\tif(a.identifier() > b.identifier()) return 1;\r\n\t\t\t\t\tif(a.identifier() < b.identifier()) return -1;\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\tchunks.sort(function(a, b) {\r\n\t\t\t\tvar aEntryOccurs = occursInEntry(a);\r\n\t\t\t\tvar bEntryOccurs = occursInEntry(b);\r\n\t\t\t\tif(aEntryOccurs > bEntryOccurs) return -1;\r\n\t\t\t\tif(aEntryOccurs < bEntryOccurs) return 1;\r\n\t\t\t\tvar aOccurs = occurs(a);\r\n\t\t\t\tvar bOccurs = occurs(b);\r\n\t\t\t\tif(aOccurs > bOccurs) return -1;\r\n\t\t\t\tif(aOccurs < bOccurs) return 1;\r\n\t\t\t\tif(a.modules.length > b.modules.length) return -1;\r\n\t\t\t\tif(a.modules.length < b.modules.length) return 1;\r\n\t\t\t\tfor(var i = 0; i < a.modules.length; i++) {\r\n\t\t\t\t\tif(a.modules[i].identifier() > b.modules[i].identifier()) return -1;\r\n\t\t\t\t\tif(a.modules[i].identifier() < b.modules[i].identifier()) return 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t});\r\n\t\t});\r\n\t});\r\n};\r\n"]}