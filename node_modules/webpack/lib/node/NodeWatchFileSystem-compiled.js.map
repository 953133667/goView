{"version":3,"sources":["NodeWatchFileSystem.js"],"names":[],"mappings":"AAAA;;;;AAIA,IAAI,YAAY,QAAQ,WAAR,CAAhB;;AAEA,SAAS,mBAAT,CAA6B,eAA7B,EAA8C;AAC7C,MAAK,eAAL,GAAuB,eAAvB;AACA,MAAK,cAAL,GAAsB;AACrB,oBAAkB;AADG,EAAtB;AAGA,MAAK,OAAL,GAAe,IAAI,SAAJ,CAAc,KAAK,cAAnB,CAAf;AACA;;AAED,OAAO,OAAP,GAAiB,mBAAjB;;AAEA,oBAAoB,SAApB,CAA8B,KAA9B,GAAsC,SAAS,KAAT,CAAe,KAAf,EAAsB,IAAtB,EAA4B,OAA5B,EAAqC,SAArC,EAAgD,OAAhD,EAAyD,QAAzD,EAAmE,iBAAnE,EAAsF;AAC3H,KAAG,CAAC,MAAM,OAAN,CAAc,KAAd,CAAJ,EACC,MAAM,IAAI,KAAJ,CAAU,4BAAV,CAAN;AACD,KAAG,CAAC,MAAM,OAAN,CAAc,IAAd,CAAJ,EACC,MAAM,IAAI,KAAJ,CAAU,2BAAV,CAAN;AACD,KAAG,CAAC,MAAM,OAAN,CAAc,OAAd,CAAJ,EACC,MAAM,IAAI,KAAJ,CAAU,8BAAV,CAAN;AACD,KAAG,OAAO,QAAP,KAAoB,UAAvB,EACC,MAAM,IAAI,KAAJ,CAAU,+BAAV,CAAN;AACD,KAAG,OAAO,SAAP,KAAqB,QAArB,IAAiC,SAApC,EACC,MAAM,IAAI,KAAJ,CAAU,gCAAV,CAAN;AACD,KAAG,OAAO,OAAP,KAAmB,QAAtB,EACC,MAAM,IAAI,KAAJ,CAAU,8BAAV,CAAN;AACD,KAAG,OAAO,iBAAP,KAA6B,UAA7B,IAA2C,iBAA9C,EACC,MAAM,IAAI,KAAJ,CAAU,wCAAV,CAAN;AACD,KAAI,aAAa,KAAK,OAAtB;AACA,MAAK,OAAL,GAAe,IAAI,SAAJ,CAAc,OAAd,CAAf;;AAEA,KAAG,iBAAH,EACC,KAAK,OAAL,CAAa,IAAb,CAAkB,QAAlB,EAA4B,iBAA5B;;AAED,MAAK,OAAL,CAAa,IAAb,CAAkB,YAAlB,EAAgC,UAAS,OAAT,EAAkB;AACjD,MAAG,KAAK,eAAL,IAAwB,KAAK,eAAL,CAAqB,KAAhD,EAAuD;AACtD,QAAK,eAAL,CAAqB,KAArB,CAA2B,OAA3B;AACA;AACD,MAAI,QAAQ,KAAK,OAAL,CAAa,QAAb,EAAZ;AACA,WAAS,IAAT,EAAe,QAAQ,MAAR,CAAe,UAAS,IAAT,EAAe;AAC5C,UAAO,MAAM,OAAN,CAAc,IAAd,KAAuB,CAA9B;AACA,GAFc,EAEZ,IAFY,EAAf,EAEW,QAAQ,MAAR,CAAe,UAAS,IAAT,EAAe;AACxC,UAAO,KAAK,OAAL,CAAa,IAAb,KAAsB,CAA7B;AACA,GAFU,EAER,IAFQ,EAFX,EAIW,QAAQ,MAAR,CAAe,UAAS,IAAT,EAAe;AACxC,UAAO,QAAQ,OAAR,CAAgB,IAAhB,KAAyB,CAAhC;AACA,GAFU,EAER,IAFQ,EAJX,EAMW,KANX,EAMkB,KANlB;AAOA,EAZ+B,CAY9B,IAZ8B,CAYzB,IAZyB,CAAhC;;AAcA,MAAK,OAAL,CAAa,KAAb,CAAmB,MAAM,MAAN,CAAa,OAAb,CAAnB,EAA0C,IAA1C,EAAgD,SAAhD;;AAEA,KAAG,UAAH,EAAe;AACd,aAAW,KAAX;AACA;AACD,QAAO;AACN,SAAO,YAAW;AACjB,QAAK,OAAL,CAAa,KAAb;AACA,GAFM,CAEL,IAFK,CAEA,IAFA,CADD;AAIN,SAAO,YAAW;AACjB,QAAK,OAAL,CAAa,KAAb;AACA,GAFM,CAEL,IAFK,CAEA,IAFA;AAJD,EAAP;AAQA,CAhDD","file":"NodeWatchFileSystem-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar Watchpack = require(\"watchpack\");\r\n\r\nfunction NodeWatchFileSystem(inputFileSystem) {\r\n\tthis.inputFileSystem = inputFileSystem;\r\n\tthis.watcherOptions = {\r\n\t\taggregateTimeout: 0\r\n\t};\r\n\tthis.watcher = new Watchpack(this.watcherOptions);\r\n}\r\n\r\nmodule.exports = NodeWatchFileSystem;\r\n\r\nNodeWatchFileSystem.prototype.watch = function watch(files, dirs, missing, startTime, options, callback, callbackUndelayed) {\r\n\tif(!Array.isArray(files))\r\n\t\tthrow new Error(\"Invalid arguments: 'files'\");\r\n\tif(!Array.isArray(dirs))\r\n\t\tthrow new Error(\"Invalid arguments: 'dirs'\");\r\n\tif(!Array.isArray(missing))\r\n\t\tthrow new Error(\"Invalid arguments: 'missing'\");\r\n\tif(typeof callback !== \"function\")\r\n\t\tthrow new Error(\"Invalid arguments: 'callback'\");\r\n\tif(typeof startTime !== \"number\" && startTime)\r\n\t\tthrow new Error(\"Invalid arguments: 'startTime'\");\r\n\tif(typeof options !== \"object\")\r\n\t\tthrow new Error(\"Invalid arguments: 'options'\");\r\n\tif(typeof callbackUndelayed !== \"function\" && callbackUndelayed)\r\n\t\tthrow new Error(\"Invalid arguments: 'callbackUndelayed'\");\r\n\tvar oldWatcher = this.watcher;\r\n\tthis.watcher = new Watchpack(options);\r\n\r\n\tif(callbackUndelayed)\r\n\t\tthis.watcher.once(\"change\", callbackUndelayed);\r\n\r\n\tthis.watcher.once(\"aggregated\", function(changes) {\r\n\t\tif(this.inputFileSystem && this.inputFileSystem.purge) {\r\n\t\t\tthis.inputFileSystem.purge(changes);\r\n\t\t}\r\n\t\tvar times = this.watcher.getTimes();\r\n\t\tcallback(null, changes.filter(function(file) {\r\n\t\t\treturn files.indexOf(file) >= 0;\r\n\t\t}).sort(), changes.filter(function(file) {\r\n\t\t\treturn dirs.indexOf(file) >= 0;\r\n\t\t}).sort(), changes.filter(function(file) {\r\n\t\t\treturn missing.indexOf(file) >= 0;\r\n\t\t}).sort(), times, times);\r\n\t}.bind(this));\r\n\r\n\tthis.watcher.watch(files.concat(missing), dirs, startTime);\r\n\r\n\tif(oldWatcher) {\r\n\t\toldWatcher.close();\r\n\t}\r\n\treturn {\r\n\t\tclose: function() {\r\n\t\t\tthis.watcher.close();\r\n\t\t}.bind(this),\r\n\t\tpause: function() {\r\n\t\t\tthis.watcher.pause();\r\n\t\t}.bind(this)\r\n\t};\r\n};\r\n"]}