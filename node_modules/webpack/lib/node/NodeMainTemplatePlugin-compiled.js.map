{"version":3,"sources":["NodeMainTemplatePlugin.js"],"names":[],"mappings":"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","file":"NodeMainTemplatePlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar Template = require(\"../Template\");\r\n\r\nfunction NodeMainTemplatePlugin(asyncChunkLoading) {\r\n\tthis.asyncChunkLoading = asyncChunkLoading;\r\n}\r\nmodule.exports = NodeMainTemplatePlugin;\r\nNodeMainTemplatePlugin.prototype.apply = function(mainTemplate) {\r\n\tvar self = this;\r\n\tmainTemplate.plugin(\"local-vars\", function(source, chunk) {\r\n\t\tif(chunk.chunks.length > 0) {\r\n\t\t\treturn this.asString([\r\n\t\t\t\tsource,\r\n\t\t\t\t\"\",\r\n\t\t\t\t\"// object to store loaded chunks\",\r\n\t\t\t\t\"// \\\"1\\\" means \\\"already loaded\\\"\",\r\n\t\t\t\t\"var installedChunks = {\",\r\n\t\t\t\tthis.indent(\r\n\t\t\t\t\tchunk.ids.map(function(id) {\r\n\t\t\t\t\t\treturn id + \":1\";\r\n\t\t\t\t\t}).join(\",\\n\")\r\n\t\t\t\t),\r\n\t\t\t\t\"};\"\r\n\t\t\t]);\r\n\t\t}\r\n\t\treturn source;\r\n\t});\r\n\tmainTemplate.plugin(\"require-ensure\", function(_, chunk, hash) {\r\n\t\tvar filename = this.outputOptions.filename || \"bundle.js\";\r\n\t\tvar chunkFilename = this.outputOptions.chunkFilename || \"[id].\" + filename;\r\n\t\tvar chunkMaps = chunk.getChunkMaps();\r\n\t\tvar insertMoreModules = [\r\n\t\t\t\"var moreModules = chunk.modules, chunkIds = chunk.ids;\",\r\n\t\t\t\"for(var moduleId in moreModules) {\",\r\n\t\t\tthis.indent(this.renderAddModule(hash, chunk, \"moduleId\", \"moreModules[moduleId]\")),\r\n\t\t\t\"}\"\r\n\t\t];\r\n\t\tif(self.asyncChunkLoading) {\r\n\t\t\treturn this.asString([\r\n\t\t\t\t\"if(installedChunks[chunkId] === 1) callback.call(null, \" + this.requireFn + \");\",\r\n\t\t\t\t\"else if(!installedChunks[chunkId]) {\",\r\n\t\t\t\tthis.indent([\r\n\t\t\t\t\t\"installedChunks[chunkId] = [callback];\",\r\n\t\t\t\t\t\"var filename = __dirname + \" + this.applyPluginsWaterfall(\"asset-path\", JSON.stringify(\"/\" + chunkFilename), {\r\n\t\t\t\t\t\thash: \"\\\" + \" + this.renderCurrentHashCode(hash) + \" + \\\"\",\r\n\t\t\t\t\t\thashWithLength: function(length) {\r\n\t\t\t\t\t\t\treturn \"\\\" + \" + this.renderCurrentHashCode(hash, length) + \" + \\\"\";\r\n\t\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\t\tchunk: {\r\n\t\t\t\t\t\t\tid: \"\\\" + chunkId + \\\"\",\r\n\t\t\t\t\t\t\thash: \"\\\" + \" + JSON.stringify(chunkMaps.hash) + \"[chunkId] + \\\"\",\r\n\t\t\t\t\t\t\thashWithLength: function(length) {\r\n\t\t\t\t\t\t\t\tvar shortChunkHashMap = {};\r\n\t\t\t\t\t\t\t\tObject.keys(chunkMaps.hash).forEach(function(chunkId) {\r\n\t\t\t\t\t\t\t\t\tif(typeof chunkMaps.hash[chunkId] === \"string\")\r\n\t\t\t\t\t\t\t\t\t\tshortChunkHashMap[chunkId] = chunkMaps.hash[chunkId].substr(0, length);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\treturn \"\\\" + \" + JSON.stringify(shortChunkHashMap) + \"[chunkId] + \\\"\";\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tname: \"\\\" + (\" + JSON.stringify(chunkMaps.name) + \"[chunkId]||chunkId) + \\\"\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}) + \";\",\r\n\t\t\t\t\t\"require('fs').readFile(filename, 'utf-8',  function(err, content) {\",\r\n\t\t\t\t\tthis.indent([\r\n\t\t\t\t\t\t\"if(err) { if(\" + this.requireFn + \".onError) return \" + this.requireFn + \".onError(err); else throw err; }\",\r\n\t\t\t\t\t\t\"var chunk = {};\",\r\n\t\t\t\t\t\t\"require('vm').runInThisContext('(function(exports, require, __dirname, __filename) {' + content + '\\\\n})', filename)\" +\r\n\t\t\t\t\t\t\"(chunk, require, require('path').dirname(filename), filename);\"\r\n\t\t\t\t\t].concat(insertMoreModules).concat([\r\n\t\t\t\t\t\t\"var callbacks = [];\",\r\n\t\t\t\t\t\t\"for(var i = 0; i < chunkIds.length; i++) {\",\r\n\t\t\t\t\t\tthis.indent([\r\n\t\t\t\t\t\t\t\"if(Array.isArray(installedChunks[chunkIds[i]]))\",\r\n\t\t\t\t\t\t\tthis.indent([\r\n\t\t\t\t\t\t\t\t\"callbacks = callbacks.concat(installedChunks[chunkIds[i]]);\"\r\n\t\t\t\t\t\t\t]),\r\n\t\t\t\t\t\t\t\"installedChunks[chunkIds[i]] = 1;\"\r\n\t\t\t\t\t\t]),\r\n\t\t\t\t\t\t\"}\",\r\n\t\t\t\t\t\t\"for(i = 0; i < callbacks.length; i++)\",\r\n\t\t\t\t\t\tthis.indent(\"callbacks[i].call(null, \" + this.requireFn + \");\")\r\n\t\t\t\t\t])),\r\n\t\t\t\t\t\"});\"\r\n\t\t\t\t]),\r\n\t\t\t\t\"} else installedChunks[chunkId].push(callback);\"\r\n\t\t\t]);\r\n\t\t} else {\r\n\t\t\tvar request = this.applyPluginsWaterfall(\"asset-path\", JSON.stringify(\"./\" + chunkFilename), {\r\n\t\t\t\thash: \"\\\" + \" + this.renderCurrentHashCode(hash) + \" + \\\"\",\r\n\t\t\t\thashWithLength: function(length) {\r\n\t\t\t\t\treturn \"\\\" + \" + this.renderCurrentHashCode(hash, length) + \" + \\\"\";\r\n\t\t\t\t}.bind(this),\r\n\t\t\t\tchunk: {\r\n\t\t\t\t\tid: \"\\\" + chunkId + \\\"\",\r\n\t\t\t\t\thash: \"\\\" + \" + JSON.stringify(chunkMaps.hash) + \"[chunkId] + \\\"\",\r\n\t\t\t\t\thashWithLength: function(length) {\r\n\t\t\t\t\t\tvar shortChunkHashMap = {};\r\n\t\t\t\t\t\tObject.keys(chunkMaps.hash).forEach(function(chunkId) {\r\n\t\t\t\t\t\t\tif(typeof chunkMaps.hash[chunkId] === \"string\")\r\n\t\t\t\t\t\t\t\tshortChunkHashMap[chunkId] = chunkMaps.hash[chunkId].substr(0, length);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn \"\\\" + \" + JSON.stringify(shortChunkHashMap) + \"[chunkId] + \\\"\";\r\n\t\t\t\t\t},\r\n\t\t\t\t\tname: \"\\\" + (\" + JSON.stringify(chunkMaps.name) + \"[chunkId]||chunkId) + \\\"\"\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn this.asString([\r\n\t\t\t\t\"// \\\"1\\\" is the signal for \\\"already loaded\\\"\",\r\n\t\t\t\t\"if(!installedChunks[chunkId]) {\",\r\n\t\t\t\tthis.indent([\r\n\t\t\t\t\t\"var chunk = require(\" + request + \");\"\r\n\t\t\t\t].concat(insertMoreModules).concat([\r\n\t\t\t\t\t\"for(var i = 0; i < chunkIds.length; i++)\",\r\n\t\t\t\t\tthis.indent(\"installedChunks[chunkIds[i]] = 1;\")\r\n\t\t\t\t])),\r\n\t\t\t\t\"}\",\r\n\t\t\t\t\"callback.call(null, \" + this.requireFn + \");\"\r\n\t\t\t]);\r\n\t\t}\r\n\t});\r\n\tmainTemplate.plugin(\"hot-bootstrap\", function(source, chunk, hash) {\r\n\t\tvar hotUpdateChunkFilename = this.outputOptions.hotUpdateChunkFilename;\r\n\t\tvar hotUpdateMainFilename = this.outputOptions.hotUpdateMainFilename;\r\n\t\tvar chunkMaps = chunk.getChunkMaps();\r\n\t\tvar currentHotUpdateChunkFilename = this.applyPluginsWaterfall(\"asset-path\", JSON.stringify(hotUpdateChunkFilename), {\r\n\t\t\thash: \"\\\" + \" + this.renderCurrentHashCode(hash) + \" + \\\"\",\r\n\t\t\thashWithLength: function(length) {\r\n\t\t\t\treturn \"\\\" + \" + this.renderCurrentHashCode(hash, length) + \" + \\\"\";\r\n\t\t\t}.bind(this),\r\n\t\t\tchunk: {\r\n\t\t\t\tid: \"\\\" + chunkId + \\\"\",\r\n\t\t\t\thash: \"\\\" + \" + JSON.stringify(chunkMaps.hash) + \"[chunkId] + \\\"\",\r\n\t\t\t\thashWithLength: function(length) {\r\n\t\t\t\t\tvar shortChunkHashMap = {};\r\n\t\t\t\t\tObject.keys(chunkMaps.hash).forEach(function(chunkId) {\r\n\t\t\t\t\t\tif(typeof chunkMaps.hash[chunkId] === \"string\")\r\n\t\t\t\t\t\t\tshortChunkHashMap[chunkId] = chunkMaps.hash[chunkId].substr(0, length);\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn \"\\\" + \" + JSON.stringify(shortChunkHashMap) + \"[chunkId] + \\\"\";\r\n\t\t\t\t},\r\n\t\t\t\tname: \"\\\" + (\" + JSON.stringify(chunkMaps.name) + \"[chunkId]||chunkId) + \\\"\"\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar currentHotUpdateMainFilename = this.applyPluginsWaterfall(\"asset-path\", JSON.stringify(hotUpdateMainFilename), {\r\n\t\t\thash: \"\\\" + \" + this.renderCurrentHashCode(hash) + \" + \\\"\",\r\n\t\t\thashWithLength: function(length) {\r\n\t\t\t\treturn \"\\\" + \" + this.renderCurrentHashCode(hash, length) + \" + \\\"\";\r\n\t\t\t}.bind(this)\r\n\t\t});\r\n\t\treturn Template.getFunctionContent(self.asyncChunkLoading ? require(\"./NodeMainTemplateAsync.runtime.js\") : require(\"./NodeMainTemplate.runtime.js\"))\r\n\t\t\t.replace(/\\$require\\$/g, this.requireFn)\r\n\t\t\t.replace(/\\$hotMainFilename\\$/g, currentHotUpdateMainFilename)\r\n\t\t\t.replace(/\\$hotChunkFilename\\$/g, currentHotUpdateChunkFilename);\r\n\t});\r\n\tmainTemplate.plugin(\"hash\", function(hash) {\r\n\t\thash.update(\"node\");\r\n\t\thash.update(\"3\");\r\n\t\thash.update(this.outputOptions.filename + \"\");\r\n\t\thash.update(this.outputOptions.chunkFilename + \"\");\r\n\t});\r\n};\r\n"]}