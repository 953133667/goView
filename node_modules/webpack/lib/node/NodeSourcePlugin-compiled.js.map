{"version":3,"sources":["NodeSourcePlugin.js"],"names":[],"mappings":"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","file":"NodeSourcePlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar ModuleAliasPlugin = require(\"enhanced-resolve/lib/ModuleAliasPlugin\");\r\nvar ModuleParserHelpers = require(\"../ModuleParserHelpers\");\r\nvar nodeLibsBrowser = require(\"node-libs-browser\");\r\n\r\nfunction NodeSourcePlugin(options) {\r\n\tthis.options = options;\r\n}\r\nmodule.exports = NodeSourcePlugin;\r\nNodeSourcePlugin.prototype.apply = function(compiler) {\r\n\tfunction getPathToModule(module, type) {\r\n\t\tif(type === true || (type === undefined && nodeLibsBrowser[module])) {\r\n\t\t\tif(!nodeLibsBrowser[module]) throw new Error(\"No browser version for node.js core module '\" + module + \"' available\");\r\n\t\t\treturn nodeLibsBrowser[module];\r\n\t\t} else if(type === \"mock\") {\r\n\t\t\treturn require.resolve(\"node-libs-browser/mock/\" + module);\r\n\t\t} else if(type === \"empty\") {\r\n\t\t\treturn require.resolve(\"node-libs-browser/mock/empty\");\r\n\t\t} else return module;\r\n\t}\r\n\tif(this.options.process) {\r\n\t\tvar processType = this.options.process;\r\n\t\tcompiler.parser.plugin(\"expression process\", function() {\r\n\t\t\treturn ModuleParserHelpers.addParsedVariable(this, \"process\", \"require(\" + JSON.stringify(getPathToModule(\"process\", processType)) + \")\");\r\n\t\t});\r\n\t}\r\n\tif(this.options.global) {\r\n\t\tcompiler.parser.plugin(\"expression global\", function() {\r\n\t\t\tthis.state.module.addVariable(\"global\", \"(function() { return this; }())\");\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n\tif(this.options.console) {\r\n\t\tvar consoleType = this.options.console;\r\n\t\tcompiler.parser.plugin(\"expression console\", function() {\r\n\t\t\treturn ModuleParserHelpers.addParsedVariable(this, \"console\", \"require(\" + JSON.stringify(getPathToModule(\"console\", consoleType)) + \")\");\r\n\t\t});\r\n\t}\r\n\tvar bufferType = this.options.Buffer;\r\n\tif(typeof bufferType === \"undefined\") {\r\n\t\tbufferType = this.options.buffer;\r\n\t\tif(typeof bufferType === \"undefined\")\r\n\t\t\tbufferType = true;\r\n\t}\r\n\tif(bufferType) {\r\n\t\tcompiler.parser.plugin(\"expression Buffer\", function() {\r\n\t\t\treturn ModuleParserHelpers.addParsedVariable(this, \"Buffer\", \"require(\" + JSON.stringify(getPathToModule(\"buffer\", bufferType)) + \").Buffer\");\r\n\t\t});\r\n\t}\r\n\tif(this.options.setImmediate) {\r\n\t\tvar setImmediateType = this.options.setImmediate;\r\n\t\tcompiler.parser.plugin(\"expression setImmediate\", function() {\r\n\t\t\treturn ModuleParserHelpers.addParsedVariable(this, \"setImmediate\", \"require(\" + JSON.stringify(getPathToModule(\"timers\", setImmediateType)) + \").setImmediate\");\r\n\t\t});\r\n\t\tcompiler.parser.plugin(\"expression clearImmediate\", function() {\r\n\t\t\treturn ModuleParserHelpers.addParsedVariable(this, \"clearImmediate\", \"require(\" + JSON.stringify(getPathToModule(\"timers\", setImmediateType)) + \").clearImmediate\");\r\n\t\t});\r\n\t}\r\n\tvar options = this.options;\r\n\tcompiler.plugin(\"after-resolvers\", function(compiler) {\r\n\t\tvar alias = {};\r\n\t\tObject.keys(nodeLibsBrowser).forEach(function(lib) {\r\n\t\t\tif(options[lib] !== false)\r\n\t\t\t\talias[lib + \"$\"] = getPathToModule(lib, options[lib]);\r\n\t\t});\r\n\t\tif(Object.keys(alias).length > 0) {\r\n\t\t\tcompiler.resolvers.normal.apply(\r\n\t\t\t\tnew ModuleAliasPlugin(alias)\r\n\t\t\t);\r\n\t\t}\r\n\t});\r\n};\r\n"]}