{"version":3,"sources":["DelegatedModuleFactoryPlugin.js"],"names":[],"mappings":"AAAA;;;;AAIA,IAAI,kBAAkB,QAAQ,mBAAR,CAAtB;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS,4BAAT,CAAsC,OAAtC,EAA+C;AAC9C,MAAK,OAAL,GAAe,OAAf;AACA,SAAQ,IAAR,GAAe,QAAQ,IAAR,IAAgB,SAA/B;AACA,SAAQ,UAAR,GAAqB,QAAQ,UAAR,IAAsB,CAAC,EAAD,EAAK,KAAL,CAA3C;AACA;AACD,OAAO,OAAP,GAAiB,4BAAjB;;AAEA,6BAA6B,SAA7B,CAAuC,KAAvC,GAA+C,UAAS,mBAAT,EAA8B;AAC5E,KAAI,QAAQ,KAAK,OAAL,CAAa,KAAzB;AACA,KAAG,KAAH,EAAU;AACT,sBAAoB,MAApB,CAA2B,SAA3B,EAAsC,UAAS,OAAT,EAAkB;AACvD,UAAO,UAAS,IAAT,EAAe,QAAf,EAAyB;AAC/B,QAAI,aAAa,KAAK,UAAtB;AACA,QAAI,UAAU,WAAW,OAAzB;AACA,QAAG,WAAW,QAAQ,OAAR,CAAgB,QAAQ,GAAxB,MAAiC,CAA/C,EAAkD;AACjD,SAAI,eAAe,MAAM,QAAQ,MAAR,CAAe,MAAM,MAArB,CAAzB;AACA,UAAI,IAAI,IAAI,CAAZ,EAAe,IAAI,KAAK,OAAL,CAAa,UAAb,CAAwB,MAA3C,EAAmD,GAAnD,EAAwD;AACvD,UAAI,iBAAiB,eAAe,KAAK,OAAL,CAAa,UAAb,CAAwB,CAAxB,CAApC;AACA,UAAG,kBAAkB,KAAK,OAAL,CAAa,OAAlC,EAA2C;AAC1C,WAAI,WAAW,KAAK,OAAL,CAAa,OAAb,CAAqB,cAArB,CAAf;AACA,cAAO,SAAS,IAAT,EAAe,IAAI,eAAJ,CAAoB,KAAK,OAAL,CAAa,MAAjC,EAAyC,QAAzC,EAAmD,KAAK,OAAL,CAAa,IAAhE,EAAsE,cAAtE,CAAf,CAAP;AACA;AACD;AACD;AACD,WAAO,QAAQ,IAAR,EAAc,QAAd,CAAP;AACA,IAdM,CAcL,IAdK,CAcA,IAdA,CAAP;AAeA,GAhBqC,CAgBpC,IAhBoC,CAgB/B,IAhB+B,CAAtC;AAiBA,EAlBD,MAkBO;AACN,sBAAoB,MAApB,CAA2B,QAA3B,EAAqC,UAAS,MAAT,EAAiB;AACrD,OAAG,OAAO,QAAV,EAAoB;AACnB,QAAI,UAAU,OAAO,QAAP,CAAgB,KAAK,OAArB,CAAd;AACA,QAAG,WAAW,WAAW,KAAK,OAAL,CAAa,OAAtC,EAA+C;AAC9C,SAAI,WAAW,KAAK,OAAL,CAAa,OAAb,CAAqB,OAArB,CAAf;AACA,YAAO,IAAI,eAAJ,CAAoB,KAAK,OAAL,CAAa,MAAjC,EAAyC,QAAzC,EAAmD,KAAK,OAAL,CAAa,IAAhE,EAAsE,OAAtE,CAAP;AACA;AACD;AACD,UAAO,MAAP;AACA,GAToC,CASnC,IATmC,CAS9B,IAT8B,CAArC;AAUA;AACD,CAhCD","file":"DelegatedModuleFactoryPlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar DelegatedModule = require(\"./DelegatedModule\");\r\n\r\n// options.source\r\n// options.type\r\n// options.context\r\n// options.scope\r\n// options.content\r\nfunction DelegatedModuleFactoryPlugin(options) {\r\n\tthis.options = options;\r\n\toptions.type = options.type || \"require\";\r\n\toptions.extensions = options.extensions || [\"\", \".js\"];\r\n}\r\nmodule.exports = DelegatedModuleFactoryPlugin;\r\n\r\nDelegatedModuleFactoryPlugin.prototype.apply = function(normalModuleFactory) {\r\n\tvar scope = this.options.scope;\r\n\tif(scope) {\r\n\t\tnormalModuleFactory.plugin(\"factory\", function(factory) {\r\n\t\t\treturn function(data, callback) {\r\n\t\t\t\tvar dependency = data.dependency;\r\n\t\t\t\tvar request = dependency.request;\r\n\t\t\t\tif(request && request.indexOf(scope + \"/\") === 0) {\r\n\t\t\t\t\tvar innerRequest = \".\" + request.substr(scope.length);\r\n\t\t\t\t\tfor(var i = 0; i < this.options.extensions.length; i++) {\r\n\t\t\t\t\t\tvar requestPlusExt = innerRequest + this.options.extensions[i];\r\n\t\t\t\t\t\tif(requestPlusExt in this.options.content) {\r\n\t\t\t\t\t\t\tvar resolved = this.options.content[requestPlusExt];\r\n\t\t\t\t\t\t\treturn callback(null, new DelegatedModule(this.options.source, resolved, this.options.type, requestPlusExt));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn factory(data, callback);\r\n\t\t\t}.bind(this);\r\n\t\t}.bind(this));\r\n\t} else {\r\n\t\tnormalModuleFactory.plugin(\"module\", function(module) {\r\n\t\t\tif(module.libIdent) {\r\n\t\t\t\tvar request = module.libIdent(this.options);\r\n\t\t\t\tif(request && request in this.options.content) {\r\n\t\t\t\t\tvar resolved = this.options.content[request];\r\n\t\t\t\t\treturn new DelegatedModule(this.options.source, resolved, this.options.type, request);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn module;\r\n\t\t}.bind(this));\r\n\t}\r\n};\r\n"]}