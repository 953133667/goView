{"version":3,"sources":["AMDPlugin.js"],"names":[],"mappings":"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","file":"AMDPlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar path = require(\"path\");\r\nvar AMDRequireDependency = require(\"./AMDRequireDependency\");\r\nvar AMDRequireItemDependency = require(\"./AMDRequireItemDependency\");\r\nvar AMDRequireArrayDependency = require(\"./AMDRequireArrayDependency\");\r\nvar AMDRequireContextDependency = require(\"./AMDRequireContextDependency\");\r\nvar AMDDefineDependency = require(\"./AMDDefineDependency\");\r\nvar LocalModuleDependency = require(\"./LocalModuleDependency\");\r\nvar ConstDependency = require(\"./ConstDependency\");\r\n\r\nvar NullFactory = require(\"../NullFactory\");\r\n\r\nvar AMDRequireDependenciesBlockParserPlugin = require(\"./AMDRequireDependenciesBlockParserPlugin\");\r\nvar AMDDefineDependencyParserPlugin = require(\"./AMDDefineDependencyParserPlugin\");\r\n\r\nvar ModuleAliasPlugin = require(\"enhanced-resolve/lib/ModuleAliasPlugin\");\r\n\r\nvar BasicEvaluatedExpression = require(\"../BasicEvaluatedExpression\");\r\n\r\nfunction AMDPlugin(options, amdOptions) {\r\n\tthis.amdOptions = amdOptions;\r\n\tthis.options = options;\r\n}\r\nmodule.exports = AMDPlugin;\r\n\r\nAMDPlugin.prototype.apply = function(compiler) {\r\n\tfunction setTypeof(expr, value) {\r\n\t\tcompiler.parser.plugin(\"evaluate typeof \" + expr, function(expr) {\r\n\t\t\treturn new BasicEvaluatedExpression().setString(value).setRange(expr.range);\r\n\t\t});\r\n\t\tcompiler.parser.plugin(\"typeof \" + expr, function(expr) {\r\n\t\t\tvar dep = new ConstDependency(JSON.stringify(value), expr.range);\r\n\t\t\tdep.loc = expr.loc;\r\n\t\t\tthis.state.current.addDependency(dep);\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction setExpressionToModule(expr, module) {\r\n\t\tcompiler.parser.plugin(\"expression \" + expr, function(expr) {\r\n\t\t\tvar dep = new AMDRequireItemDependency(module, expr.range);\r\n\t\t\tdep.userRequest = expr;\r\n\t\t\tdep.loc = expr.loc;\r\n\t\t\tthis.state.current.addDependency(dep);\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}\r\n\tvar amdOptions = this.amdOptions;\r\n\tcompiler.plugin(\"compilation\", function(compilation, params) {\r\n\t\tvar normalModuleFactory = params.normalModuleFactory;\r\n\t\tvar contextModuleFactory = params.contextModuleFactory;\r\n\r\n\t\tcompilation.dependencyFactories.set(AMDRequireDependency, new NullFactory());\r\n\t\tcompilation.dependencyTemplates.set(AMDRequireDependency, new AMDRequireDependency.Template());\r\n\r\n\t\tcompilation.dependencyFactories.set(AMDRequireItemDependency, normalModuleFactory);\r\n\t\tcompilation.dependencyTemplates.set(AMDRequireItemDependency, new AMDRequireItemDependency.Template());\r\n\r\n\t\tcompilation.dependencyFactories.set(AMDRequireArrayDependency, new NullFactory());\r\n\t\tcompilation.dependencyTemplates.set(AMDRequireArrayDependency, new AMDRequireArrayDependency.Template());\r\n\r\n\t\tcompilation.dependencyFactories.set(AMDRequireContextDependency, contextModuleFactory);\r\n\t\tcompilation.dependencyTemplates.set(AMDRequireContextDependency, new AMDRequireContextDependency.Template());\r\n\r\n\t\tcompilation.dependencyFactories.set(AMDDefineDependency, new NullFactory());\r\n\t\tcompilation.dependencyTemplates.set(AMDDefineDependency, new AMDDefineDependency.Template());\r\n\r\n\t\tcompilation.dependencyFactories.set(LocalModuleDependency, new NullFactory());\r\n\t\tcompilation.dependencyTemplates.set(LocalModuleDependency, new LocalModuleDependency.Template());\r\n\t});\r\n\tcompiler.parser.apply(\r\n\t\tnew AMDRequireDependenciesBlockParserPlugin(this.options),\r\n\t\tnew AMDDefineDependencyParserPlugin(this.options)\r\n\t);\r\n\tsetExpressionToModule(\"require.amd\", \"!!webpack amd options\");\r\n\tsetExpressionToModule(\"define.amd\", \"!!webpack amd options\");\r\n\tsetExpressionToModule(\"define\", \"!!webpack amd define\");\r\n\tcompiler.parser.plugin(\"expression __webpack_amd_options__\", function() {\r\n\t\treturn this.state.current.addVariable(\"__webpack_amd_options__\", JSON.stringify(amdOptions));\r\n\t});\r\n\tcompiler.parser.plugin(\"evaluate typeof define.amd\", function(expr) {\r\n\t\treturn new BasicEvaluatedExpression().setString(typeof amdOptions).setRange(expr.range);\r\n\t});\r\n\tcompiler.parser.plugin(\"evaluate typeof require.amd\", function(expr) {\r\n\t\treturn new BasicEvaluatedExpression().setString(typeof amdOptions).setRange(expr.range);\r\n\t});\r\n\tcompiler.parser.plugin(\"evaluate Identifier define.amd\", function(expr) {\r\n\t\treturn new BasicEvaluatedExpression().setBoolean(true).setRange(expr.range);\r\n\t});\r\n\tcompiler.parser.plugin(\"evaluate Identifier require.amd\", function(expr) {\r\n\t\treturn new BasicEvaluatedExpression().setBoolean(true).setRange(expr.range);\r\n\t});\r\n\tsetTypeof(\"define\", \"function\");\r\n\tcompiler.parser.plugin(\"can-rename define\", function() {\r\n\t\treturn true;\r\n\t});\r\n\tcompiler.parser.plugin(\"rename define\", function(expr) {\r\n\t\tvar dep = new AMDRequireItemDependency(\"!!webpack amd define\", expr.range);\r\n\t\tdep.userRequest = \"define\";\r\n\t\tdep.loc = expr.loc;\r\n\t\tthis.state.current.addDependency(dep);\r\n\t\treturn false;\r\n\t});\r\n\tsetTypeof(\"require\", \"function\");\r\n\tcompiler.resolvers.normal.apply(\r\n\t\tnew ModuleAliasPlugin({\r\n\t\t\t\"amdefine\": path.join(__dirname, \"..\", \"..\", \"buildin\", \"amd-define.js\"),\r\n\t\t\t\"webpack amd options\": path.join(__dirname, \"..\", \"..\", \"buildin\", \"amd-options.js\"),\r\n\t\t\t\"webpack amd define\": path.join(__dirname, \"..\", \"..\", \"buildin\", \"amd-define.js\")\r\n\t\t})\r\n\t);\r\n};\r\n"]}