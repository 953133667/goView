{"version":3,"sources":["LoaderPlugin.js"],"names":[],"mappings":"AAAA;;;;AAIA,IAAI,mBAAmB,QAAQ,oBAAR,CAAvB;;AAEA,SAAS,YAAT,GAAwB,CAAE;AAC1B,OAAO,OAAP,GAAiB,YAAjB;;AAEA,aAAa,SAAb,CAAuB,KAAvB,GAA+B,UAAS,QAAT,EAAmB;AACjD,UAAS,MAAT,CAAgB,aAAhB,EAA+B,UAAS,WAAT,EAAsB,MAAtB,EAA8B;AAC5D,MAAI,sBAAsB,OAAO,mBAAjC;;AAEA,cAAY,mBAAZ,CAAgC,GAAhC,CAAoC,gBAApC,EAAsD,mBAAtD;AACA,EAJD;AAKA,UAAS,MAAT,CAAgB,aAAhB,EAA+B,UAAS,WAAT,EAAsB;AACpD,cAAY,MAAZ,CAAmB,sBAAnB,EAA2C,UAAS,aAAT,EAAwB,MAAxB,EAAgC;AAC1E,iBAAc,UAAd,GAA2B,SAAS,UAAT,CAAoB,OAApB,EAA6B,QAA7B,EAAuC;AACjE,QAAI,MAAM,IAAI,gBAAJ,CAAqB,OAArB,CAAV;AACA,QAAI,GAAJ,GAAU,OAAV;AACA,gBAAY,qBAAZ,CAAkC,MAAlC,EAA0C,CACzC,CAAC,GAAD,CADyC,CAA1C,EAEG,IAFH,EAES,IAFT,EAEe,KAFf,EAEsB,UAAS,GAAT,EAAc;AACnC,SAAG,GAAH,EAAQ,OAAO,SAAS,GAAT,CAAP;;AAER,SAAG,CAAC,IAAI,MAAR,EAAgB,OAAO,SAAS,IAAI,KAAJ,CAAU,wBAAV,CAAT,CAAP;AAChB,SAAG,IAAI,MAAJ,CAAW,QAAd,EAAwB,IAAI,MAAJ,CAAW,QAAX,CAAoB,IAApB,CAAyB,IAAzB,EAAxB,KACK;;AAEL,cAAS,IAAT,CAAc,GAAd,EAAmB;AAClB,UAAG,GAAH,EAAQ,OAAO,SAAS,GAAT,CAAP;;AAER,UAAG,IAAI,MAAJ,CAAW,KAAd,EAAqB,OAAO,SAAS,IAAI,MAAJ,CAAW,KAApB,CAAP;AACrB,UAAG,CAAC,IAAI,MAAJ,CAAW,OAAf,EAAwB,MAAM,IAAI,KAAJ,CAAU,wEAAV,CAAN;AACxB,UAAI,MAAJ,EAAY,GAAZ;AACA,UAAI,eAAe,IAAI,MAAJ,CAAW,OAA9B;AACA,UAAG,aAAa,YAAhB,EAA8B;AAC7B,WAAI,eAAe,aAAa,YAAb,EAAnB;AACA,aAAM,aAAa,GAAnB;AACA,gBAAS,aAAa,MAAtB;AACA,OAJD,MAIO;AACN,aAAM,aAAa,GAAb,EAAN;AACA,gBAAS,aAAa,MAAb,EAAT;AACA;AACD,UAAG,IAAI,MAAJ,CAAW,gBAAd,EAAgC;AAC/B,WAAI,MAAJ,CAAW,gBAAX,CAA4B,OAA5B,CAAoC,UAAS,GAAT,EAAc;AACjD,sBAAc,aAAd,CAA4B,GAA5B;AACA,QAFD;AAGA;AACD,UAAG,IAAI,MAAJ,CAAW,mBAAd,EAAmC;AAClC,WAAI,MAAJ,CAAW,mBAAX,CAA+B,OAA/B,CAAuC,UAAS,GAAT,EAAc;AACpD,sBAAc,oBAAd,CAAmC,GAAnC;AACA,QAFD;AAGA;AACD,aAAO,SAAS,IAAT,EAAe,MAAf,EAAuB,GAAvB,EAA4B,IAAI,MAAhC,CAAP;AACA;AACD,KApCD;AAqCA,IAxCD;AAyCA,GA1CD;AA2CA,EA5CD;AA6CA,CAnDD","file":"LoaderPlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar LoaderDependency = require(\"./LoaderDependency\");\r\n\r\nfunction LoaderPlugin() {}\r\nmodule.exports = LoaderPlugin;\r\n\r\nLoaderPlugin.prototype.apply = function(compiler) {\r\n\tcompiler.plugin(\"compilation\", function(compilation, params) {\r\n\t\tvar normalModuleFactory = params.normalModuleFactory;\r\n\r\n\t\tcompilation.dependencyFactories.set(LoaderDependency, normalModuleFactory);\r\n\t});\r\n\tcompiler.plugin(\"compilation\", function(compilation) {\r\n\t\tcompilation.plugin(\"normal-module-loader\", function(loaderContext, module) {\r\n\t\t\tloaderContext.loadModule = function loadModule(request, callback) {\r\n\t\t\t\tvar dep = new LoaderDependency(request);\r\n\t\t\t\tdep.loc = request;\r\n\t\t\t\tcompilation.addModuleDependencies(module, [\r\n\t\t\t\t\t[dep]\r\n\t\t\t\t], true, \"lm\", false, function(err) {\r\n\t\t\t\t\tif(err) return callback(err);\r\n\r\n\t\t\t\t\tif(!dep.module) return callback(new Error(\"Cannot load the module\"));\r\n\t\t\t\t\tif(dep.module.building) dep.module.building.push(next);\r\n\t\t\t\t\telse next();\r\n\r\n\t\t\t\t\tfunction next(err) {\r\n\t\t\t\t\t\tif(err) return callback(err);\r\n\r\n\t\t\t\t\t\tif(dep.module.error) return callback(dep.module.error);\r\n\t\t\t\t\t\tif(!dep.module._source) throw new Error(\"The module created for a LoaderDependency must have a property _source\");\r\n\t\t\t\t\t\tvar source, map;\r\n\t\t\t\t\t\tvar moduleSource = dep.module._source;\r\n\t\t\t\t\t\tif(moduleSource.sourceAndMap) {\r\n\t\t\t\t\t\t\tvar sourceAndMap = moduleSource.sourceAndMap();\r\n\t\t\t\t\t\t\tmap = sourceAndMap.map;\r\n\t\t\t\t\t\t\tsource = sourceAndMap.source;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tmap = moduleSource.map();\r\n\t\t\t\t\t\t\tsource = moduleSource.source();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(dep.module.fileDependencies) {\r\n\t\t\t\t\t\t\tdep.module.fileDependencies.forEach(function(dep) {\r\n\t\t\t\t\t\t\t\tloaderContext.addDependency(dep);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif(dep.module.contextDependencies) {\r\n\t\t\t\t\t\t\tdep.module.contextDependencies.forEach(function(dep) {\r\n\t\t\t\t\t\t\t\tloaderContext.addContextDependency(dep);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn callback(null, source, map, dep.module);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t});\r\n\t});\r\n};\r\n"]}