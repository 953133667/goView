{"version":3,"sources":["RequireContextPlugin.js"],"names":[],"mappings":"AAAA;;;;AAIA,IAAI,2BAA2B,QAAQ,4BAAR,CAA/B;AACA,IAAI,2BAA2B,QAAQ,4BAAR,CAA/B;;AAEA,IAAI,uCAAuC,QAAQ,wCAAR,CAA3C;;AAEA,SAAS,oBAAT,CAA8B,kBAA9B,EAAkD,UAAlD,EAA8D;AAC7D,MAAK,kBAAL,GAA0B,kBAA1B;AACA,MAAK,UAAL,GAAkB,UAAlB;AACA;AACD,OAAO,OAAP,GAAiB,oBAAjB;;AAEA,qBAAqB,SAArB,CAA+B,KAA/B,GAAuC,UAAS,QAAT,EAAmB;AACzD,KAAI,qBAAqB,KAAK,kBAA9B;AACA,KAAI,aAAa,KAAK,UAAtB;AACA,UAAS,MAAT,CAAgB,aAAhB,EAA+B,UAAS,WAAT,EAAsB,MAAtB,EAA8B;AAC5D,MAAI,uBAAuB,OAAO,oBAAlC;AACA,MAAI,sBAAsB,OAAO,mBAAjC;;AAEA,cAAY,mBAAZ,CAAgC,GAAhC,CAAoC,wBAApC,EAA8D,oBAA9D;AACA,cAAY,mBAAZ,CAAgC,GAAhC,CAAoC,wBAApC,EAA8D,IAAI,yBAAyB,QAA7B,EAA9D;;AAEA,cAAY,mBAAZ,CAAgC,GAAhC,CAAoC,wBAApC,EAA8D,mBAA9D;AACA,EARD;AASA,UAAS,MAAT,CAAgB,wBAAhB,EAA0C,UAAS,GAAT,EAAc;AACvD,MAAI,MAAJ,CAAW,cAAX,EAA2B,UAAS,KAAT,EAAgB,QAAhB,EAA0B;AACpD,OAAG,MAAM,MAAN,KAAiB,CAApB,EAAuB,OAAO,SAAS,IAAT,EAAe,KAAf,CAAP;;AAEvB,YAAS,IAAT,EAAe,MAAM,GAAN,CAAU,UAAS,GAAT,EAAc;AACtC,WAAO,WAAW,MAAX,CAAkB,UAAS,GAAT,EAAc;AACtC,SAAI,IAAI,IAAI,OAAJ,CAAY,MAApB;AACA,YAAO,IAAI,IAAI,MAAR,IAAkB,IAAI,OAAJ,CAAY,MAAZ,CAAmB,IAAI,IAAI,MAA3B,EAAmC,CAAnC,MAA0C,GAAnE;AACA,KAHM,EAGJ,GAHI,CAGA,UAAS,GAAT,EAAc;AACpB,SAAI,IAAI,IAAI,OAAJ,CAAY,MAApB;AACA,YAAO;AACN,eAAS,IAAI,OADP;AAEN,eAAS,IAAI,OAAJ,CAAY,MAAZ,CAAmB,CAAnB,EAAsB,IAAI,IAAI,MAA9B;AAFH,MAAP;AAIA,KATM,CAAP;AAUA,IAXc,EAWZ,MAXY,CAWL,UAAS,CAAT,EAAY,CAAZ,EAAe;AACxB,WAAO,EAAE,MAAF,CAAS,CAAT,CAAP;AACA,IAbc,EAaZ,EAbY,CAAf;AAcA,GAjBD;AAkBA,MAAI,MAAJ,CAAW,cAAX,EAA2B,UAAS,KAAT,EAAgB,QAAhB,EAA0B;AACpD,OAAG,MAAM,MAAN,KAAiB,CAApB,EAAuB,OAAO,SAAS,IAAT,EAAe,KAAf,CAAP;;AAEvB,YAAS,IAAT,EAAe,MAAM,GAAN,CAAU,UAAS,GAAT,EAAc;AACtC,SAAI,IAAI,IAAI,CAAZ,EAAe,IAAI,mBAAmB,MAAtC,EAA8C,GAA9C,EAAmD;AAClD,SAAI,MAAM,mBAAmB,CAAnB,CAAV;AACA,SAAI,MAAM,IAAI,OAAJ,CAAY,OAAZ,CAAoB,OAAO,GAAP,GAAa,GAAjC,CAAV;AACA,SAAG,QAAQ,CAAX,EAAc;AACb,UAAI,OAAJ,GAAc,IAAI,OAAJ,CAAY,KAAZ,CAAkB,IAAI,MAAJ,GAAa,CAA/B,CAAd;AACA;AACA;AACD;AACD,WAAO,GAAP;AACA,IAVc,CAAf;AAWA,GAdD;AAeA,EAlCD;AAmCA,KAAI,oCAAJ,GAA2C,KAA3C,CAAiD,SAAS,MAA1D;AACA,CAhDD","file":"RequireContextPlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar RequireContextDependency = require(\"./RequireContextDependency\");\r\nvar ContextElementDependency = require(\"./ContextElementDependency\");\r\n\r\nvar RequireContextDependencyParserPlugin = require(\"./RequireContextDependencyParserPlugin\");\r\n\r\nfunction RequireContextPlugin(modulesDirectories, extensions) {\r\n\tthis.modulesDirectories = modulesDirectories;\r\n\tthis.extensions = extensions;\r\n}\r\nmodule.exports = RequireContextPlugin;\r\n\r\nRequireContextPlugin.prototype.apply = function(compiler) {\r\n\tvar modulesDirectories = this.modulesDirectories;\r\n\tvar extensions = this.extensions;\r\n\tcompiler.plugin(\"compilation\", function(compilation, params) {\r\n\t\tvar contextModuleFactory = params.contextModuleFactory;\r\n\t\tvar normalModuleFactory = params.normalModuleFactory;\r\n\r\n\t\tcompilation.dependencyFactories.set(RequireContextDependency, contextModuleFactory);\r\n\t\tcompilation.dependencyTemplates.set(RequireContextDependency, new RequireContextDependency.Template());\r\n\r\n\t\tcompilation.dependencyFactories.set(ContextElementDependency, normalModuleFactory);\r\n\t});\r\n\tcompiler.plugin(\"context-module-factory\", function(cmf) {\r\n\t\tcmf.plugin(\"alternatives\", function(items, callback) {\r\n\t\t\tif(items.length === 0) return callback(null, items);\r\n\r\n\t\t\tcallback(null, items.map(function(obj) {\r\n\t\t\t\treturn extensions.filter(function(ext) {\r\n\t\t\t\t\tvar l = obj.request.length;\r\n\t\t\t\t\treturn l > ext.length && obj.request.substr(l - ext.length, l) === ext;\r\n\t\t\t\t}).map(function(ext) {\r\n\t\t\t\t\tvar l = obj.request.length;\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tcontext: obj.context,\r\n\t\t\t\t\t\trequest: obj.request.substr(0, l - ext.length)\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t}).reduce(function(a, b) {\r\n\t\t\t\treturn a.concat(b);\r\n\t\t\t}, []));\r\n\t\t});\r\n\t\tcmf.plugin(\"alternatives\", function(items, callback) {\r\n\t\t\tif(items.length === 0) return callback(null, items);\r\n\r\n\t\t\tcallback(null, items.map(function(obj) {\r\n\t\t\t\tfor(var i = 0; i < modulesDirectories.length; i++) {\r\n\t\t\t\t\tvar dir = modulesDirectories[i];\r\n\t\t\t\t\tvar idx = obj.request.indexOf(\"./\" + dir + \"/\");\r\n\t\t\t\t\tif(idx === 0) {\r\n\t\t\t\t\t\tobj.request = obj.request.slice(dir.length + 3);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn obj;\r\n\t\t\t}));\r\n\t\t});\r\n\t});\r\n\tnew RequireContextDependencyParserPlugin().apply(compiler.parser);\r\n};\r\n"]}