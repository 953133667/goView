{"version":3,"sources":["ExternalModuleFactoryPlugin.js"],"names":[],"mappings":"AAAA;;;;AAIA,IAAI,iBAAiB,QAAQ,kBAAR,CAArB;;AAEA,SAAS,2BAAT,CAAqC,IAArC,EAA2C,SAA3C,EAAsD;AACrD,MAAK,IAAL,GAAY,IAAZ;AACA,MAAK,SAAL,GAAiB,SAAjB;AACA;AACD,OAAO,OAAP,GAAiB,2BAAjB;;AAEA,4BAA4B,SAA5B,CAAsC,KAAtC,GAA8C,UAAS,mBAAT,EAA8B;AAC3E,KAAI,aAAa,KAAK,IAAtB;AACA,qBAAoB,MAApB,CAA2B,SAA3B,EAAsC,UAAS,OAAT,EAAkB;AACvD,SAAO,UAAS,IAAT,EAAe,QAAf,EAAyB;AAC/B,OAAI,UAAU,KAAK,OAAnB;AACA,OAAI,aAAa,KAAK,UAAtB;;AAEA,YAAS,cAAT,CAAwB,KAAxB,EAA+B,IAA/B,EAAqC,QAArC,EAA+C;AAC9C,QAAG,OAAO,IAAP,KAAgB,UAAnB,EAA+B;AAC9B,gBAAW,IAAX;AACA,YAAO,SAAP;AACA;AACD,QAAG,UAAU,KAAb,EAAoB,OAAO,QAAQ,IAAR,EAAc,QAAd,CAAP;AACpB,QAAG,UAAU,IAAb,EAAmB,QAAQ,WAAW,OAAnB;AACnB,QAAG,OAAO,IAAP,KAAgB,WAAhB,IAA+B,cAAc,IAAd,CAAmB,KAAnB,CAAlC,EAA6D;AAC5D,SAAI,MAAM,MAAM,OAAN,CAAc,GAAd,CAAV;AACA,YAAO,MAAM,MAAN,CAAa,CAAb,EAAgB,GAAhB,CAAP;AACA,aAAQ,MAAM,MAAN,CAAa,MAAM,CAAnB,CAAR;AACA;AACD,aAAS,IAAT,EAAe,IAAI,cAAJ,CAAmB,KAAnB,EAA0B,QAAQ,UAAlC,CAAf;AACA,WAAO,IAAP;AACA;AACA,aAAS,eAAT,CAAyB,SAAzB,EAAoC,QAApC,EAA8C;AAC9C,QAAG,OAAO,SAAP,KAAqB,QAAxB,EAAkC;AACjC,SAAG,cAAc,WAAW,OAA5B,EAAqC;AACpC,aAAO,eAAe,WAAW,OAA1B,EAAmC,QAAnC,CAAP;AACA;AACD,KAJD,MAIO,IAAG,MAAM,OAAN,CAAc,SAAd,CAAH,EAA6B;AACnC,SAAI,IAAI,CAAR;AACC,eAAS,IAAT,GAAgB;AAChB,SAAG;AACF,WAAI,QAAQ,IAAZ;AACA,WAAG,KAAK,UAAU,MAAlB,EAA0B,OAAO,UAAP;AAC1B,uBAAgB,UAAU,GAAV,CAAhB,EAAgC,UAAS,GAAT,EAAc,MAAd,EAAsB;AACrD,YAAG,GAAH,EAAQ,OAAO,SAAS,GAAT,CAAP;AACR,YAAG,CAAC,MAAJ,EAAY;AACX,aAAG,KAAH,EAAU;AACT,kBAAQ,KAAR;AACA;AACA;AACD,gBAAO,MAAP;AACA;AACD,iBAAS,IAAT,EAAe,MAAf;AACA,QAVD;AAWA,OAdD,QAcS,CAAC,KAdV;AAeA,cAAQ,KAAR;AACA,MAjBA,GAAD;AAkBA;AACA,KArBM,MAqBA,IAAG,qBAAqB,MAAxB,EAAgC;AACtC,SAAG,UAAU,IAAV,CAAe,WAAW,OAA1B,CAAH,EAAuC;AACtC,aAAO,eAAe,WAAW,OAA1B,EAAmC,QAAnC,CAAP;AACA;AACD,KAJM,MAIA,IAAG,OAAO,SAAP,KAAqB,UAAxB,EAAoC;AAC1C,eAAU,IAAV,CAAe,IAAf,EAAqB,OAArB,EAA8B,WAAW,OAAzC,EAAkD,UAAS,GAAT,EAAc,KAAd,EAAqB,IAArB,EAA2B;AAC5E,UAAG,GAAH,EAAQ,OAAO,SAAS,GAAT,CAAP;AACR,UAAG,OAAO,KAAP,KAAiB,WAApB,EAAiC;AAChC,sBAAe,KAAf,EAAsB,IAAtB,EAA4B,QAA5B;AACA,OAFD,MAEO;AACN;AACA;AACD,MAPD;AAQA;AACA,KAVM,MAUA,IAAG,OAAO,SAAP,KAAqB,QAArB,IAAiC,OAAO,SAAP,CAAiB,cAAjB,CAAgC,IAAhC,CAAqC,SAArC,EAAgD,WAAW,OAA3D,CAApC,EAAyG;AAC/G,YAAO,eAAe,UAAU,WAAW,OAArB,CAAf,EAA8C,QAA9C,CAAP;AACA;AACD;AACA,IA5CA,EA4CC,KAAK,SA5CN,EA4CiB,UAAS,GAAT,EAAc,MAAd,EAAsB;AACvC,QAAG,GAAH,EAAQ,OAAO,SAAS,GAAT,CAAP;AACR,QAAG,CAAC,MAAJ,EAAY,OAAO,eAAe,KAAf,EAAsB,QAAtB,CAAP;AACZ,WAAO,SAAS,IAAT,EAAe,MAAf,CAAP;AACA,IAhDA,CAAD;AAiDA,GApEM,CAoEL,IApEK,CAoEA,IApEA,CAAP;AAqEA,EAtEqC,CAsEpC,IAtEoC,CAsE/B,IAtE+B,CAAtC;AAuEA,CAzED","file":"ExternalModuleFactoryPlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar ExternalModule = require(\"./ExternalModule\");\r\n\r\nfunction ExternalModuleFactoryPlugin(type, externals) {\r\n\tthis.type = type;\r\n\tthis.externals = externals;\r\n}\r\nmodule.exports = ExternalModuleFactoryPlugin;\r\n\r\nExternalModuleFactoryPlugin.prototype.apply = function(normalModuleFactory) {\r\n\tvar globalType = this.type;\r\n\tnormalModuleFactory.plugin(\"factory\", function(factory) {\r\n\t\treturn function(data, callback) {\r\n\t\t\tvar context = data.context;\r\n\t\t\tvar dependency = data.dependency;\r\n\r\n\t\t\tfunction handleExternal(value, type, callback) {\r\n\t\t\t\tif(typeof type === \"function\") {\r\n\t\t\t\t\tcallback = type;\r\n\t\t\t\t\ttype = undefined;\r\n\t\t\t\t}\r\n\t\t\t\tif(value === false) return factory(data, callback);\r\n\t\t\t\tif(value === true) value = dependency.request;\r\n\t\t\t\tif(typeof type === \"undefined\" && /^[a-z0-9]+ /.test(value)) {\r\n\t\t\t\t\tvar idx = value.indexOf(\" \");\r\n\t\t\t\t\ttype = value.substr(0, idx);\r\n\t\t\t\t\tvalue = value.substr(idx + 1);\r\n\t\t\t\t}\r\n\t\t\t\tcallback(null, new ExternalModule(value, type || globalType));\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\t(function handleExternals(externals, callback) {\r\n\t\t\t\tif(typeof externals === \"string\") {\r\n\t\t\t\t\tif(externals === dependency.request) {\r\n\t\t\t\t\t\treturn handleExternal(dependency.request, callback);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if(Array.isArray(externals)) {\r\n\t\t\t\t\tvar i = 0;\r\n\t\t\t\t\t(function next() {\r\n\t\t\t\t\t\tdo {\r\n\t\t\t\t\t\t\tvar async = true;\r\n\t\t\t\t\t\t\tif(i >= externals.length) return callback();\r\n\t\t\t\t\t\t\thandleExternals(externals[i++], function(err, module) {\r\n\t\t\t\t\t\t\t\tif(err) return callback(err);\r\n\t\t\t\t\t\t\t\tif(!module) {\r\n\t\t\t\t\t\t\t\t\tif(async) {\r\n\t\t\t\t\t\t\t\t\t\tasync = false;\r\n\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\treturn next();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tcallback(null, module);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} while (!async);\r\n\t\t\t\t\t\tasync = false;\r\n\t\t\t\t\t}());\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else if(externals instanceof RegExp) {\r\n\t\t\t\t\tif(externals.test(dependency.request)) {\r\n\t\t\t\t\t\treturn handleExternal(dependency.request, callback);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if(typeof externals === \"function\") {\r\n\t\t\t\t\texternals.call(null, context, dependency.request, function(err, value, type) {\r\n\t\t\t\t\t\tif(err) return callback(err);\r\n\t\t\t\t\t\tif(typeof value !== \"undefined\") {\r\n\t\t\t\t\t\t\thandleExternal(value, type, callback);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else if(typeof externals === \"object\" && Object.prototype.hasOwnProperty.call(externals, dependency.request)) {\r\n\t\t\t\t\treturn handleExternal(externals[dependency.request], callback);\r\n\t\t\t\t}\r\n\t\t\t\tcallback();\r\n\t\t\t}(this.externals, function(err, module) {\r\n\t\t\t\tif(err) return callback(err);\r\n\t\t\t\tif(!module) return handleExternal(false, callback);\r\n\t\t\t\treturn callback(null, module);\r\n\t\t\t}));\r\n\t\t}.bind(this);\r\n\t}.bind(this));\r\n};\r\n"]}