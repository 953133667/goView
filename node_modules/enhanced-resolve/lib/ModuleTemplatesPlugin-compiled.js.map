{"version":3,"sources":["ModuleTemplatesPlugin.js"],"names":[],"mappings":"AAAA;;;;AAIA,IAAI,sBAAsB,QAAQ,uBAAR,CAA1B;;AAEA,SAAS,qBAAT,CAA+B,UAA/B,EAA2C,SAA3C,EAAsD,gBAAtD,EAAwE;AACvE,MAAK,UAAL,GAAkB,UAAlB;AACA,MAAK,gBAAL,GAAwB,gBAAxB;AACA,MAAK,SAAL,GAAiB,SAAjB;AACA;AACD,OAAO,OAAP,GAAiB,qBAAjB;;AAEA,sBAAsB,SAAtB,CAAgC,KAAhC,GAAwC,UAAS,QAAT,EAAmB;AAC1D,KAAI,YAAY,KAAK,SAArB;AACA,KAAI,mBAAmB,KAAK,gBAA5B;AACA,UAAS,MAAT,CAAgB,YAAY,KAAK,UAAjC,EAA6C,UAAS,OAAT,EAAkB,QAAlB,EAA4B;AACxE,MAAI,KAAK,KAAK,UAAd;AACA,MAAI,mBAAmB,QAAvB;AACA,MAAI,IAAI,QAAQ,OAAR,CAAgB,OAAhB,CAAwB,GAAxB,CAAR;AAAA,MACC,IAAI,QAAQ,OAAR,CAAgB,OAAhB,CAAwB,IAAxB,CADL;AAEA,MAAI,IAAI,IAAI,CAAJ,GAAQ,CAAR,GAAY,IAAI,CAAJ,GAAQ,CAAR,GAAY,IAAI,CAAJ,GAAQ,CAAR,GAAY,CAA5C;AACA,MAAI,UAAJ,EAAgB,gBAAhB;AACA,MAAG,IAAI,CAAP,EAAU;AACT,gBAAa,QAAQ,OAArB;AACA,sBAAmB,EAAnB;AACA,GAHD,MAGO;AACN,gBAAa,QAAQ,OAAR,CAAgB,MAAhB,CAAuB,CAAvB,EAA0B,CAA1B,CAAb;AACA,sBAAmB,QAAQ,OAAR,CAAgB,MAAhB,CAAuB,CAAvB,CAAnB;AACA;AACD,OAAK,WAAL,CAAiB,SAAjB,EAA4B,UAAS,QAAT,EAAmB,QAAnB,EAA6B;AACxD,OAAI,kBAAkB,SAAS,OAAT,CAAiB,KAAjB,EAAwB,UAAxB,CAAtB;AACA,QAAK,8BAAL,CAAoC,YAAY,gBAAhD,EAAkE;AACjE,UAAM,QAAQ,IADmD;AAEjE,aAAS,kBAAkB,gBAFsC;AAGjE,WAAO,QAAQ,KAHkD;AAIjE,eAAW,QAAQ;AAJ8C,IAAlE,EAKG,oBAAoB,UAAS,GAAT,EAAc,MAAd,EAAsB;AAC5C,QAAG,GAAH,EAAQ,OAAO,SAAS,GAAT,CAAP;AACR,QAAG,CAAC,MAAJ,EAAY,OAAO,UAAP;AACZ,WAAO,SAAS,IAAT,EAAe,MAAf,CAAP;AACA,IAJE,EAIA,gBAJA,EAIkB,sBAAsB,eAJxC,CALH;AAUA,GAZ2B,CAY1B,IAZ0B,CAYrB,IAZqB,CAA5B,EAYc,QAZd;AAaA,EA3BD;AA4BA,CA/BD","file":"ModuleTemplatesPlugin-compiled.js","sourcesContent":["/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar createInnerCallback = require(\"./createInnerCallback\");\r\n\r\nfunction ModuleTemplatesPlugin(moduleType, templates, targetModuleType) {\r\n\tthis.moduleType = moduleType;\r\n\tthis.targetModuleType = targetModuleType;\r\n\tthis.templates = templates;\r\n}\r\nmodule.exports = ModuleTemplatesPlugin;\r\n\r\nModuleTemplatesPlugin.prototype.apply = function(resolver) {\r\n\tvar templates = this.templates;\r\n\tvar targetModuleType = this.targetModuleType;\r\n\tresolver.plugin(\"module-\" + this.moduleType, function(request, callback) {\r\n\t\tvar fs = this.fileSystem;\r\n\t\tvar topLevelCallback = callback;\r\n\t\tvar i = request.request.indexOf(\"/\"),\r\n\t\t\tj = request.request.indexOf(\"\\\\\");\r\n\t\tvar p = i < 0 ? j : j < 0 ? i : i < j ? i : j;\r\n\t\tvar moduleName, remainingRequest;\r\n\t\tif(p < 0) {\r\n\t\t\tmoduleName = request.request;\r\n\t\t\tremainingRequest = \"\";\r\n\t\t} else {\r\n\t\t\tmoduleName = request.request.substr(0, p);\r\n\t\t\tremainingRequest = request.request.substr(p);\r\n\t\t}\r\n\t\tthis.forEachBail(templates, function(template, callback) {\r\n\t\t\tvar moduleFinalName = template.replace(/\\*/g, moduleName);\r\n\t\t\tthis.applyPluginsParallelBailResult(\"module-\" + targetModuleType, {\r\n\t\t\t\tpath: request.path,\r\n\t\t\t\trequest: moduleFinalName + remainingRequest,\r\n\t\t\t\tquery: request.query,\r\n\t\t\t\tdirectory: request.directory\r\n\t\t\t}, createInnerCallback(function(err, result) {\r\n\t\t\t\tif(err) return callback(err);\r\n\t\t\t\tif(!result) return callback();\r\n\t\t\t\treturn callback(null, result);\r\n\t\t\t}, topLevelCallback, \"module variation \" + moduleFinalName));\r\n\t\t}.bind(this), callback);\r\n\t});\r\n};\r\n"]}