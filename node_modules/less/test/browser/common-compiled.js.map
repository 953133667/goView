{"version":3,"sources":["common.js"],"names":[],"mappings":"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","file":"common-compiled.js","sourcesContent":["/* Add js reporter for sauce */\n\njasmine.getEnv().addReporter(new jasmine.JSReporter2());\n\n/* record log messages for testing */\n\nvar logMessages = [];\nwindow.less = window.less || {};\n\nvar logLevel_debug = 4,\n    logLevel_info = 3,\n    logLevel_warn = 2,\n    logLevel_error = 1;\n\n// The amount of logging in the javascript console.\n// 3 - Debug, information and errors\n// 2 - Information and errors\n// 1 - Errors\n// 0 - None\n// Defaults to 2\n\nless.loggers = [\n    {\n        debug: function(msg) {\n            if (less.options.logLevel >= logLevel_debug) {\n                logMessages.push(msg);\n            }\n        },\n        info: function(msg) {\n            if (less.options.logLevel >= logLevel_info) {\n                logMessages.push(msg);\n            }\n        },\n        warn: function(msg) {\n            if (less.options.logLevel >= logLevel_warn) {\n                logMessages.push(msg);\n            }\n        },\n        error: function(msg) {\n            if (less.options.logLevel >= logLevel_error) {\n                logMessages.push(msg);\n            }\n        }\n    }\n];\n\nvar testLessEqualsInDocument = function () {\n    testLessInDocument(testSheet);\n};\n\nvar testLessErrorsInDocument = function (isConsole) {\n    testLessInDocument(isConsole ? testErrorSheetConsole : testErrorSheet);\n};\n\nvar testLessInDocument = function (testFunc) {\n    var links = document.getElementsByTagName('link'),\n        typePattern = /^text\\/(x-)?less$/;\n\n    for (var i = 0; i < links.length; i++) {\n        if (links[i].rel === 'stylesheet/less' || (links[i].rel.match(/stylesheet/) &&\n            (links[i].type.match(typePattern)))) {\n            testFunc(links[i]);\n        }\n    }\n};\n\nvar ieFormat = function(text) {\n    var styleNode = document.createElement('style');\n    styleNode.setAttribute('type', 'text/css');\n    var headNode = document.getElementsByTagName('head')[0];\n    headNode.appendChild(styleNode);\n    try {\n        if (styleNode.styleSheet) {\n            styleNode.styleSheet.cssText = text;\n        } else {\n            styleNode.innerText = text;\n        }\n    } catch (e) {\n        throw new Error(\"Couldn't reassign styleSheet.cssText.\");\n    }\n    var transformedText = styleNode.styleSheet ? styleNode.styleSheet.cssText : styleNode.innerText;\n    headNode.removeChild(styleNode);\n    return transformedText;\n};\n\nvar testSheet = function (sheet) {\n    it(sheet.id + \" should match the expected output\", function (done) {\n        var lessOutputId = sheet.id.replace(\"original-\", \"\"),\n            expectedOutputId = \"expected-\" + lessOutputId,\n            lessOutputObj,\n            lessOutput,\n            expectedOutputHref = document.getElementById(expectedOutputId).href,\n            expectedOutput = loadFile(expectedOutputHref);\n\n        // Browser spec generates less on the fly, so we need to loose control\n        less.pageLoadFinished\n            .then(function () {\n                lessOutputObj = document.getElementById(lessOutputId);\n                lessOutput = lessOutputObj.styleSheet ? lessOutputObj.styleSheet.cssText :\n                    (lessOutputObj.innerText || lessOutputObj.innerHTML);\n\n                expectedOutput\n                    .then(function (text) {\n                        if (window.navigator.userAgent.indexOf(\"MSIE\") >= 0 ||\n                            window.navigator.userAgent.indexOf(\"Trident/\") >= 0) {\n                            text = ieFormat(text);\n                        }\n                        expect(lessOutput).toEqual(text);\n                        done();\n                    });\n            });\n    });\n};\n\n//TODO: do it cleaner - the same way as in css\n\nfunction extractId(href) {\n    return href.replace(/^[a-z-]+:\\/+?[^\\/]+/i, '') // Remove protocol & domain\n        .replace(/^\\//, '') // Remove root /\n        .replace(/\\.[a-zA-Z]+$/, '') // Remove simple extension\n        .replace(/[^\\.\\w-]+/g, '-') // Replace illegal characters\n        .replace(/\\./g, ':'); // Replace dots with colons(for valid id)\n}\n\nvar waitFor = function (waitFunc) {\n    return new Promise(function (resolve) {\n        var timeoutId = setInterval(function () {\n            if (waitFunc()) {\n                clearInterval(timeoutId);\n                resolve();\n            }\n        }, 5);\n    });\n};\n\nvar testErrorSheet = function (sheet) {\n    it(sheet.id + \" should match an error\", function (done) {\n        var lessHref = sheet.href,\n            id = \"less-error-message:\" + extractId(lessHref),\n            errorHref = lessHref.replace(/.less$/, \".txt\"),\n            errorFile = loadFile(errorHref),\n            actualErrorElement,\n            actualErrorMsg;\n\n        // Less.js sets 10ms timer in order to add error message on top of page.\n        waitFor(function () {\n            actualErrorElement = document.getElementById(id);\n            return actualErrorElement !== null;\n        }).then(function () {\n                var innerText = (actualErrorElement.innerHTML\n                        .replace(/<h3>|<\\/?p>|<a href=\"[^\"]*\">|<\\/a>|<ul>|<\\/?pre( class=\"?[^\">]*\"?)?>|<\\/li>|<\\/?label>/ig, \"\")\n                        .replace(/<\\/h3>/ig, \" \")\n                        .replace(/<li>|<\\/ul>|<br>/ig, \"\\n\"))\n                        .replace(/&amp;/ig, \"&\")\n                        // for IE8\n                        .replace(/\\r\\n/g, \"\\n\")\n                        .replace(/\\. \\nin/, \". in\");\n                actualErrorMsg = innerText\n                    .replace(/\\n\\d+/g, function (lineNo) {\n                        return lineNo + \" \";\n                    })\n                    .replace(/\\n\\s*in /g, \" in \")\n                    .replace(/\\n{2,}/g, \"\\n\")\n                    .replace(/\\nStack Trace\\n[\\s\\S]*/i, \"\")\n                    .replace(/\\n$/, \"\");\n                errorFile\n                    .then(function (errorTxt) {\n                        errorTxt = errorTxt\n                            .replace(/\\{path\\}/g, \"\")\n                            .replace(/\\{pathrel\\}/g, \"\")\n                            .replace(/\\{pathhref\\}/g, \"http://localhost:8081/test/less/errors/\")\n                            .replace(/\\{404status\\}/g, \" (404)\")\n                            .replace(/\\{node\\}.*\\{\\/node\\}/g, \"\")\n                            .replace(/\\n$/, \"\");\n                        expect(actualErrorMsg).toEqual(errorTxt);\n                        if (errorTxt == actualErrorMsg) {\n                            actualErrorElement.style.display = \"none\";\n                        }\n                        done();\n                    });\n            });\n    });\n};\n\nvar testErrorSheetConsole = function (sheet) {\n    it(sheet.id + \" should match an error\", function (done) {\n        var lessHref = sheet.href,\n            id = sheet.id.replace(/^original-less:/, \"less-error-message:\"),\n            errorHref = lessHref.replace(/.less$/, \".txt\"),\n            errorFile = loadFile(errorHref),\n            actualErrorElement = document.getElementById(id),\n            actualErrorMsg = logMessages[logMessages.length - 1]\n                .replace(/\\nStack Trace\\n[\\s\\S]*/, \"\");\n\n        describe(\"the error\", function () {\n            expect(actualErrorElement).toBe(null);\n        });\n\n        errorFile\n            .then(function (errorTxt) {\n                errorTxt\n                    .replace(/\\{path\\}/g, \"\")\n                    .replace(/\\{pathrel\\}/g, \"\")\n                    .replace(/\\{pathhref\\}/g, \"http://localhost:8081/browser/less/\")\n                    .replace(/\\{404status\\}/g, \" (404)\")\n                    .replace(/\\{node\\}.*\\{\\/node\\}/g, \"\")\n                    .trim();\n                expect(actualErrorMsg).toEqual(errorTxt);\n                done();\n            });\n    });\n};\n\nvar loadFile = function (href) {\n    return new Promise(function (resolve, reject) {\n        var request = new XMLHttpRequest();\n        request.open('GET', href, true);\n        request.onreadystatechange = function () {\n            if (request.readyState == 4) {\n                resolve(request.responseText.replace(/\\r/g, \"\"));\n            }\n        };\n        request.send(null);\n    });\n};\n\njasmine.DEFAULT_TIMEOUT_INTERVAL = 90000;\n"]}