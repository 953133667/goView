{"version":3,"sources":["join-selector-visitor.js"],"names":[],"mappings":"AAAA,IAAI,UAAU,QAAQ,WAAR,CAAd;;AAEA,IAAI,sBAAsB,YAAW;AACjC,SAAK,QAAL,GAAgB,CAAC,EAAD,CAAhB;AACA,SAAK,QAAL,GAAgB,IAAI,OAAJ,CAAY,IAAZ,CAAhB;AACH,CAHD;;AAKA,oBAAoB,SAApB,GAAgC;AAC5B,SAAK,UAAU,IAAV,EAAgB;AACjB,eAAO,KAAK,QAAL,CAAc,KAAd,CAAoB,IAApB,CAAP;AACH,KAH2B;AAI5B,eAAW,UAAU,QAAV,EAAoB,SAApB,EAA+B;AACtC,kBAAU,WAAV,GAAwB,KAAxB;AACH,KAN2B;AAO5B,0BAAsB,UAAU,mBAAV,EAA+B,SAA/B,EAA0C;AAC5D,kBAAU,WAAV,GAAwB,KAAxB;AACH,KAT2B;;AAW5B,kBAAc,UAAU,WAAV,EAAuB,SAAvB,EAAkC;AAC5C,YAAI,UAAU,KAAK,QAAL,CAAc,KAAK,QAAL,CAAc,MAAd,GAAuB,CAArC,CAAd;AAAA,YACI,QAAQ,EADZ;AAAA,YACgB,SADhB;;AAGA,aAAK,QAAL,CAAc,IAAd,CAAmB,KAAnB;;AAEA,YAAI,CAAE,YAAY,IAAlB,EAAwB;AACpB,wBAAY,YAAY,SAAxB;AACA,gBAAI,SAAJ,EAAe;AACX,4BAAY,UAAU,MAAV,CAAiB,UAAS,QAAT,EAAmB;AAAE,2BAAO,SAAS,WAAT,EAAP;AAAgC,iBAAtE,CAAZ;AACA,4BAAY,SAAZ,GAAwB,UAAU,MAAV,GAAmB,SAAnB,GAAgC,YAAY,IAApE;AACA,oBAAI,SAAJ,EAAe;AAAE,gCAAY,aAAZ,CAA0B,KAA1B,EAAiC,OAAjC,EAA0C,SAA1C;AAAuD;AAC3E;AACD,gBAAI,CAAC,SAAL,EAAgB;AAAE,4BAAY,KAAZ,GAAoB,IAApB;AAA2B;AAC7C,wBAAY,KAAZ,GAAoB,KAApB;AACH;AACJ,KA3B2B;AA4B5B,qBAAiB,UAAU,WAAV,EAAuB;AACpC,aAAK,QAAL,CAAc,MAAd,GAAuB,KAAK,QAAL,CAAc,MAAd,GAAuB,CAA9C;AACH,KA9B2B;AA+B5B,gBAAY,UAAU,SAAV,EAAqB,SAArB,EAAgC;AACxC,YAAI,UAAU,KAAK,QAAL,CAAc,KAAK,QAAL,CAAc,MAAd,GAAuB,CAArC,CAAd;AACA,kBAAU,KAAV,CAAgB,CAAhB,EAAmB,IAAnB,GAA2B,QAAQ,MAAR,KAAmB,CAAnB,IAAwB,QAAQ,CAAR,EAAW,UAA9D;AACH,KAlC2B;AAmC5B,oBAAgB,UAAU,aAAV,EAAyB,SAAzB,EAAoC;AAChD,YAAI,UAAU,KAAK,QAAL,CAAc,KAAK,QAAL,CAAc,MAAd,GAAuB,CAArC,CAAd;AACA,YAAI,cAAc,KAAd,IAAuB,cAAc,KAAd,CAAoB,MAA/C,EAAuD;AACnD,0BAAc,KAAd,CAAoB,CAApB,EAAuB,IAAvB,GAA+B,cAAc,QAAd,IAA0B,QAAQ,MAAR,KAAmB,CAA7C,IAAkD,IAAjF;AACH;AACJ;AAxC2B,CAAhC;;AA2CA,OAAO,OAAP,GAAiB,mBAAjB","file":"join-selector-visitor-compiled.js","sourcesContent":["var Visitor = require(\"./visitor\");\n\nvar JoinSelectorVisitor = function() {\n    this.contexts = [[]];\n    this._visitor = new Visitor(this);\n};\n\nJoinSelectorVisitor.prototype = {\n    run: function (root) {\n        return this._visitor.visit(root);\n    },\n    visitRule: function (ruleNode, visitArgs) {\n        visitArgs.visitDeeper = false;\n    },\n    visitMixinDefinition: function (mixinDefinitionNode, visitArgs) {\n        visitArgs.visitDeeper = false;\n    },\n\n    visitRuleset: function (rulesetNode, visitArgs) {\n        var context = this.contexts[this.contexts.length - 1],\n            paths = [], selectors;\n\n        this.contexts.push(paths);\n\n        if (! rulesetNode.root) {\n            selectors = rulesetNode.selectors;\n            if (selectors) {\n                selectors = selectors.filter(function(selector) { return selector.getIsOutput(); });\n                rulesetNode.selectors = selectors.length ? selectors : (selectors = null);\n                if (selectors) { rulesetNode.joinSelectors(paths, context, selectors); }\n            }\n            if (!selectors) { rulesetNode.rules = null; }\n            rulesetNode.paths = paths;\n        }\n    },\n    visitRulesetOut: function (rulesetNode) {\n        this.contexts.length = this.contexts.length - 1;\n    },\n    visitMedia: function (mediaNode, visitArgs) {\n        var context = this.contexts[this.contexts.length - 1];\n        mediaNode.rules[0].root = (context.length === 0 || context[0].multiMedia);\n    },\n    visitDirective: function (directiveNode, visitArgs) {\n        var context = this.contexts[this.contexts.length - 1];\n        if (directiveNode.rules && directiveNode.rules.length) {\n            directiveNode.rules[0].root = (directiveNode.isRooted || context.length === 0 || null);\n        }\n    }\n};\n\nmodule.exports = JoinSelectorVisitor;\n"]}