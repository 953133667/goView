{"version":3,"sources":["selector.js"],"names":[],"mappings":"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","file":"selector-compiled.js","sourcesContent":["var Node = require(\"./node\"),\n    Element = require(\"./element\");\n\nvar Selector = function (elements, extendList, condition, index, currentFileInfo, visibilityInfo) {\n    this.elements = elements;\n    this.extendList = extendList;\n    this.condition = condition;\n    this.currentFileInfo = currentFileInfo || {};\n    if (!condition) {\n        this.evaldCondition = true;\n    }\n    this.copyVisibilityInfo(visibilityInfo);\n};\nSelector.prototype = new Node();\nSelector.prototype.type = \"Selector\";\nSelector.prototype.accept = function (visitor) {\n    if (this.elements) {\n        this.elements = visitor.visitArray(this.elements);\n    }\n    if (this.extendList) {\n        this.extendList = visitor.visitArray(this.extendList);\n    }\n    if (this.condition) {\n        this.condition = visitor.visit(this.condition);\n    }\n};\nSelector.prototype.createDerived = function(elements, extendList, evaldCondition) {\n    var info = this.visibilityInfo();\n    evaldCondition = (evaldCondition != null) ? evaldCondition : this.evaldCondition;\n    var newSelector = new Selector(elements, extendList || this.extendList, null, this.index, this.currentFileInfo, info);\n    newSelector.evaldCondition = evaldCondition;\n    newSelector.mediaEmpty = this.mediaEmpty;\n    return newSelector;\n};\nSelector.prototype.createEmptySelectors = function() {\n    var el = new Element('', '&', this.index, this.currentFileInfo),\n        sels = [new Selector([el], null, null, this.index, this.currentFileInfo)];\n    sels[0].mediaEmpty = true;\n    return sels;\n};\nSelector.prototype.match = function (other) {\n    var elements = this.elements,\n        len = elements.length,\n        olen, i;\n\n    other.CacheElements();\n\n    olen = other._elements.length;\n    if (olen === 0 || len < olen) {\n        return 0;\n    } else {\n        for (i = 0; i < olen; i++) {\n            if (elements[i].value !== other._elements[i]) {\n                return 0;\n            }\n        }\n    }\n\n    return olen; // return number of matched elements\n};\nSelector.prototype.CacheElements = function() {\n    if (this._elements) {\n        return;\n    }\n\n    var elements = this.elements.map( function(v) {\n        return v.combinator.value + (v.value.value || v.value);\n    }).join(\"\").match(/[,&#\\*\\.\\w-]([\\w-]|(\\\\.))*/g);\n\n    if (elements) {\n        if (elements[0] === \"&\") {\n            elements.shift();\n        }\n    } else {\n        elements = [];\n    }\n\n    this._elements = elements;\n};\nSelector.prototype.isJustParentSelector = function() {\n    return !this.mediaEmpty &&\n        this.elements.length === 1 &&\n        this.elements[0].value === '&' &&\n        (this.elements[0].combinator.value === ' ' || this.elements[0].combinator.value === '');\n};\nSelector.prototype.eval = function (context) {\n    var evaldCondition = this.condition && this.condition.eval(context),\n        elements = this.elements, extendList = this.extendList;\n\n    elements = elements && elements.map(function (e) { return e.eval(context); });\n    extendList = extendList && extendList.map(function(extend) { return extend.eval(context); });\n\n    return this.createDerived(elements, extendList, evaldCondition);\n};\nSelector.prototype.genCSS = function (context, output) {\n    var i, element;\n    if ((!context || !context.firstSelector) && this.elements[0].combinator.value === \"\") {\n        output.add(' ', this.currentFileInfo, this.index);\n    }\n    if (!this._css) {\n        //TODO caching? speed comparison?\n        for (i = 0; i < this.elements.length; i++) {\n            element = this.elements[i];\n            element.genCSS(context, output);\n        }\n    }\n};\nSelector.prototype.getIsOutput = function() {\n    return this.evaldCondition;\n};\nmodule.exports = Selector;\n"]}