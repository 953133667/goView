{"version":3,"sources":["url.js"],"names":[],"mappings":"AAAA,IAAI,OAAO,QAAQ,QAAR,CAAX;;AAEA,IAAI,MAAM,UAAU,GAAV,EAAe,KAAf,EAAsB,eAAtB,EAAuC,OAAvC,EAAgD;AACtD,SAAK,KAAL,GAAa,GAAb;AACA,SAAK,eAAL,GAAuB,eAAvB;AACA,SAAK,KAAL,GAAa,KAAb;AACA,SAAK,OAAL,GAAe,OAAf;AACH,CALD;AAMA,IAAI,SAAJ,GAAgB,IAAI,IAAJ,EAAhB;AACA,IAAI,SAAJ,CAAc,IAAd,GAAqB,KAArB;AACA,IAAI,SAAJ,CAAc,MAAd,GAAuB,UAAU,OAAV,EAAmB;AACtC,SAAK,KAAL,GAAa,QAAQ,KAAR,CAAc,KAAK,KAAnB,CAAb;AACH,CAFD;AAGA,IAAI,SAAJ,CAAc,MAAd,GAAuB,UAAU,OAAV,EAAmB,MAAnB,EAA2B;AAC9C,WAAO,GAAP,CAAW,MAAX;AACA,SAAK,KAAL,CAAW,MAAX,CAAkB,OAAlB,EAA2B,MAA3B;AACA,WAAO,GAAP,CAAW,GAAX;AACH,CAJD;AAKA,IAAI,SAAJ,CAAc,IAAd,GAAqB,UAAU,OAAV,EAAmB;AACpC,QAAI,MAAM,KAAK,KAAL,CAAW,IAAX,CAAgB,OAAhB,CAAV;AAAA,QACI,QADJ;;AAGA,QAAI,CAAC,KAAK,OAAV,EAAmB;AACf;AACA,mBAAW,KAAK,eAAL,IAAwB,KAAK,eAAL,CAAqB,QAAxD;AACA,YAAI,YACA,OAAO,IAAI,KAAX,KAAqB,QADrB,IAEA,QAAQ,cAAR,CAAuB,IAAI,KAA3B,CAFJ,EAEuC;;AAEnC,gBAAI,CAAC,IAAI,KAAT,EAAgB;AACZ,2BAAW,SAAS,OAAT,CAAiB,aAAjB,EAAgC,UAAS,KAAT,EAAgB;AAAE,2BAAO,OAAO,KAAd;AAAsB,iBAAxE,CAAX;AACH;AACD,gBAAI,KAAJ,GAAY,WAAW,IAAI,KAA3B;AACH;;AAED,YAAI,KAAJ,GAAY,QAAQ,aAAR,CAAsB,IAAI,KAA1B,CAAZ;;AAEA;AACA,YAAI,QAAQ,OAAZ,EAAqB;AACjB,gBAAI,CAAC,IAAI,KAAJ,CAAU,KAAV,CAAgB,WAAhB,CAAL,EAAmC;AAC/B,oBAAI,YAAY,IAAI,KAAJ,CAAU,OAAV,CAAkB,GAAlB,MAA2B,CAAC,CAA5B,GAAgC,GAAhC,GAAsC,GAAtD;AACA,oBAAI,UAAU,YAAY,QAAQ,OAAlC;AACA,oBAAI,IAAI,KAAJ,CAAU,OAAV,CAAkB,GAAlB,MAA2B,CAAC,CAAhC,EAAmC;AAC/B,wBAAI,KAAJ,GAAY,IAAI,KAAJ,CAAU,OAAV,CAAkB,GAAlB,EAAuB,UAAU,GAAjC,CAAZ;AACH,iBAFD,MAEO;AACH,wBAAI,KAAJ,IAAa,OAAb;AACH;AACJ;AACJ;AACJ;;AAED,WAAO,IAAI,GAAJ,CAAQ,GAAR,EAAa,KAAK,KAAlB,EAAyB,KAAK,eAA9B,EAA+C,IAA/C,CAAP;AACH,CAlCD;AAmCA,OAAO,OAAP,GAAiB,GAAjB","file":"url-compiled.js","sourcesContent":["var Node = require(\"./node\");\n\nvar URL = function (val, index, currentFileInfo, isEvald) {\n    this.value = val;\n    this.currentFileInfo = currentFileInfo;\n    this.index = index;\n    this.isEvald = isEvald;\n};\nURL.prototype = new Node();\nURL.prototype.type = \"Url\";\nURL.prototype.accept = function (visitor) {\n    this.value = visitor.visit(this.value);\n};\nURL.prototype.genCSS = function (context, output) {\n    output.add(\"url(\");\n    this.value.genCSS(context, output);\n    output.add(\")\");\n};\nURL.prototype.eval = function (context) {\n    var val = this.value.eval(context),\n        rootpath;\n\n    if (!this.isEvald) {\n        // Add the base path if the URL is relative\n        rootpath = this.currentFileInfo && this.currentFileInfo.rootpath;\n        if (rootpath &&\n            typeof val.value === \"string\" &&\n            context.isPathRelative(val.value)) {\n\n            if (!val.quote) {\n                rootpath = rootpath.replace(/[\\(\\)'\"\\s]/g, function(match) { return \"\\\\\" + match; });\n            }\n            val.value = rootpath + val.value;\n        }\n\n        val.value = context.normalizePath(val.value);\n\n        // Add url args if enabled\n        if (context.urlArgs) {\n            if (!val.value.match(/^\\s*data:/)) {\n                var delimiter = val.value.indexOf('?') === -1 ? '?' : '&';\n                var urlArgs = delimiter + context.urlArgs;\n                if (val.value.indexOf('#') !== -1) {\n                    val.value = val.value.replace('#', urlArgs + '#');\n                } else {\n                    val.value += urlArgs;\n                }\n            }\n        }\n    }\n\n    return new URL(val, this.index, this.currentFileInfo, true);\n};\nmodule.exports = URL;\n"]}