{"version":3,"sources":["cache.js"],"names":[],"mappings":"AAAA;;AAEA,OAAO,OAAP,GAAiB,UAAS,MAAT,EAAiB,OAAjB,EAA0B,MAA1B,EAAkC;AAC/C,QAAI,QAAQ,IAAZ;AACA,QAAI,QAAQ,GAAR,KAAgB,aAApB,EAAmC;AAC/B,YAAI;AACA,oBAAS,OAAO,OAAO,YAAd,KAA+B,WAAhC,GAA+C,IAA/C,GAAsD,OAAO,YAArE;AACH,SAFD,CAEE,OAAO,CAAP,EAAU,CAAE;AACjB;AACD,WAAO;AACH,gBAAQ,UAAS,IAAT,EAAe,YAAf,EAA6B,UAA7B,EAAyC,MAAzC,EAAiD;AACrD,gBAAI,KAAJ,EAAW;AACP,uBAAO,IAAP,CAAY,YAAY,IAAZ,GAAmB,YAA/B;AACA,oBAAI;AACA,0BAAM,OAAN,CAAc,IAAd,EAAoB,MAApB;AACA,0BAAM,OAAN,CAAc,OAAO,YAArB,EAAmC,YAAnC;AACA,wBAAI,UAAJ,EAAgB;AACZ,8BAAM,OAAN,CAAc,OAAO,OAArB,EAA8B,KAAK,SAAL,CAAe,UAAf,CAA9B;AACH;AACJ,iBAND,CAME,OAAM,CAAN,EAAS;AACP;AACA,2BAAO,KAAP,CAAa,qBAAqB,IAArB,GAA4B,iCAAzC;AACH;AACJ;AACJ,SAfE;AAgBH,gBAAQ,UAAS,IAAT,EAAe,OAAf,EAAwB,UAAxB,EAAoC;AACxC,gBAAI,MAAY,SAAS,MAAM,OAAN,CAAc,IAAd,CAAzB;AAAA,gBACI,YAAY,SAAS,MAAM,OAAN,CAAc,OAAO,YAArB,CADzB;AAAA,gBAEI,OAAY,SAAS,MAAM,OAAN,CAAc,OAAO,OAArB,CAFzB;;AAIA,yBAAa,cAAc,EAA3B;;AAEA,gBAAI,aAAa,QAAQ,YAArB,IACC,IAAI,IAAJ,CAAS,QAAQ,YAAjB,EAA+B,OAA/B,OACG,IAAI,IAAJ,CAAS,SAAT,EAAoB,OAApB,EAFJ,KAGC,CAAC,UAAD,IAAe,CAAC,IAAhB,IAAwB,KAAK,SAAL,CAAe,UAAf,MAA+B,IAHxD,CAAJ,EAGmE;AAC/D;AACA,uBAAO,GAAP;AACH;AACJ;AA9BE,KAAP;AAgCH,CAvCD","file":"cache-compiled.js","sourcesContent":["// Cache system is a bit outdated and could do with work\n\nmodule.exports = function(window, options, logger) {\n    var cache = null;\n    if (options.env !== 'development') {\n        try {\n            cache = (typeof window.localStorage === 'undefined') ? null : window.localStorage;\n        } catch (_) {}\n    }\n    return {\n        setCSS: function(path, lastModified, modifyVars, styles) {\n            if (cache) {\n                logger.info('saving ' + path + ' to cache.');\n                try {\n                    cache.setItem(path, styles);\n                    cache.setItem(path + ':timestamp', lastModified);\n                    if (modifyVars) {\n                        cache.setItem(path + ':vars', JSON.stringify(modifyVars));\n                    }\n                } catch(e) {\n                    //TODO - could do with adding more robust error handling\n                    logger.error('failed to save \"' + path + '\" to local storage for caching.');\n                }\n            }\n        },\n        getCSS: function(path, webInfo, modifyVars) {\n            var css       = cache && cache.getItem(path),\n                timestamp = cache && cache.getItem(path + ':timestamp'),\n                vars      = cache && cache.getItem(path + ':vars');\n\n            modifyVars = modifyVars || {};\n\n            if (timestamp && webInfo.lastModified &&\n                (new Date(webInfo.lastModified).valueOf() ===\n                    new Date(timestamp).valueOf()) &&\n                (!modifyVars && !vars || JSON.stringify(modifyVars) === vars)) {\n                // Use local copy\n                return css;\n            }\n        }\n    };\n};\n"]}