{"version":3,"sources":["error-reporting.js"],"names":[],"mappings":"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","file":"error-reporting-compiled.js","sourcesContent":["var utils = require(\"./utils\"),\n    browser = require(\"./browser\");\n\nmodule.exports = function(window, less, options) {\n\n    function errorHTML(e, rootHref) {\n        var id = 'less-error-message:' + utils.extractId(rootHref || \"\");\n        var template = '<li><label>{line}</label><pre class=\"{class}\">{content}</pre></li>';\n        var elem = window.document.createElement('div'), timer, content, errors = [];\n        var filename = e.filename || rootHref;\n        var filenameNoPath = filename.match(/([^\\/]+(\\?.*)?)$/)[1];\n\n        elem.id        = id;\n        elem.className = \"less-error-message\";\n\n        content = '<h3>'  + (e.type || \"Syntax\") + \"Error: \" + (e.message || 'There is an error in your .less file') +\n            '</h3>' + '<p>in <a href=\"' + filename   + '\">' + filenameNoPath + \"</a> \";\n\n        var errorline = function (e, i, classname) {\n            if (e.extract[i] !== undefined) {\n                errors.push(template.replace(/\\{line\\}/, (parseInt(e.line, 10) || 0) + (i - 1))\n                    .replace(/\\{class\\}/, classname)\n                    .replace(/\\{content\\}/, e.extract[i]));\n            }\n        };\n\n        if (e.extract) {\n            errorline(e, 0, '');\n            errorline(e, 1, 'line');\n            errorline(e, 2, '');\n            content += 'on line ' + e.line + ', column ' + (e.column + 1) + ':</p>' +\n                '<ul>' + errors.join('') + '</ul>';\n        }\n        if (e.stack && (e.extract || options.logLevel >= 4)) {\n            content += '<br/>Stack Trace</br />' + e.stack.split('\\n').slice(1).join('<br/>');\n        }\n        elem.innerHTML = content;\n\n        // CSS for error messages\n        browser.createCSS(window.document, [\n            '.less-error-message ul, .less-error-message li {',\n            'list-style-type: none;',\n            'margin-right: 15px;',\n            'padding: 4px 0;',\n            'margin: 0;',\n            '}',\n            '.less-error-message label {',\n            'font-size: 12px;',\n            'margin-right: 15px;',\n            'padding: 4px 0;',\n            'color: #cc7777;',\n            '}',\n            '.less-error-message pre {',\n            'color: #dd6666;',\n            'padding: 4px 0;',\n            'margin: 0;',\n            'display: inline-block;',\n            '}',\n            '.less-error-message pre.line {',\n            'color: #ff0000;',\n            '}',\n            '.less-error-message h3 {',\n            'font-size: 20px;',\n            'font-weight: bold;',\n            'padding: 15px 0 5px 0;',\n            'margin: 0;',\n            '}',\n            '.less-error-message a {',\n            'color: #10a',\n            '}',\n            '.less-error-message .error {',\n            'color: red;',\n            'font-weight: bold;',\n            'padding-bottom: 2px;',\n            'border-bottom: 1px dashed red;',\n            '}'\n        ].join('\\n'), { title: 'error-message' });\n\n        elem.style.cssText = [\n            \"font-family: Arial, sans-serif\",\n            \"border: 1px solid #e00\",\n            \"background-color: #eee\",\n            \"border-radius: 5px\",\n            \"-webkit-border-radius: 5px\",\n            \"-moz-border-radius: 5px\",\n            \"color: #e00\",\n            \"padding: 15px\",\n            \"margin-bottom: 15px\"\n        ].join(';');\n\n        if (options.env === 'development') {\n            timer = setInterval(function () {\n                var document = window.document,\n                    body = document.body;\n                if (body) {\n                    if (document.getElementById(id)) {\n                        body.replaceChild(elem, document.getElementById(id));\n                    } else {\n                        body.insertBefore(elem, body.firstChild);\n                    }\n                    clearInterval(timer);\n                }\n            }, 10);\n        }\n    }\n\n    function removeErrorHTML(path) {\n        var node = window.document.getElementById('less-error-message:' + utils.extractId(path));\n        if (node) {\n            node.parentNode.removeChild(node);\n        }\n    }\n\n    function removeErrorConsole(path) {\n        //no action\n    }\n\n    function removeError(path) {\n        if (!options.errorReporting || options.errorReporting === \"html\") {\n            removeErrorHTML(path);\n        } else if (options.errorReporting === \"console\") {\n            removeErrorConsole(path);\n        } else if (typeof options.errorReporting === 'function') {\n            options.errorReporting(\"remove\", path);\n        }\n    }\n\n    function errorConsole(e, rootHref) {\n        var template = '{line} {content}';\n        var filename = e.filename || rootHref;\n        var errors = [];\n        var content = (e.type || \"Syntax\") + \"Error: \" + (e.message || 'There is an error in your .less file') +\n            \" in \" + filename + \" \";\n\n        var errorline = function (e, i, classname) {\n            if (e.extract[i] !== undefined) {\n                errors.push(template.replace(/\\{line\\}/, (parseInt(e.line, 10) || 0) + (i - 1))\n                    .replace(/\\{class\\}/, classname)\n                    .replace(/\\{content\\}/, e.extract[i]));\n            }\n        };\n\n        if (e.extract) {\n            errorline(e, 0, '');\n            errorline(e, 1, 'line');\n            errorline(e, 2, '');\n            content += 'on line ' + e.line + ', column ' + (e.column + 1) + ':\\n' +\n                errors.join('\\n');\n        }\n        if (e.stack && (e.extract || options.logLevel >= 4)) {\n            content += '\\nStack Trace\\n' + e.stack;\n        }\n        less.logger.error(content);\n    }\n\n    function error(e, rootHref) {\n        if (!options.errorReporting || options.errorReporting === \"html\") {\n            errorHTML(e, rootHref);\n        } else if (options.errorReporting === \"console\") {\n            errorConsole(e, rootHref);\n        } else if (typeof options.errorReporting === 'function') {\n            options.errorReporting(\"add\", e, rootHref);\n        }\n    }\n\n    return {\n        add: error,\n        remove: removeError\n    };\n};\n"]}