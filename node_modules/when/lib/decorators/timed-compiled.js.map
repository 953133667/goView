{"version":3,"sources":["timed.js"],"names":[],"mappings":"AAAA;AACA;AACA;;AAEC,WAAS,MAAT,EAAiB;AAAE;;AACpB,QAAO,UAAS,OAAT,EAAkB;;AAExB,MAAI,MAAM,QAAQ,QAAR,CAAV;AACA,MAAI,eAAe,QAAQ,iBAAR,CAAnB;;AAEA,WAAS,UAAT,CAAoB,CAApB,EAAuB,EAAvB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC;AAChC,UAAO,IAAI,QAAJ,CAAa,YAAW;AAC9B,MAAE,CAAF,EAAK,CAAL,EAAQ,EAAR;AACA,IAFM,EAEJ,EAFI,CAAP;AAGA;;AAED,SAAO,SAAS,KAAT,CAAe,OAAf,EAAwB;AAC9B;;;;;;AAMA,WAAQ,SAAR,CAAkB,KAAlB,GAA0B,UAAS,EAAT,EAAa;AACtC,QAAI,IAAI,KAAK,MAAL,EAAR;AACA,SAAK,QAAL,CAAc,IAAd,CAAmB,WAAnB,EAAgC,EAAhC,EAAoC,KAAK,CAAzC,EAA4C,EAAE,QAA9C;AACA,WAAO,CAAP;AACA,IAJD;;AAMA,YAAS,WAAT,CAAqB,EAArB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+B;AAC9B,eAAW,YAAX,EAAyB,EAAzB,EAA6B,CAA7B,EAAgC,CAAhC;AACA;;AAED,YAAS,YAAT,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B;AAC3B,MAAE,OAAF,CAAU,CAAV;AACA;;AAED;;;;;;;;;AASA,WAAQ,SAAR,CAAkB,OAAlB,GAA4B,UAAS,EAAT,EAAa,MAAb,EAAqB;AAChD,QAAI,IAAI,KAAK,MAAL,EAAR;AACA,QAAI,IAAI,EAAE,QAAV;;AAEA,QAAI,IAAI,WAAW,SAAX,EAAsB,EAAtB,EAA0B,MAA1B,EAAkC,EAAE,QAApC,CAAR;;AAEA,SAAK,QAAL,CAAc,KAAd,CAAoB,CAApB,EACC,SAAS,SAAT,CAAmB,CAAnB,EAAsB;AACrB,SAAI,UAAJ,CAAe,CAAf;AACA,UAAK,OAAL,CAAa,CAAb,EAFqB,CAEJ;AACjB,KAJF,EAKC,SAAS,QAAT,CAAkB,CAAlB,EAAqB;AACpB,SAAI,UAAJ,CAAe,CAAf;AACA,UAAK,MAAL,CAAY,CAAZ,EAFoB,CAEJ;AAChB,KARF,EASC,EAAE,MATH;;AAWA,WAAO,CAAP;AACA,IAlBD;;AAoBA,YAAS,SAAT,CAAmB,MAAnB,EAA2B,CAA3B,EAA8B,EAA9B,EAAkC;AACjC,QAAI,IAAI,OAAO,MAAP,KAAkB,WAAlB,GACL,IAAI,YAAJ,CAAiB,qBAAqB,EAArB,GAA0B,IAA3C,CADK,GAEL,MAFH;AAGA,MAAE,MAAF,CAAS,CAAT;AACA;;AAED,UAAO,OAAP;AACA,GA1DD;AA4DA,EAvED;AAwEC,CAzEA,EAyEC,OAAO,MAAP,KAAkB,UAAlB,IAAgC,OAAO,GAAvC,GAA6C,MAA7C,GAAsD,UAAS,OAAT,EAAkB;AAAE,QAAO,OAAP,GAAiB,QAAQ,OAAR,CAAjB;AAAoC,CAzE/G,CAAD","file":"timed-compiled.js","sourcesContent":["/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n(function(define) { 'use strict';\ndefine(function(require) {\n\n\tvar env = require('../env');\n\tvar TimeoutError = require('../TimeoutError');\n\n\tfunction setTimeout(f, ms, x, y) {\n\t\treturn env.setTimer(function() {\n\t\t\tf(x, y, ms);\n\t\t}, ms);\n\t}\n\n\treturn function timed(Promise) {\n\t\t/**\n\t\t * Return a new promise whose fulfillment value is revealed only\n\t\t * after ms milliseconds\n\t\t * @param {number} ms milliseconds\n\t\t * @returns {Promise}\n\t\t */\n\t\tPromise.prototype.delay = function(ms) {\n\t\t\tvar p = this._beget();\n\t\t\tthis._handler.fold(handleDelay, ms, void 0, p._handler);\n\t\t\treturn p;\n\t\t};\n\n\t\tfunction handleDelay(ms, x, h) {\n\t\t\tsetTimeout(resolveDelay, ms, x, h);\n\t\t}\n\n\t\tfunction resolveDelay(x, h) {\n\t\t\th.resolve(x);\n\t\t}\n\n\t\t/**\n\t\t * Return a new promise that rejects after ms milliseconds unless\n\t\t * this promise fulfills earlier, in which case the returned promise\n\t\t * fulfills with the same value.\n\t\t * @param {number} ms milliseconds\n\t\t * @param {Error|*=} reason optional rejection reason to use, defaults\n\t\t *   to a TimeoutError if not provided\n\t\t * @returns {Promise}\n\t\t */\n\t\tPromise.prototype.timeout = function(ms, reason) {\n\t\t\tvar p = this._beget();\n\t\t\tvar h = p._handler;\n\n\t\t\tvar t = setTimeout(onTimeout, ms, reason, p._handler);\n\n\t\t\tthis._handler.visit(h,\n\t\t\t\tfunction onFulfill(x) {\n\t\t\t\t\tenv.clearTimer(t);\n\t\t\t\t\tthis.resolve(x); // this = h\n\t\t\t\t},\n\t\t\t\tfunction onReject(x) {\n\t\t\t\t\tenv.clearTimer(t);\n\t\t\t\t\tthis.reject(x); // this = h\n\t\t\t\t},\n\t\t\t\th.notify);\n\n\t\t\treturn p;\n\t\t};\n\n\t\tfunction onTimeout(reason, h, ms) {\n\t\t\tvar e = typeof reason === 'undefined'\n\t\t\t\t? new TimeoutError('timed out after ' + ms + 'ms')\n\t\t\t\t: reason;\n\t\t\th.reject(e);\n\t\t}\n\n\t\treturn Promise;\n\t};\n\n});\n}(typeof define === 'function' && define.amd ? define : function(factory) { module.exports = factory(require); }));\n"]}