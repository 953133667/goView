{"version":3,"sources":["input-source-map-tracker.js"],"names":[],"mappings":"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","file":"input-source-map-tracker-compiled.js","sourcesContent":["var SourceMapConsumer = require('source-map').SourceMapConsumer;\n\nvar fs = require('fs');\nvar path = require('path');\nvar http = require('http');\nvar https = require('https');\nvar url = require('url');\n\nvar override = require('../utils/object.js').override;\n\nvar MAP_MARKER = /\\/\\*# sourceMappingURL=(\\S+) \\*\\//;\nvar REMOTE_RESOURCE = /^(https?:)?\\/\\//;\nvar DATA_URI = /^data:(\\S*?)?(;charset=[^;]+)?(;[^,]+?)?,(.+)/;\n\nvar unescape = global.unescape;\n\nfunction InputSourceMapStore(outerContext) {\n  this.options = outerContext.options;\n  this.errors = outerContext.errors;\n  this.warnings = outerContext.warnings;\n  this.sourceTracker = outerContext.sourceTracker;\n  this.timeout = this.options.inliner.timeout;\n  this.requestOptions = this.options.inliner.request;\n  this.localOnly = outerContext.localOnly;\n  this.relativeTo = outerContext.options.target || process.cwd();\n\n  this.maps = {};\n  this.sourcesContent = {};\n}\n\nfunction fromString(self, _, whenDone) {\n  self.trackLoaded(undefined, undefined, self.options.sourceMap);\n  return whenDone();\n}\n\nfunction fromSource(self, data, whenDone, context) {\n  var nextAt = 0;\n\n  function proceedToNext() {\n    context.cursor += nextAt + 1;\n    fromSource(self, data, whenDone, context);\n  }\n\n  while (context.cursor < data.length) {\n    var fragment = data.substring(context.cursor);\n\n    var markerStartMatch = self.sourceTracker.nextStart(fragment) || { index: -1 };\n    var markerEndMatch = self.sourceTracker.nextEnd(fragment) || { index: -1 };\n    var mapMatch = MAP_MARKER.exec(fragment) || { index: -1 };\n    var sourceMapFile = mapMatch[1];\n\n    nextAt = data.length;\n    if (markerStartMatch.index > -1)\n      nextAt = markerStartMatch.index;\n    if (markerEndMatch.index > -1 && markerEndMatch.index < nextAt)\n      nextAt = markerEndMatch.index;\n    if (mapMatch.index > -1 && mapMatch.index < nextAt)\n      nextAt = mapMatch.index;\n\n    if (nextAt == data.length)\n      break;\n\n    if (nextAt == markerStartMatch.index) {\n      context.files.push(markerStartMatch.filename);\n    } else if (nextAt == markerEndMatch.index) {\n      context.files.pop();\n    } else if (nextAt == mapMatch.index) {\n      var isRemote = /^https?:\\/\\//.test(sourceMapFile) || /^\\/\\//.test(sourceMapFile);\n      var isDataUri = DATA_URI.test(sourceMapFile);\n\n      if (isRemote) {\n        return fetchMapFile(self, sourceMapFile, context, proceedToNext);\n      } else {\n        var sourceFile = context.files[context.files.length - 1];\n        var sourceMapPath, sourceMapData;\n        var sourceDir = sourceFile ? path.dirname(sourceFile) : self.options.relativeTo;\n\n        if (isDataUri) {\n          // source map's path is the same as the source file it comes from\n          sourceMapPath = path.resolve(self.options.root, sourceFile || '');\n          sourceMapData = fromDataUri(sourceMapFile);\n        } else {\n          sourceMapPath = path.resolve(self.options.root, path.join(sourceDir || '', sourceMapFile));\n          sourceMapData = fs.readFileSync(sourceMapPath, 'utf-8');\n        }\n        self.trackLoaded(sourceFile || undefined, sourceMapPath, sourceMapData);\n      }\n    }\n\n    context.cursor += nextAt + 1;\n  }\n\n  return whenDone();\n}\n\nfunction fromDataUri(uriString) {\n  var match = DATA_URI.exec(uriString);\n  var charset = match[2] ? match[2].split(/[=;]/)[2] : 'us-ascii';\n  var encoding = match[3] ? match[3].split(';')[1] : 'utf8';\n  var data = encoding == 'utf8' ? unescape(match[4]) : match[4];\n\n  var buffer = new Buffer(data, encoding);\n  buffer.charset = charset;\n\n  return buffer.toString();\n}\n\nfunction fetchMapFile(self, sourceUrl, context, done) {\n  fetch(self, sourceUrl, function (data) {\n    self.trackLoaded(context.files[context.files.length - 1] || undefined, sourceUrl, data);\n    done();\n  }, function (message) {\n    context.errors.push('Broken source map at \"' + sourceUrl + '\" - ' + message);\n    return done();\n  });\n}\n\nfunction fetch(self, path, onSuccess, onFailure) {\n  var protocol = path.indexOf('https') === 0 ? https : http;\n  var requestOptions = override(url.parse(path), self.requestOptions);\n  var errorHandled = false;\n\n  protocol\n    .get(requestOptions, function (res) {\n      if (res.statusCode < 200 || res.statusCode > 299)\n        return onFailure(res.statusCode);\n\n      var chunks = [];\n      res.on('data', function (chunk) {\n        chunks.push(chunk.toString());\n      });\n      res.on('end', function () {\n        onSuccess(chunks.join(''));\n      });\n    })\n    .on('error', function (res) {\n      if (errorHandled)\n        return;\n\n      onFailure(res.message);\n      errorHandled = true;\n    })\n    .on('timeout', function () {\n      if (errorHandled)\n        return;\n\n      onFailure('timeout');\n      errorHandled = true;\n    })\n    .setTimeout(self.timeout);\n}\n\nfunction originalPositionIn(trackedSource, line, column, token, allowNFallbacks) {\n  var originalPosition;\n  var maxRange = token.length;\n  var position = {\n    line: line,\n    column: column + maxRange\n  };\n\n  while (maxRange-- > 0) {\n    position.column--;\n    originalPosition = trackedSource.data.originalPositionFor(position);\n\n    if (originalPosition)\n      break;\n  }\n\n  if (originalPosition.line === null && line > 1 && allowNFallbacks > 0)\n    return originalPositionIn(trackedSource, line - 1, column, token, allowNFallbacks - 1);\n\n  if (trackedSource.path && originalPosition.source) {\n    originalPosition.source = REMOTE_RESOURCE.test(trackedSource.path) ?\n      url.resolve(trackedSource.path, originalPosition.source) :\n      path.join(trackedSource.path, originalPosition.source);\n\n    originalPosition.sourceResolved = true;\n  }\n\n  return originalPosition;\n}\n\nfunction trackContentSources(self, sourceFile) {\n  var consumer = self.maps[sourceFile].data;\n  var isRemote = REMOTE_RESOURCE.test(sourceFile);\n  var sourcesMapping = {};\n\n  consumer.sources.forEach(function (file, index) {\n    var uniquePath = isRemote ?\n      url.resolve(path.dirname(sourceFile), file) :\n      path.relative(self.relativeTo, path.resolve(path.dirname(sourceFile || '.'), file));\n\n    sourcesMapping[uniquePath] = consumer.sourcesContent && consumer.sourcesContent[index];\n  });\n  self.sourcesContent[sourceFile] = sourcesMapping;\n}\n\nfunction _resolveSources(self, remaining, whenDone) {\n  function processNext() {\n    return _resolveSources(self, remaining, whenDone);\n  }\n\n  if (remaining.length === 0)\n    return whenDone();\n\n  var current = remaining.shift();\n  var sourceFile = current[0];\n  var originalFile = current[1];\n  var isRemote = REMOTE_RESOURCE.test(sourceFile);\n\n  if (isRemote && self.localOnly) {\n    self.warnings.push('No callback given to `#minify` method, cannot fetch a remote file from \"' + originalFile + '\"');\n    return processNext();\n  }\n\n  if (isRemote) {\n    fetch(self, originalFile, function (data) {\n      self.sourcesContent[sourceFile][originalFile] = data;\n      processNext();\n    }, function (message) {\n      self.warnings.push('Broken original source file at \"' + originalFile + '\" - ' + message);\n      processNext();\n    });\n  } else {\n    var fullPath = path.join(self.options.root, originalFile);\n    if (fs.existsSync(fullPath))\n      self.sourcesContent[sourceFile][originalFile] = fs.readFileSync(fullPath, 'utf-8');\n    else\n      self.warnings.push('Missing original source file at \"' + fullPath + '\".');\n    return processNext();\n  }\n}\n\nInputSourceMapStore.prototype.track = function (data, whenDone) {\n  return typeof this.options.sourceMap == 'string' ?\n    fromString(this, data, whenDone) :\n    fromSource(this, data, whenDone, { files: [], cursor: 0, errors: this.errors });\n};\n\nInputSourceMapStore.prototype.trackLoaded = function (sourcePath, mapPath, mapData) {\n  var relativeTo = this.options.explicitTarget ? this.options.target : this.options.root;\n  var isRemote = REMOTE_RESOURCE.test(sourcePath);\n\n  if (mapPath) {\n    mapPath = isRemote ?\n      path.dirname(mapPath) :\n      path.dirname(path.relative(relativeTo, mapPath));\n  }\n\n  this.maps[sourcePath] = {\n    path: mapPath,\n    data: new SourceMapConsumer(mapData)\n  };\n\n  trackContentSources(this, sourcePath);\n};\n\nInputSourceMapStore.prototype.isTracking = function (source) {\n  return !!this.maps[source];\n};\n\nInputSourceMapStore.prototype.originalPositionFor = function (sourceInfo, token, allowNFallbacks) {\n  return originalPositionIn(this.maps[sourceInfo.source], sourceInfo.line, sourceInfo.column, token, allowNFallbacks);\n};\n\nInputSourceMapStore.prototype.sourcesContentFor = function (contextSource) {\n  return this.sourcesContent[contextSource];\n};\n\nInputSourceMapStore.prototype.resolveSources = function (whenDone) {\n  var toResolve = [];\n\n  for (var sourceFile in this.sourcesContent) {\n    var contents = this.sourcesContent[sourceFile];\n    for (var originalFile in contents) {\n      if (!contents[originalFile])\n        toResolve.push([sourceFile, originalFile]);\n    }\n  }\n\n  return _resolveSources(this, toResolve, whenDone);\n};\n\nmodule.exports = InputSourceMapStore;\n"]}