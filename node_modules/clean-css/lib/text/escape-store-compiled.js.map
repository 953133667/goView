{"version":3,"sources":["escape-store.js"],"names":[],"mappings":"AAAA,IAAI,mBAAmB,IAAvB;;AAEA,SAAS,WAAT,CAAqB,eAArB,EAAsC;AACpC,OAAK,eAAL,GAAuB,aAAa,eAAb,GAA+B,YAAtD;AACA,OAAK,iBAAL,GAAyB,EAAzB;AACA,OAAK,iBAAL,GAAyB,EAAzB;AACA,OAAK,KAAL,GAAa,CAAb;AACA,OAAK,cAAL,GAAsB,IAAI,MAAJ,CAAW,KAAK,eAAL,GAAuB,QAAlC,CAAtB;AACD;;AAED,YAAY,SAAZ,CAAsB,gBAAtB,GAAyC,UAAU,QAAV,EAAoB;AAC3D,SAAO;AACL,WAAO,KAAK,KADP;AAEL,WAAO,mBAAmB,KAAK,eAAxB,GAA0C,KAAK,KAAL,EAA1C,GAAyD,QAAzD,GAAoE;AAFtE,GAAP;AAID,CALD;;AAOA,YAAY,SAAZ,CAAsB,KAAtB,GAA8B,UAAU,IAAV,EAAgB,QAAhB,EAA0B;AACtD,MAAI,kBAAkB,WACpB,MAAM,SAAS,IAAT,CAAc,GAAd,CAAN,GAA2B,GADP,GAEpB,EAFF;AAGA,MAAI,cAAc,KAAK,iBAAL,CAAuB,IAAvB,CAAlB;;AAEA,MAAI,CAAC,WAAL,EAAkB;AAChB,QAAI,kBAAkB,KAAK,gBAAL,CAAsB,eAAtB,CAAtB;AACA,kBAAc,gBAAgB,KAA9B;AACA,SAAK,iBAAL,CAAuB,gBAAgB,KAAvC,IAAgD,IAAhD;AACA,SAAK,iBAAL,CAAuB,IAAvB,IAA+B,gBAAgB,KAA/C;AACD;;AAED,MAAI,QAAJ,EACE,cAAc,YAAY,OAAZ,CAAoB,YAApB,EAAkC,eAAlC,CAAd;;AAEF,SAAO,WAAP;AACD,CAjBD;;AAmBA,YAAY,SAAZ,CAAsB,SAAtB,GAAkC,UAAU,IAAV,EAAgB,MAAhB,EAAwB;AACxD,MAAI,OAAO,EAAX;;AAEA,OAAK,KAAL,GAAa,KAAK,OAAL,CAAa,KAAK,eAAlB,EAAmC,MAAnC,IAA6C,iBAAiB,MAA3E;AACA,OAAK,GAAL,GAAW,KAAK,OAAL,CAAa,gBAAb,EAA+B,KAAK,KAAL,GAAa,iBAAiB,MAA7D,IAAuE,iBAAiB,MAAnG;AACA,MAAI,KAAK,KAAL,GAAa,CAAC,CAAd,IAAmB,KAAK,GAAL,GAAW,CAAC,CAAnC,EACE,KAAK,KAAL,GAAa,KAAK,SAAL,CAAe,KAAK,KAApB,EAA2B,KAAK,GAAhC,CAAb;;AAEF,SAAO,IAAP;AACD,CATD;;AAWA,YAAY,SAAZ,CAAsB,OAAtB,GAAgC,UAAU,WAAV,EAAuB;AACrD,MAAI,QAAQ,KAAK,cAAL,CAAoB,IAApB,CAAyB,WAAzB,EAAsC,CAAtC,CAAZ;AACA,SAAO,KAAK,iBAAL,CAAuB,KAAvB,CAAP;AACD,CAHD;;AAKA,OAAO,OAAP,GAAiB,WAAjB","file":"escape-store-compiled.js","sourcesContent":["var placeholderBrace = '__';\n\nfunction EscapeStore(placeholderRoot) {\n  this.placeholderRoot = 'ESCAPED_' + placeholderRoot + '_CLEAN_CSS';\n  this.placeholderToData = {};\n  this.dataToPlaceholder = {};\n  this.count = 0;\n  this.restoreMatcher = new RegExp(this.placeholderRoot + '(\\\\d+)');\n}\n\nEscapeStore.prototype._nextPlaceholder = function (metadata) {\n  return {\n    index: this.count,\n    value: placeholderBrace + this.placeholderRoot + this.count++ + metadata + placeholderBrace\n  };\n};\n\nEscapeStore.prototype.store = function (data, metadata) {\n  var encodedMetadata = metadata ?\n    '(' + metadata.join(',') + ')' :\n    '';\n  var placeholder = this.dataToPlaceholder[data];\n\n  if (!placeholder) {\n    var nextPlaceholder = this._nextPlaceholder(encodedMetadata);\n    placeholder = nextPlaceholder.value;\n    this.placeholderToData[nextPlaceholder.index] = data;\n    this.dataToPlaceholder[data] = nextPlaceholder.value;\n  }\n\n  if (metadata)\n    placeholder = placeholder.replace(/\\([^\\)]+\\)/, encodedMetadata);\n\n  return placeholder;\n};\n\nEscapeStore.prototype.nextMatch = function (data, cursor) {\n  var next = {};\n\n  next.start = data.indexOf(this.placeholderRoot, cursor) - placeholderBrace.length;\n  next.end = data.indexOf(placeholderBrace, next.start + placeholderBrace.length) + placeholderBrace.length;\n  if (next.start > -1 && next.end > -1)\n    next.match = data.substring(next.start, next.end);\n\n  return next;\n};\n\nEscapeStore.prototype.restore = function (placeholder) {\n  var index = this.restoreMatcher.exec(placeholder)[1];\n  return this.placeholderToData[index];\n};\n\nmodule.exports = EscapeStore;\n"]}