{"version":3,"sources":["rewrite.js"],"names":[],"mappings":"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","file":"rewrite-compiled.js","sourcesContent":["var path = require('path');\nvar url = require('url');\n\nvar reduceUrls = require('./reduce');\n\nvar isWindows = process.platform == 'win32';\n\nfunction isAbsolute(uri) {\n  return uri[0] == '/';\n}\n\nfunction isSVGMarker(uri) {\n  return uri[0] == '#';\n}\n\nfunction isEscaped(uri) {\n  return uri.indexOf('__ESCAPED_URL_CLEAN_CSS__') === 0;\n}\n\nfunction isInternal(uri) {\n  return /^\\w+:\\w+/.test(uri);\n}\n\nfunction isRemote(uri) {\n  return /^[^:]+?:\\/\\//.test(uri) || uri.indexOf('//') === 0;\n}\n\nfunction isSameOrigin(uri1, uri2) {\n  return url.parse(uri1).protocol == url.parse(uri2).protocol &&\n    url.parse(uri1).host == url.parse(uri2).host;\n}\n\nfunction isImport(uri) {\n  return uri.lastIndexOf('.css') === uri.length - 4;\n}\n\nfunction isData(uri) {\n  return uri.indexOf('data:') === 0;\n}\n\nfunction absolute(uri, options) {\n  return path\n    .resolve(path.join(options.fromBase || '', uri))\n    .replace(options.toBase, '');\n}\n\nfunction relative(uri, options) {\n  return path.relative(options.toBase, path.join(options.fromBase || '', uri));\n}\n\nfunction normalize(uri) {\n  return isWindows ? uri.replace(/\\\\/g, '/') : uri;\n}\n\nfunction rebase(uri, options) {\n  if (isAbsolute(uri) || isSVGMarker(uri) || isEscaped(uri) || isInternal(uri))\n    return uri;\n\n  if (options.rebase === false && !isImport(uri))\n    return uri;\n\n  if (!options.imports && isImport(uri))\n    return uri;\n\n  if (isData(uri))\n    return '\\'' + uri + '\\'';\n\n  if (isRemote(uri) && !isRemote(options.toBase))\n    return uri;\n\n  if (isRemote(uri) && !isSameOrigin(uri, options.toBase))\n    return uri;\n\n  if (!isRemote(uri) && isRemote(options.toBase))\n    return url.resolve(options.toBase, uri);\n\n  return options.absolute ?\n    normalize(absolute(uri, options)) :\n    normalize(relative(uri, options));\n}\n\nfunction quoteFor(url) {\n  if (url.indexOf('\\'') > -1)\n    return '\"';\n  else if (url.indexOf('\"') > -1)\n    return '\\'';\n  else if (/\\s/.test(url) || /[\\(\\)]/.test(url))\n    return '\\'';\n  else\n    return '';\n}\n\nfunction rewriteUrls(data, options, context) {\n  return reduceUrls(data, context, function (originUrl, tempData) {\n    var url = originUrl.replace(/^(url\\()?\\s*['\"]?|['\"]?\\s*\\)?$/g, '');\n    var match = originUrl.match(/^(url\\()?\\s*(['\"]).*?(['\"])\\s*\\)?$/);\n    var quote;\n    if (!!options.urlQuotes && match && match[2] === match[3]) {\n      quote = match[2];\n    } else {\n      quote = quoteFor(url);\n    }\n    tempData.push('url(' + quote + rebase(url, options) + quote + ')');\n  });\n}\n\nmodule.exports = rewriteUrls;\n"]}