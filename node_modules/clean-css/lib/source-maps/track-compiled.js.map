{"version":3,"sources":["track.js"],"names":[],"mappings":"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","file":"track-compiled.js","sourcesContent":["var escapePrefix = '__ESCAPED_';\n\nfunction trackPrefix(value, context, interestingContent) {\n  if (!interestingContent && value.indexOf('\\n') == -1) {\n    if (value.indexOf(escapePrefix) === 0) {\n      return value;\n    } else {\n      context.column += value.length;\n      return;\n    }\n  }\n\n  var withoutContent = 0;\n  var split = value.split('\\n');\n  var total = split.length;\n  var shift = 0;\n\n  while (true) {\n    if (withoutContent == total - 1)\n      break;\n\n    var part = split[withoutContent];\n    if (/\\S/.test(part))\n      break;\n\n    shift += part.length + 1;\n    withoutContent++;\n  }\n\n  context.line += withoutContent;\n  context.column = withoutContent > 0 ? 0 : context.column;\n  context.column += /^(\\s)*/.exec(split[withoutContent])[0].length;\n\n  return value.substring(shift).trimLeft();\n}\n\nfunction sourceFor(originalMetadata, contextMetadata, context) {\n  var source = originalMetadata.source || contextMetadata.source;\n\n  if (source && context.resolvePath)\n    return context.resolvePath(contextMetadata.source, source);\n\n  return source;\n}\n\nfunction snapshot(data, context, fallbacks) {\n  var metadata = {\n    line: context.line,\n    column: context.column,\n    source: context.source\n  };\n  var sourceContent = null;\n  var sourceMetadata = context.sourceMapTracker.isTracking(metadata.source) ?\n    context.sourceMapTracker.originalPositionFor(metadata, data, fallbacks || 0) :\n    {};\n\n  metadata.line = sourceMetadata.line || metadata.line;\n  metadata.column = sourceMetadata.column || metadata.column;\n  metadata.source = sourceMetadata.sourceResolved ?\n    sourceMetadata.source :\n    sourceFor(sourceMetadata, metadata, context);\n\n  if (context.sourceMapInlineSources) {\n    var sourceMapSourcesContent = context.sourceMapTracker.sourcesContentFor(context.source);\n    sourceContent = sourceMapSourcesContent && sourceMapSourcesContent[metadata.source] ?\n      sourceMapSourcesContent :\n      context.sourceReader.sourceAt(context.source);\n  }\n\n  return sourceContent ?\n    [metadata.line, metadata.column, metadata.source, sourceContent] :\n    [metadata.line, metadata.column, metadata.source];\n}\n\nfunction trackSuffix(data, context) {\n  var parts = data.split('\\n');\n\n  for (var i = 0, l = parts.length; i < l; i++) {\n    var part = parts[i];\n    var cursor = 0;\n\n    if (i > 0) {\n      context.line++;\n      context.column = 0;\n    }\n\n    while (true) {\n      var next = part.indexOf(escapePrefix, cursor);\n\n      if (next == -1) {\n        context.column += part.substring(cursor).length;\n        break;\n      }\n\n      context.column += next - cursor;\n      cursor += next - cursor;\n\n      var escaped = part.substring(next, part.indexOf('__', next + 1) + 2);\n      var encodedValues = escaped.substring(escaped.indexOf('(') + 1, escaped.indexOf(')')).split(',');\n      context.line += ~~encodedValues[0];\n      context.column = (~~encodedValues[0] === 0 ? context.column : 0) + ~~encodedValues[1];\n      cursor += escaped.length;\n    }\n  }\n}\n\nfunction track(data, context, snapshotMetadata, fallbacks) {\n  var untracked = trackPrefix(data, context, snapshotMetadata);\n  var metadata = snapshotMetadata ?\n    snapshot(untracked, context, fallbacks) :\n    [];\n\n  if (untracked)\n    trackSuffix(untracked, context);\n\n  return metadata;\n}\n\nmodule.exports = track;\n"]}