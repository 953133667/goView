{"version":3,"sources":["build.js"],"names":[],"mappings":"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","file":"build-compiled.js","sourcesContent":["'use strict';\n\nvar fs = require('fs');\nvar rimraf = require('rimraf');\nvar acorn = require('acorn');\nvar walk = require('acorn/dist/walk');\n\nvar ids = [];\nvar names = {};\n\nfunction getIdFor(name) {\n  if (name in names) return names[name];\n  var id;\n  do {\n    id = '_' + Math.floor(Math.random() * 100);\n  } while (ids.indexOf(id) !== -1)\n  ids.push(id);\n  names[name] = id;\n  return id;\n}\n\nfunction fixup(src) {\n  var ast = acorn.parse(src);\n  src = src.split('');\n  walk.simple(ast, {\n    MemberExpression: function (node) {\n      if (node.computed) return;\n      if (node.property.type !== 'Identifier') return;\n      if (node.property.name[0] !== '_') return;\n      replace(node.property, getIdFor(node.property.name));\n    }\n  });\n  function source(node) {\n    return src.slice(node.start, node.end).join('');\n  }\n  function replace(node, str) {\n    for (var i = node.start; i < node.end; i++) {\n      src[i] = '';\n    }\n    src[node.start] = str;\n  }\n  return src.join('');\n}\nrimraf.sync(__dirname + '/lib/');\nfs.mkdirSync(__dirname + '/lib/');\nfs.readdirSync(__dirname + '/src').forEach(function (filename) {\n  var src = fs.readFileSync(__dirname + '/src/' + filename, 'utf8');\n  var out = fixup(src);\n  fs.writeFileSync(__dirname + '/lib/' + filename, out);\n});\n\nrimraf.sync(__dirname + '/domains/');\nfs.mkdirSync(__dirname + '/domains/');\nfs.readdirSync(__dirname + '/src').forEach(function (filename) {\n  var src = fs.readFileSync(__dirname + '/src/' + filename, 'utf8');\n  var out = fixup(src);\n  out = out.replace(/require\\(\\'asap\\/raw\\'\\)/g, \"require('asap')\");\n  fs.writeFileSync(__dirname + '/domains/' + filename, out);\n});\n\nrimraf.sync(__dirname + '/setimmediate/');\nfs.mkdirSync(__dirname + '/setimmediate/');\nfs.readdirSync(__dirname + '/src').forEach(function (filename) {\n  var src = fs.readFileSync(__dirname + '/src/' + filename, 'utf8');\n  var out = fixup(src);\n  out = out.replace(/var asap \\= require\\(\\'([a-z\\/]+)\\'\\);/g, '');\n  out = out.replace(/asap/g, \"setImmediate\");\n  fs.writeFileSync(__dirname + '/setimmediate/' + filename, out);\n});\n"]}