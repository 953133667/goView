{"version":3,"sources":["core.js"],"names":[],"mappings":"AAAA;;AAEA,IAAI,OAAO,QAAQ,UAAR,CAAX;;AAEA,SAAS,IAAT,GAAgB,CAAE;;AAElB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA,IAAI,aAAa,IAAjB;AACA,IAAI,WAAW,EAAf;AACA,SAAS,OAAT,CAAiB,GAAjB,EAAsB;AACpB,MAAI;AACF,WAAO,IAAI,IAAX;AACD,GAFD,CAEE,OAAO,EAAP,EAAW;AACX,iBAAa,EAAb;AACA,WAAO,QAAP;AACD;AACF;;AAED,SAAS,UAAT,CAAoB,EAApB,EAAwB,CAAxB,EAA2B;AACzB,MAAI;AACF,WAAO,GAAG,CAAH,CAAP;AACD,GAFD,CAEE,OAAO,EAAP,EAAW;AACX,iBAAa,EAAb;AACA,WAAO,QAAP;AACD;AACF;AACD,SAAS,UAAT,CAAoB,EAApB,EAAwB,CAAxB,EAA2B,CAA3B,EAA8B;AAC5B,MAAI;AACF,OAAG,CAAH,EAAM,CAAN;AACD,GAFD,CAEE,OAAO,EAAP,EAAW;AACX,iBAAa,EAAb;AACA,WAAO,QAAP;AACD;AACF;;AAED,OAAO,OAAP,GAAiB,OAAjB;;AAEA,SAAS,OAAT,CAAiB,EAAjB,EAAqB;AACnB,MAAI,OAAO,IAAP,KAAgB,QAApB,EAA8B;AAC5B,UAAM,IAAI,SAAJ,CAAc,sCAAd,CAAN;AACD;AACD,MAAI,OAAO,EAAP,KAAc,UAAlB,EAA8B;AAC5B,UAAM,IAAI,SAAJ,CAAc,gBAAd,CAAN;AACD;AACD,OAAK,GAAL,GAAW,CAAX;AACA,OAAK,GAAL,GAAW,CAAX;AACA,OAAK,GAAL,GAAW,IAAX;AACA,OAAK,GAAL,GAAW,IAAX;AACA,MAAI,OAAO,IAAX,EAAiB;AACjB,YAAU,EAAV,EAAc,IAAd;AACD;AACD,QAAQ,GAAR,GAAc,IAAd;AACA,QAAQ,GAAR,GAAc,IAAd;AACA,QAAQ,GAAR,GAAc,IAAd;;AAEA,QAAQ,SAAR,CAAkB,IAAlB,GAAyB,UAAS,WAAT,EAAsB,UAAtB,EAAkC;AACzD,MAAI,KAAK,WAAL,KAAqB,OAAzB,EAAkC;AAChC,WAAO,SAAS,IAAT,EAAe,WAAf,EAA4B,UAA5B,CAAP;AACD;AACD,MAAI,MAAM,IAAI,OAAJ,CAAY,IAAZ,CAAV;AACA,SAAO,IAAP,EAAa,IAAI,OAAJ,CAAY,WAAZ,EAAyB,UAAzB,EAAqC,GAArC,CAAb;AACA,SAAO,GAAP;AACD,CAPD;;AASA,SAAS,QAAT,CAAkB,IAAlB,EAAwB,WAAxB,EAAqC,UAArC,EAAiD;AAC/C,SAAO,IAAI,KAAK,WAAT,CAAqB,UAAU,OAAV,EAAmB,MAAnB,EAA2B;AACrD,QAAI,MAAM,IAAI,OAAJ,CAAY,IAAZ,CAAV;AACA,QAAI,IAAJ,CAAS,OAAT,EAAkB,MAAlB;AACA,WAAO,IAAP,EAAa,IAAI,OAAJ,CAAY,WAAZ,EAAyB,UAAzB,EAAqC,GAArC,CAAb;AACD,GAJM,CAAP;AAKD;AACD,SAAS,MAAT,CAAgB,IAAhB,EAAsB,QAAtB,EAAgC;AAC9B,SAAO,KAAK,GAAL,KAAa,CAApB,EAAuB;AACrB,WAAO,KAAK,GAAZ;AACD;AACD,MAAI,QAAQ,GAAZ,EAAiB;AACf,YAAQ,GAAR,CAAY,IAAZ;AACD;AACD,MAAI,KAAK,GAAL,KAAa,CAAjB,EAAoB;AAClB,QAAI,KAAK,GAAL,KAAa,CAAjB,EAAoB;AAClB,WAAK,GAAL,GAAW,CAAX;AACA,WAAK,GAAL,GAAW,QAAX;AACA;AACD;AACD,QAAI,KAAK,GAAL,KAAa,CAAjB,EAAoB;AAClB,WAAK,GAAL,GAAW,CAAX;AACA,WAAK,GAAL,GAAW,CAAC,KAAK,GAAN,EAAW,QAAX,CAAX;AACA;AACD;AACD,SAAK,GAAL,CAAS,IAAT,CAAc,QAAd;AACA;AACD;AACD,iBAAe,IAAf,EAAqB,QAArB;AACD;;AAED,SAAS,cAAT,CAAwB,IAAxB,EAA8B,QAA9B,EAAwC;AACtC,OAAK,YAAW;AACd,QAAI,KAAK,KAAK,GAAL,KAAa,CAAb,GAAiB,SAAS,WAA1B,GAAwC,SAAS,UAA1D;AACA,QAAI,OAAO,IAAX,EAAiB;AACf,UAAI,KAAK,GAAL,KAAa,CAAjB,EAAoB;AAClB,gBAAQ,SAAS,OAAjB,EAA0B,KAAK,GAA/B;AACD,OAFD,MAEO;AACL,eAAO,SAAS,OAAhB,EAAyB,KAAK,GAA9B;AACD;AACD;AACD;AACD,QAAI,MAAM,WAAW,EAAX,EAAe,KAAK,GAApB,CAAV;AACA,QAAI,QAAQ,QAAZ,EAAsB;AACpB,aAAO,SAAS,OAAhB,EAAyB,UAAzB;AACD,KAFD,MAEO;AACL,cAAQ,SAAS,OAAjB,EAA0B,GAA1B;AACD;AACF,GAhBD;AAiBD;AACD,SAAS,OAAT,CAAiB,IAAjB,EAAuB,QAAvB,EAAiC;AAC/B;AACA,MAAI,aAAa,IAAjB,EAAuB;AACrB,WAAO,OACL,IADK,EAEL,IAAI,SAAJ,CAAc,2CAAd,CAFK,CAAP;AAID;AACD,MACE,aACC,OAAO,QAAP,KAAoB,QAApB,IAAgC,OAAO,QAAP,KAAoB,UADrD,CADF,EAGE;AACA,QAAI,OAAO,QAAQ,QAAR,CAAX;AACA,QAAI,SAAS,QAAb,EAAuB;AACrB,aAAO,OAAO,IAAP,EAAa,UAAb,CAAP;AACD;AACD,QACE,SAAS,KAAK,IAAd,IACA,oBAAoB,OAFtB,EAGE;AACA,WAAK,GAAL,GAAW,CAAX;AACA,WAAK,GAAL,GAAW,QAAX;AACA,aAAO,IAAP;AACA;AACD,KARD,MAQO,IAAI,OAAO,IAAP,KAAgB,UAApB,EAAgC;AACrC,gBAAU,KAAK,IAAL,CAAU,QAAV,CAAV,EAA+B,IAA/B;AACA;AACD;AACF;AACD,OAAK,GAAL,GAAW,CAAX;AACA,OAAK,GAAL,GAAW,QAAX;AACA,SAAO,IAAP;AACD;;AAED,SAAS,MAAT,CAAgB,IAAhB,EAAsB,QAAtB,EAAgC;AAC9B,OAAK,GAAL,GAAW,CAAX;AACA,OAAK,GAAL,GAAW,QAAX;AACA,MAAI,QAAQ,GAAZ,EAAiB;AACf,YAAQ,GAAR,CAAY,IAAZ,EAAkB,QAAlB;AACD;AACD,SAAO,IAAP;AACD;AACD,SAAS,MAAT,CAAgB,IAAhB,EAAsB;AACpB,MAAI,KAAK,GAAL,KAAa,CAAjB,EAAoB;AAClB,WAAO,IAAP,EAAa,KAAK,GAAlB;AACA,SAAK,GAAL,GAAW,IAAX;AACD;AACD,MAAI,KAAK,GAAL,KAAa,CAAjB,EAAoB;AAClB,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,GAAL,CAAS,MAA7B,EAAqC,GAArC,EAA0C;AACxC,aAAO,IAAP,EAAa,KAAK,GAAL,CAAS,CAAT,CAAb;AACD;AACD,SAAK,GAAL,GAAW,IAAX;AACD;AACF;;AAED,SAAS,OAAT,CAAiB,WAAjB,EAA8B,UAA9B,EAA0C,OAA1C,EAAkD;AAChD,OAAK,WAAL,GAAmB,OAAO,WAAP,KAAuB,UAAvB,GAAoC,WAApC,GAAkD,IAArE;AACA,OAAK,UAAL,GAAkB,OAAO,UAAP,KAAsB,UAAtB,GAAmC,UAAnC,GAAgD,IAAlE;AACA,OAAK,OAAL,GAAe,OAAf;AACD;;AAED;;;;;;AAMA,SAAS,SAAT,CAAmB,EAAnB,EAAuB,OAAvB,EAAgC;AAC9B,MAAI,OAAO,KAAX;AACA,MAAI,MAAM,WAAW,EAAX,EAAe,UAAU,KAAV,EAAiB;AACxC,QAAI,IAAJ,EAAU;AACV,WAAO,IAAP;AACA,YAAQ,OAAR,EAAiB,KAAjB;AACD,GAJS,EAIP,UAAU,MAAV,EAAkB;AACnB,QAAI,IAAJ,EAAU;AACV,WAAO,IAAP;AACA,WAAO,OAAP,EAAgB,MAAhB;AACD,GARS,CAAV;AASA,MAAI,CAAC,IAAD,IAAS,QAAQ,QAArB,EAA+B;AAC7B,WAAO,IAAP;AACA,WAAO,OAAP,EAAgB,UAAhB;AACD;AACF","file":"core-compiled.js","sourcesContent":["'use strict';\n\nvar asap = require('asap/raw');\n\nfunction noop() {}\n\n// States:\n//\n// 0 - pending\n// 1 - fulfilled with _value\n// 2 - rejected with _value\n// 3 - adopted the state of another promise, _value\n//\n// once the state is no longer pending (0) it is immutable\n\n// All `_` prefixed properties will be reduced to `_{random number}`\n// at build time to obfuscate them and discourage their use.\n// We don't use symbols or Object.defineProperty to fully hide them\n// because the performance isn't good enough.\n\n\n// to avoid using try/catch inside critical functions, we\n// extract them to here.\nvar LAST_ERROR = null;\nvar IS_ERROR = {};\nfunction getThen(obj) {\n  try {\n    return obj.then;\n  } catch (ex) {\n    LAST_ERROR = ex;\n    return IS_ERROR;\n  }\n}\n\nfunction tryCallOne(fn, a) {\n  try {\n    return fn(a);\n  } catch (ex) {\n    LAST_ERROR = ex;\n    return IS_ERROR;\n  }\n}\nfunction tryCallTwo(fn, a, b) {\n  try {\n    fn(a, b);\n  } catch (ex) {\n    LAST_ERROR = ex;\n    return IS_ERROR;\n  }\n}\n\nmodule.exports = Promise;\n\nfunction Promise(fn) {\n  if (typeof this !== 'object') {\n    throw new TypeError('Promises must be constructed via new');\n  }\n  if (typeof fn !== 'function') {\n    throw new TypeError('not a function');\n  }\n  this._45 = 0;\n  this._81 = 0;\n  this._65 = null;\n  this._54 = null;\n  if (fn === noop) return;\n  doResolve(fn, this);\n}\nPromise._10 = null;\nPromise._97 = null;\nPromise._61 = noop;\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  if (this.constructor !== Promise) {\n    return safeThen(this, onFulfilled, onRejected);\n  }\n  var res = new Promise(noop);\n  handle(this, new Handler(onFulfilled, onRejected, res));\n  return res;\n};\n\nfunction safeThen(self, onFulfilled, onRejected) {\n  return new self.constructor(function (resolve, reject) {\n    var res = new Promise(noop);\n    res.then(resolve, reject);\n    handle(self, new Handler(onFulfilled, onRejected, res));\n  });\n};\nfunction handle(self, deferred) {\n  while (self._81 === 3) {\n    self = self._65;\n  }\n  if (Promise._10) {\n    Promise._10(self);\n  }\n  if (self._81 === 0) {\n    if (self._45 === 0) {\n      self._45 = 1;\n      self._54 = deferred;\n      return;\n    }\n    if (self._45 === 1) {\n      self._45 = 2;\n      self._54 = [self._54, deferred];\n      return;\n    }\n    self._54.push(deferred);\n    return;\n  }\n  handleResolved(self, deferred);\n}\n\nfunction handleResolved(self, deferred) {\n  asap(function() {\n    var cb = self._81 === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      if (self._81 === 1) {\n        resolve(deferred.promise, self._65);\n      } else {\n        reject(deferred.promise, self._65);\n      }\n      return;\n    }\n    var ret = tryCallOne(cb, self._65);\n    if (ret === IS_ERROR) {\n      reject(deferred.promise, LAST_ERROR);\n    } else {\n      resolve(deferred.promise, ret);\n    }\n  });\n}\nfunction resolve(self, newValue) {\n  // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n  if (newValue === self) {\n    return reject(\n      self,\n      new TypeError('A promise cannot be resolved with itself.')\n    );\n  }\n  if (\n    newValue &&\n    (typeof newValue === 'object' || typeof newValue === 'function')\n  ) {\n    var then = getThen(newValue);\n    if (then === IS_ERROR) {\n      return reject(self, LAST_ERROR);\n    }\n    if (\n      then === self.then &&\n      newValue instanceof Promise\n    ) {\n      self._81 = 3;\n      self._65 = newValue;\n      finale(self);\n      return;\n    } else if (typeof then === 'function') {\n      doResolve(then.bind(newValue), self);\n      return;\n    }\n  }\n  self._81 = 1;\n  self._65 = newValue;\n  finale(self);\n}\n\nfunction reject(self, newValue) {\n  self._81 = 2;\n  self._65 = newValue;\n  if (Promise._97) {\n    Promise._97(self, newValue);\n  }\n  finale(self);\n}\nfunction finale(self) {\n  if (self._45 === 1) {\n    handle(self, self._54);\n    self._54 = null;\n  }\n  if (self._45 === 2) {\n    for (var i = 0; i < self._54.length; i++) {\n      handle(self, self._54[i]);\n    }\n    self._54 = null;\n  }\n}\n\nfunction Handler(onFulfilled, onRejected, promise){\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, promise) {\n  var done = false;\n  var res = tryCallTwo(fn, function (value) {\n    if (done) return;\n    done = true;\n    resolve(promise, value);\n  }, function (reason) {\n    if (done) return;\n    done = true;\n    reject(promise, reason);\n  })\n  if (!done && res === IS_ERROR) {\n    done = true;\n    reject(promise, LAST_ERROR);\n  }\n}\n"]}